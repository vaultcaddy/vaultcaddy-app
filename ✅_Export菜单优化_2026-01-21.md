# âœ… Export èœå•ä¼˜åŒ–å’ŒExcelæ ¼å¼æ›´æ–°

## ğŸ“‹ ç”¨æˆ·éœ€æ±‚
1. åˆ é™¤CSVæ ¼å¼åˆ†ç»„ä¸­çš„ç¬¬ä¸€ä¸ªExcelé€‰é¡¹ï¼ˆä¿ç•™"å…¶ä»–æ ¼å¼"ä¸­çš„Excelï¼‰
2. æ›´æ–°Excelå¯¼å‡ºæ ¼å¼ï¼Œä½¿ç”¨å®Œæ•´çš„é“¶è¡Œå¯¹è´¦å•æ ¼å¼ï¼ˆå¦‚å›¾2ã€å›¾3æ‰€ç¤ºï¼‰
3. æ·»åŠ å…³é—­èœå•åŠŸèƒ½ï¼ˆç‚¹å‡»ExportæŒ‰é’®åˆ‡æ¢ï¼Œç‚¹å‡»å…¶ä»–ä½ç½®å…³é—­ï¼‰

---

## âœ… å·²å®Œæˆçš„æ›´æ”¹

### 1ï¸âƒ£ åˆ é™¤é‡å¤çš„Excelé€‰é¡¹
**ä¿®æ”¹ä½ç½®**: `document-detail.html` - `openVaultcaddyExportMenuInternal()` å‡½æ•°

**å˜æ›´**:
- âŒ åˆ é™¤: CSVæ ¼å¼åˆ†ç»„ä¸­çš„ç¬¬ä¸€ä¸ª `ğŸ“Š Excel (.xlsx)`
- âœ… ä¿ç•™: "å…¶ä»–æ ¼å¼"åˆ†ç»„ä¸­çš„ `ğŸ“Š Excel (.xlsx)`

**æ–°çš„èœå•ç»“æ„**:
```
CSV æ ¼å¼
â”œâ”€â”€ ğŸŒ é€šç”¨ CSV (é«˜äº®)
â”œâ”€â”€ ğŸ“„ Sage CSV
â””â”€â”€ ğŸ“„ Zoho Books CSV

å…¶ä»–æ ¼å¼
â”œâ”€â”€ â˜ï¸ QBO æ–‡ä»¶
â””â”€â”€ ğŸ“Š Excel (.xlsx)  â† ä¿ç•™è¿™ä¸ª

ğŸ’¡ ä¸ç¢ºå®šé¸å“ªå€‹ï¼Ÿ
```

---

### 2ï¸âƒ£ æ›´æ–°Excelå¯¼å‡ºæ ¼å¼
**ä¿®æ”¹ä½ç½®**: `document-detail.html` - `vaultcaddyExportDocument('excel')` case

**æ–°æ ¼å¼ï¼ˆ14åˆ—ï¼‰**:
```
CustomerName | AccountNumber | AccountType | BankName | BankAddress |
PopulatedDate | EndDate | OpeningBalance | EndingBalance |
LineItems_Date | LineItems_Description | LineItems_Credits | LineItems_Debits | LineItems_Balance
```

**è¯¦ç»†å­—æ®µè¯´æ˜**:
| åˆ—å | æ•°æ®æ¥æº | ç¤ºä¾‹ |
|------|---------|------|
| `CustomerName` | `data.accountHolder` | TUG COMPANY LIMITED |
| `AccountNumber` | `data.accountNumber` | 861-512-08367-3 |
| `AccountType` | `data.accountType` | Integrated Account |
| `BankName` | `data.bankName` | ä¸­åœ‹å·¥å•†éŠ€è¡Œï¼ˆäºæ´²ï¼‰æœ‰é™å…¬å¸ |
| `BankAddress` | `data.bankAddress` | EAST POINT CITY (766)... |
| `PopulatedDate` | `data.statementPeriod` (å¼€å§‹) | 07/01/2021 |
| `EndDate` | `data.statementPeriod` (ç»“æŸ) | 07/06/2021 |
| `OpeningBalance` | `data.openingBalance` | 59417.89 |
| `EndingBalance` | `data.closingBalance` | 25645.72 |
| `LineItems_Date` | `tx.date` | 07/01/2021 |
| `LineItems_Description` | `tx.description` | æ‰¿ä¸Šè½‰é¡ |
| `LineItems_Credits` | `tx.amount` (if income) | 0.00 |
| `LineItems_Debits` | `tx.amount` (if expense) | 59417.89 |
| `LineItems_Balance` | `tx.balance` | 59417.89 |

**å€Ÿè´·åˆ¤æ–­é€»è¾‘**:
```javascript
if (tx.transactionSign === 'income' || amount > 0) {
    credits = Math.abs(amount).toFixed(2);  // å­˜å…¥
} else if (tx.transactionSign === 'expense' || amount < 0) {
    debits = Math.abs(amount).toFixed(2);   // æ”¯å‡º
}
```

**åˆ—å®½è®¾ç½®**:
```javascript
ws['!cols'] = [
    {wch: 20},  // CustomerName
    {wch: 15},  // AccountNumber
    {wch: 18},  // AccountType
    {wch: 20},  // BankName
    {wch: 40},  // BankAddress
    {wch: 12},  // PopulatedDate
    {wch: 12},  // EndDate
    {wch: 15},  // OpeningBalance
    {wch: 15},  // EndingBalance
    {wch: 12},  // LineItems_Date
    {wch: 40},  // LineItems_Description
    {wch: 12},  // LineItems_Credits
    {wch: 12},  // LineItems_Debits
    {wch: 15}   // LineItems_Balance
];
```

---

### 3ï¸âƒ£ æ·»åŠ å…³é—­èœå•åŠŸèƒ½
**ä¿®æ”¹ä½ç½®**: `document-detail.html` - JavaScript éƒ¨åˆ†

#### A. åˆ‡æ¢åŠŸèƒ½ï¼ˆç‚¹å‡»ExportæŒ‰é’®ï¼‰
```javascript
window.openVaultcaddyExportMenu = function(event) {
    if (event) event.stopPropagation();
    
    const menu = document.getElementById('vaultcaddyExportMenu');
    
    // å¦‚æœèœå•å·²ç»æ‰“å¼€ï¼Œåˆ™å…³é—­
    if (menu && menu.style.display === 'block') {
        closeVaultcaddyExportMenu();
        return;
    }
    
    // å¦åˆ™æ‰“å¼€èœå•
    openVaultcaddyExportMenuInternal();
};
```

**æ›´æ–°æŒ‰é’®**:
```html
<!-- ä¿®æ”¹å‰ -->
<button onclick="openVaultcaddyExportMenu()">

<!-- ä¿®æ”¹å -->
<button onclick="openVaultcaddyExportMenu(event)">
```

#### B. ç‚¹å‡»å…¶ä»–ä½ç½®å…³é—­
```javascript
document.addEventListener('click', function(e) {
    const menu = document.getElementById('vaultcaddyExportMenu');
    const btn = document.querySelector('[onclick*="openVaultcaddyExportMenu"]');
    
    // å¦‚æœç‚¹å‡»çš„ä¸æ˜¯èœå•ã€æŒ‰é’®ï¼Œä¸”èœå•å·²æ‰“å¼€ï¼Œåˆ™å…³é—­èœå•
    if (menu && menu.style.display === 'block' && 
        !menu.contains(e.target) && 
        !btn?.contains(e.target)) {
        closeVaultcaddyExportMenu();
    }
});
```

#### C. ç‚¹å‡»é®ç½©å…³é—­
```javascript
document.getElementById('vaultcaddyExportOverlay')?.addEventListener('click', closeVaultcaddyExportMenu);
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### 1. æµ‹è¯•èœå•æ˜¾ç¤º
```
Cmd + Shift + R  # å¼ºåˆ¶åˆ·æ–°
æ‰“å¼€: https://vaultcaddy.com/document-detail.html?project=SJJkhY7CFdqh8zyVAM6B&id=vPwfbEF32mLC72EsZsDW
```

**é¢„æœŸç»“æœ**:
- âœ… CSVæ ¼å¼åˆ†ç»„åªæœ‰3ä¸ªé€‰é¡¹ï¼ˆé€šç”¨CSVã€Sage CSVã€Zoho CSVï¼‰
- âœ… å…¶ä»–æ ¼å¼åˆ†ç»„æœ‰2ä¸ªé€‰é¡¹ï¼ˆQBOã€Excelï¼‰

### 2. æµ‹è¯•Excelå¯¼å‡ºæ ¼å¼
```
1. ç‚¹å‡» Export æŒ‰é’®
2. é€‰æ‹© Excel (.xlsx)
3. æ‰“å¼€ä¸‹è½½çš„æ–‡ä»¶
```

**é¢„æœŸç»“æœ**:
- âœ… 14åˆ—æ ‡é¢˜ï¼šCustomerName, AccountNumber, ..., LineItems_Balance
- âœ… æ¯ç¬”äº¤æ˜“ä¸€è¡Œï¼ŒåŒ…å«å®Œæ•´çš„è´¦æˆ·ä¿¡æ¯
- âœ… Credits/Debits æ ¹æ®äº¤æ˜“ç±»å‹æ­£ç¡®åˆ†ç¦»

### 3. æµ‹è¯•å…³é—­èœå•
```
1. ç‚¹å‡» Export æŒ‰é’® â†’ èœå•æ‰“å¼€
2. å†æ¬¡ç‚¹å‡» Export æŒ‰é’® â†’ èœå•å…³é—­
3. å†æ¬¡ç‚¹å‡» Export æŒ‰é’® â†’ èœå•æ‰“å¼€
4. ç‚¹å‡»é¡µé¢å…¶ä»–ä½ç½® â†’ èœå•å…³é—­
5. å†æ¬¡ç‚¹å‡» Export æŒ‰é’® â†’ èœå•æ‰“å¼€
6. ç‚¹å‡»ç°è‰²é®ç½© â†’ èœå•å…³é—­
```

**é¢„æœŸç»“æœ**:
- âœ… ExportæŒ‰é’®å¯ä»¥åˆ‡æ¢èœå•æ˜¾ç¤º/éšè—
- âœ… ç‚¹å‡»é¡µé¢å…¶ä»–ä½ç½®å¯ä»¥å…³é—­èœå•
- âœ… ç‚¹å‡»é®ç½©å¯ä»¥å…³é—­èœå•
- âœ… ç‚¹å‡»èœå•å†…éƒ¨ä¸ä¼šå…³é—­èœå•

---

## ğŸ“Š æ–‡ä»¶æ›´æ”¹æ€»ç»“

| æ–‡ä»¶ | æ›´æ”¹å†…å®¹ | è¡Œæ•° |
|-----|---------|------|
| `document-detail.html` | åˆ é™¤CSVæ ¼å¼ä¸­çš„Excelé€‰é¡¹ | ~2867-2877 |
| `document-detail.html` | æ›´æ–°Excelå¯¼å‡ºæ ¼å¼ï¼ˆ14åˆ—ï¼‰ | ~2991-3055 |
| `document-detail.html` | æ·»åŠ åˆ‡æ¢åŠŸèƒ½ | ~2854-2868 |
| `document-detail.html` | æ·»åŠ ç‚¹å‡»å…¶ä»–ä½ç½®å…³é—­ | ~2959-2973 |
| `document-detail.html` | æ›´æ–°æŒ‰é’®onclick | ~1590 |

---

## ğŸ¯ ä¸‹ä¸€æ­¥å»ºè®®

1. **ç«‹å³æµ‹è¯•**: åˆ·æ–°é¡µé¢ï¼ŒéªŒè¯æ‰€æœ‰åŠŸèƒ½
2. **éªŒè¯Excelæ ¼å¼**: æ‰“å¼€å¯¼å‡ºçš„Excelæ–‡ä»¶ï¼Œç¡®è®¤14åˆ—æ ¼å¼æ­£ç¡®
3. **æµ‹è¯•äº¤äº’**: éªŒè¯èœå•çš„æ‰“å¼€/å…³é—­äº¤äº’æ˜¯å¦æµç•…

---

**åˆ›å»ºæ—¶é—´**: 2026-01-21  
**ä½œè€…**: VaultCaddy AI Assistant  
**ç›¸å…³æ–‡ä»¶**: `document-detail.html`
