<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    
    <!-- üîí „Éö„Éº„Ç∏‰øùË≠∑ -->
    <style>
        body.auth-checking { visibility: hidden !important; }
        .auth-loading { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: flex; align-items: center; justify-content: center; z-index: 10000; visibility: visible !important; }
        body.auth-ready .auth-loading { display: none; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
    <script>
        document.documentElement.classList.add('auth-checking');
        if (document.body) { document.body.classList.add('auth-checking'); } 
        else { document.addEventListener('DOMContentLoaded', function() { document.body.classList.add('auth-checking'); }); }
    </script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- üîá ÂÆâÂÖ®ÈöêËóèÂà∂Âæ°Âè∞Êó•ÂøóÔºà„Å™„ÅÑÂà†Èô§‰ª£Á†ÅÔºâ -->
    <script defer src="../disable-console-safe.js"></script>
    
    <title>ÊñáÊõ∏Ë©≥Á¥∞ - VaultCaddyÊòéÁ¥∞Êõ∏Â§âÊèõ | PDF„Åã„ÇâExcel/QuickBooks | Á≤æÂ∫¶98% | VaultCaddy</title>
    <link rel="stylesheet" href="../styles.css">
    <link rel="stylesheet" href="../dashboard.css">
    <link rel="stylesheet" href="../pages.css">
    <link rel="stylesheet" href="../editable-table.css">
    <link rel="stylesheet" href="https:        // üî• Export ÂäüËÉΩ - Â∑•‰ΩúÁâàÊú¨Ôºà‰ªé firstproject.htmlÔºâ
        
        // ÂÖ≥Èó≠ËèúÂçï
        window.closeExportMenu = function() {
            const menu = document.getElementById('exportMenu');
            const overlay = document.getElementById('exportMenuOverlay');
            if (menu) {
                menu.style.display = 'none';
                menu.classList.remove('active');
            }
            if (overlay) {
                overlay.style.display = 'none';
            }
            console.log('üîí ËèúÂçïÂ∑≤ÂÖ≥Èó≠');
        };
        
        // ÂàáÊç¢ËèúÂçïÊòæÁ§∫
        window.toggleExportMenu = function() {
            console.log('üîç toggleExportMenu Called');
            const menu = document.getElementById('exportMenu');
            const overlay = document.getElementById('exportMenuOverlay');
            console.log('üìã ËèúÂçïÂÖÉÁ¥†:', menu);
            
            if (!menu) {
                console.error('‚ùå Êú™ÊâæÂà∞ #exportMenu ÂÖÉÁ¥†');
                return;
            }
            
            // Â¶ÇÊûúËèúÂçïÂ∑≤ÊòæÁ§∫ÔºåÂàôÂÖ≥Èó≠
            if (menu.style.display === 'block') {
                closeExportMenu();
                return;
            }
            
            // ‰ΩøÁî®ÂΩìÂâçÊñáÊ°£Ôºàdocument-detail Âú∫ÊôØÔºâ
            if (!window.currentDocument) {
                console.warn('‚ö†Ô∏è window.currentDocument ‰∏çÂ≠òÂú®');
            }
            
            // Êõ¥Êñ∞ËèúÂçïÂÜÖÂÆπ
            console.log('üîÑ Êõ¥Êñ∞ËèúÂçïÂÜÖÂÆπ...');
            updateExportMenuContent();
            
            // Ê†πÊçÆÂ±èÂπïÂ§ßÂ∞èËÆæÁΩÆËèúÂçïÊ†∑Âºè
            if (window.innerWidth <= 768) {
                // ÁßªÂä®Á´ØÔºöÂ±Ö‰∏≠ÊòæÁ§∫
                menu.style.position = 'fixed';
                menu.style.top = '50%';
                menu.style.left = '50%';
                menu.style.transform = 'translate(-50%, -50%)';
                menu.style.right = 'auto';
                menu.style.width = '90%';
                menu.style.maxWidth = '400px';
                menu.style.backgroundColor = '#ffffff';
                menu.style.border = 'none';
                menu.style.boxShadow = 'none';
                menu.style.borderRadius = '12px';
                console.log('üì± ÁßªÂä®Á´ØÔºöËèúÂçïÂ±Ö‰∏≠ÊòæÁ§∫');
                
                // ÊòæÁ§∫ÈÅÆÁΩ©
                if (overlay) {
                    overlay.style.display = 'block';
                }
            } else {
                // Ê°åÈù¢Á´ØÔºöÂú® Export ÊåâÈíÆ‰∏ãÊñπ
                const exportBtn = document.querySelector('button[onclick*="toggleExportMenu"]');
                if (exportBtn) {
                    const rect = exportBtn.getBoundingClientRect();
                    menu.style.position = 'fixed';
                    menu.style.top = (rect.bottom + 8) + 'px';
                    menu.style.right = (window.innerWidth - rect.right) + 'px';
                    menu.style.left = 'auto';
                    menu.style.transform = 'none';
                    menu.style.width = 'auto';
                    menu.style.minWidth = '280px';
                    menu.style.maxWidth = '400px';
                }
                console.log('üíª Ê°åÈù¢Á´ØÔºöËèúÂçïÂú®ÊåâÈíÆ‰∏ãÊñπ');
                
                // ‰∏çÊòæÁ§∫ÈÅÆÁΩ©
                if (overlay) {
                    overlay.style.display = 'none';
                }
            }
            
            menu.style.display = 'block';
            menu.classList.add('active');
            
            console.log('‚úÖ ËèúÂçïÂ∑≤ÊòæÁ§∫');
        };
        
        console.log('‚úÖ Export ÂäüËÉΩÂ∑≤Âä†ËΩΩÔºàÂ∑•‰ΩúÁâàÊú¨Ôºâ');

        
        // Á≠âÂæÖ2ÁßíÂêéÊâßË°åÔºåÁ°Æ‰øùÈ°µÈù¢ÂÆåÂÖ®Âä†ËΩΩ


    </script>
    
    <style>
        /* Export Menu Ê†∑Âºè */
        .export-menu-item:hover {
            background: #f3f4f6 !important;
        }
        
        /* ÁßªÂä®Á´ØÊ†∑Âºè */
        @media (max-width: 768px) {
            #exportMenu {
                position: fixed !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                right: auto !important;
                width: 90% !important;
                max-width: 400px !important;
                background-color: #ffffff !important;
                box-shadow: none !important;
                border: none !important;
                border-radius: 12px !important;
                padding: 1.5rem !important;
                overflow: hidden !important;
            }
        }
    </style>

</body>
</html>
