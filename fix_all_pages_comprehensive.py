#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
å…¨é¢ä¿®å¤æ‰€æœ‰è‹±æ—¥éŸ©é¡µé¢çš„ä¸­æ–‡å†…å®¹
Comprehensive fix for all EN/JP/KR pages
"""

import re
import os
from collections import defaultdict

# è¶…å¤§åž‹ç¿»è¯‘å­—å…¸ - é€‚ç”¨äºŽæ‰€æœ‰é¡µé¢
TRANSLATIONS = {
    'en': {  # è‹±æ–‡ç¿»è¯‘
        # æŠ€æœ¯æ³¨é‡Š
        'æ‰‹æ©Ÿç‰ˆ': 'Mobile',
        'æ¡Œé¢ç‰ˆ': 'Desktop',
        'å´é‚Šæ¬„': 'Sidebar',
        'åˆå§‹åŒ–': 'Initialize',
        'å¦‚æžœæ˜¯': 'If',
        'å€‹æ–‡æª”': ' documents',
        'æ ¹æ“šæ–‡æª”': 'Based on document',
        'ä¸Šå‚³å€åŸŸ': 'Upload area',
        'æ‰¾ä¸åˆ°': 'Not found',
        'æ‰‹æ©Ÿç‰ˆå…§å®¹è·é›¢å°Žèˆªæ¬„æ¸›å°‘': 'Mobile content distance from navbar reduced',
        'å…§å®¹å€åŸŸ': 'Content area',
        'æ–‡æª”åˆ—è¡¨': 'Document list',
        'æ–‡æª”è©³æƒ…': 'Document details',
        'æ–‡æª”åç¨±': 'Document name',
        'æ–‡æª”é¡žåž‹': 'Document type',
        'ä¸Šå‚³æ™‚é–“': 'Upload time',
        'è™•ç†ç‹€æ…‹': 'Processing status',
        'è™•ç†ä¸­': 'Processing',
        'å·²å®Œæˆ': 'Completed',
        'å¤±æ•—': 'Failed',
        'é‡è©¦': 'Retry',
        'åˆªé™¤': 'Delete',
        'ä¸‹è¼‰': 'Download',
        'æŸ¥çœ‹': 'View',
        'ç·¨è¼¯': 'Edit',
        'å–æ¶ˆ': 'Cancel',
        'ç¢ºèª': 'Confirm',
        'ä¿å­˜': 'Save',
        'è¿”å›ž': 'Back',
        'ä¸‹ä¸€æ­¥': 'Next',
        'ä¸Šä¸€æ­¥': 'Previous',
        'å®Œæˆ': 'Complete',
        'é–‹å§‹': 'Start',
        'çµæŸ': 'End',
        'ç¸½è¨ˆ': 'Total',
        'è«‹é¸æ“‡': 'Please select',
        'è«‹è¼¸å…¥': 'Please enter',
        'è«‹ä¸Šå‚³': 'Please upload',
        'é»žæ“Šä¸Šå‚³': 'Click to upload',
        'æ‹–æ‹½æ–‡ä»¶è‡³æ­¤': 'Drag files here',
        'æˆ–': 'or',
        'æ”¯æ´çš„æ–‡ä»¶é¡žåž‹': 'Supported file types',
        'æœ€å¤§æ–‡ä»¶å¤§å°': 'Maximum file size',
        'ä¸Šå‚³æˆåŠŸ': 'Upload successful',
        'ä¸Šå‚³å¤±æ•—': 'Upload failed',
        'è™•ç†æˆåŠŸ': 'Processing successful',
        'è™•ç†å¤±æ•—': 'Processing failed',
        'åˆªé™¤æˆåŠŸ': 'Delete successful',
        'åˆªé™¤å¤±æ•—': 'Delete failed',
        'ä¿å­˜æˆåŠŸ': 'Save successful',
        'ä¿å­˜å¤±æ•—': 'Save failed',
        'è«‹ç¨å€™': 'Please wait',
        'åŠ è¼‰ä¸­': 'Loading',
        'æ­£åœ¨è™•ç†': 'Processing',
        'æ­£åœ¨ä¸Šå‚³': 'Uploading',
        'æ­£åœ¨ä¸‹è¼‰': 'Downloading',
        'éŠ€è¡Œå°å¸³å–®': 'Bank statement',
        'æ”¶æ“š': 'Receipt',
        'ç™¼ç¥¨': 'Invoice',
        'å¸³æˆ¶': 'Account',
        'è¨ˆè²»': 'Billing',
        'é…ç½®': 'Settings',
        'å„€è¡¨æ¿': 'Dashboard',
        'é …ç›®': 'Project',
        'æ–‡æª”': 'Document',
        'ç”¨æˆ¶': 'User',
        'ç™»å‡º': 'Logout',
        'ç™»å…¥': 'Login',
        'è¨»å†Š': 'Sign up',
        'å¿˜è¨˜å¯†ç¢¼': 'Forgot password',
        'é‡ç½®å¯†ç¢¼': 'Reset password',
        'æ›´æ”¹å¯†ç¢¼': 'Change password',
        'å€‹äººè³‡æ–™': 'Profile',
        'é€šçŸ¥': 'Notifications',
        'å¹«åŠ©': 'Help',
        'é—œæ–¼': 'About',
        'è¯ç¹«æˆ‘å€‘': 'Contact us',
        'éš±ç§æ”¿ç­–': 'Privacy policy',
        'æœå‹™æ¢æ¬¾': 'Terms of service',
        'æœˆä»˜æ–¹æ¡ˆ': 'Monthly plan',
        'å¹´ä»˜æ–¹æ¡ˆ': 'Annual plan',
        'å…è²»è©¦ç”¨': 'Free trial',
        'ç«‹å³å‡ç´š': 'Upgrade now',
        'é¸æ“‡æ–¹æ¡ˆ': 'Choose plan',
        'ç•¶å‰æ–¹æ¡ˆ': 'Current plan',
        'ä½¿ç”¨æƒ…æ³': 'Usage',
        'å‰©é¤˜é¡åº¦': 'Remaining quota',
        'å·²ä½¿ç”¨': 'Used',
        'æœªä½¿ç”¨': 'Unused',
        'éŽæœŸæ™‚é–“': 'Expiration time',
        'è‡ªå‹•çºŒè²»': 'Auto-renew',
        'å–æ¶ˆè¨‚é–±': 'Cancel subscription',
        'ä»˜æ¬¾æ–¹å¼': 'Payment method',
        'ä¿¡ç”¨å¡': 'Credit card',
        'æ·»åŠ å¡ç‰‡': 'Add card',
        'åˆªé™¤å¡ç‰‡': 'Delete card',
        'é»˜èªå¡ç‰‡': 'Default card',
        'å¸³å–®æ­·å²': 'Billing history',
        'ç™¼ç¥¨ç·¨è™Ÿ': 'Invoice number',
        'é‡‘é¡': 'Amount',
        'ç‹€æ…‹': 'Status',
        'å·²ä»˜æ¬¾': 'Paid',
        'æœªä»˜æ¬¾': 'Unpaid',
        'å·²å–æ¶ˆ': 'Cancelled',
        'å¾…è™•ç†': 'Pending',
        'æŸ¥çœ‹ç™¼ç¥¨': 'View invoice',
        'ä¸‹è¼‰ç™¼ç¥¨': 'Download invoice',
    },
    'jp': {  # æ—¥æ–‡ç¿»è¯‘
        'æ‰‹æ©Ÿç‰ˆ': 'ãƒ¢ãƒã‚¤ãƒ«ç‰ˆ',
        'æ¡Œé¢ç‰ˆ': 'ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ç‰ˆ',
        'å´é‚Šæ¬„': 'ã‚µã‚¤ãƒ‰ãƒãƒ¼',
        'åˆå§‹åŒ–': 'åˆæœŸåŒ–',
        'å¦‚æžœæ˜¯': 'ã‚‚ã—',
        'å€‹æ–‡æª”': 'ä»¶ã®æ–‡æ›¸',
        'æ ¹æ“šæ–‡æª”': 'æ–‡æ›¸ã«åŸºã¥ã„ã¦',
        'ä¸Šå‚³å€åŸŸ': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã‚¨ãƒªã‚¢',
        'æ‰¾ä¸åˆ°': 'è¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
        'æ‰‹æ©Ÿç‰ˆå…§å®¹è·é›¢å°Žèˆªæ¬„æ¸›å°‘': 'ãƒ¢ãƒã‚¤ãƒ«ç‰ˆã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‹ã‚‰ã®è·é›¢ã‚’å‰Šæ¸›',
        'å…§å®¹å€åŸŸ': 'ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚¨ãƒªã‚¢',
        'æ–‡æª”åˆ—è¡¨': 'æ–‡æ›¸ãƒªã‚¹ãƒˆ',
        'æ–‡æª”è©³æƒ…': 'æ–‡æ›¸è©³ç´°',
        'æ–‡æª”åç¨±': 'æ–‡æ›¸å',
        'æ–‡æª”é¡žåž‹': 'æ–‡æ›¸ã‚¿ã‚¤ãƒ—',
        'ä¸Šå‚³æ™‚é–“': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æ™‚é–“',
        'è™•ç†ç‹€æ…‹': 'å‡¦ç†çŠ¶æ…‹',
        'è™•ç†ä¸­': 'å‡¦ç†ä¸­',
        'å·²å®Œæˆ': 'å®Œäº†',
        'å¤±æ•—': 'å¤±æ•—',
        'é‡è©¦': 'å†è©¦è¡Œ',
        'åˆªé™¤': 'å‰Šé™¤',
        'ä¸‹è¼‰': 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰',
        'æŸ¥çœ‹': 'è¡¨ç¤º',
        'ç·¨è¼¯': 'ç·¨é›†',
        'å–æ¶ˆ': 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
        'ç¢ºèª': 'ç¢ºèª',
        'ä¿å­˜': 'ä¿å­˜',
        'è¿”å›ž': 'æˆ»ã‚‹',
        'ä¸‹ä¸€æ­¥': 'æ¬¡ã¸',
        'ä¸Šä¸€æ­¥': 'å‰ã¸',
        'å®Œæˆ': 'å®Œäº†',
        'é–‹å§‹': 'é–‹å§‹',
        'çµæŸ': 'çµ‚äº†',
        'ç¸½è¨ˆ': 'åˆè¨ˆ',
        'è«‹é¸æ“‡': 'é¸æŠžã—ã¦ãã ã•ã„',
        'è«‹è¼¸å…¥': 'å…¥åŠ›ã—ã¦ãã ã•ã„',
        'è«‹ä¸Šå‚³': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ã—ã¦ãã ã•ã„',
        'é»žæ“Šä¸Šå‚³': 'ã‚¯ãƒªãƒƒã‚¯ã—ã¦ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰',
        'æ‹–æ‹½æ–‡ä»¶è‡³æ­¤': 'ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã“ã“ã«ãƒ‰ãƒ©ãƒƒã‚°',
        'æˆ–': 'ã¾ãŸã¯',
        'æ”¯æ´çš„æ–‡ä»¶é¡žåž‹': 'ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚¡ã‚¤ãƒ«ã‚¿ã‚¤ãƒ—',
        'æœ€å¤§æ–‡ä»¶å¤§å°': 'æœ€å¤§ãƒ•ã‚¡ã‚¤ãƒ«ã‚µã‚¤ã‚º',
        'ä¸Šå‚³æˆåŠŸ': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰æˆåŠŸ',
        'ä¸Šå‚³å¤±æ•—': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰å¤±æ•—',
        'è™•ç†æˆåŠŸ': 'å‡¦ç†æˆåŠŸ',
        'è™•ç†å¤±æ•—': 'å‡¦ç†å¤±æ•—',
        'åˆªé™¤æˆåŠŸ': 'å‰Šé™¤æˆåŠŸ',
        'åˆªé™¤å¤±æ•—': 'å‰Šé™¤å¤±æ•—',
        'ä¿å­˜æˆåŠŸ': 'ä¿å­˜æˆåŠŸ',
        'ä¿å­˜å¤±æ•—': 'ä¿å­˜å¤±æ•—',
        'è«‹ç¨å€™': 'ãŠå¾…ã¡ãã ã•ã„',
        'åŠ è¼‰ä¸­': 'èª­ã¿è¾¼ã¿ä¸­',
        'æ­£åœ¨è™•ç†': 'å‡¦ç†ä¸­',
        'æ­£åœ¨ä¸Šå‚³': 'ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰ä¸­',
        'æ­£åœ¨ä¸‹è¼‰': 'ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ä¸­',
        'éŠ€è¡Œå°å¸³å–®': 'éŠ€è¡Œæ˜Žç´°æ›¸',
        'æ”¶æ“š': 'ãƒ¬ã‚·ãƒ¼ãƒˆ',
        'ç™¼ç¥¨': 'è«‹æ±‚æ›¸',
        'å¸³æˆ¶': 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆ',
        'è¨ˆè²»': 'è«‹æ±‚',
        'é…ç½®': 'è¨­å®š',
        'å„€è¡¨æ¿': 'ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰',
        'é …ç›®': 'ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ',
        'æ–‡æª”': 'æ–‡æ›¸',
        'ç”¨æˆ¶': 'ãƒ¦ãƒ¼ã‚¶ãƒ¼',
        'ç™»å‡º': 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',
        'ç™»å…¥': 'ãƒ­ã‚°ã‚¤ãƒ³',
        'è¨»å†Š': 'ç™»éŒ²',
        'å¿˜è¨˜å¯†ç¢¼': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¿˜ã‚ŒãŸ',
        'é‡ç½®å¯†ç¢¼': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆ',
        'æ›´æ”¹å¯†ç¢¼': 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å¤‰æ›´',
        'å€‹äººè³‡æ–™': 'ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«',
        'é€šçŸ¥': 'é€šçŸ¥',
        'å¹«åŠ©': 'ãƒ˜ãƒ«ãƒ—',
        'é—œæ–¼': 'æ¦‚è¦',
        'è¯ç¹«æˆ‘å€‘': 'ãŠå•ã„åˆã‚ã›',
        'éš±ç§æ”¿ç­–': 'ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼ãƒãƒªã‚·ãƒ¼',
        'æœå‹™æ¢æ¬¾': 'åˆ©ç”¨è¦ç´„',
        'åˆªé™¤å¤±æ•—': 'å‰Šé™¤å¤±æ•—',
    },
    'kr': {  # éŸ©æ–‡ç¿»è¯‘
        'æ‰‹æ©Ÿç‰ˆ': 'ëª¨ë°”ì¼ ë²„ì „',
        'æ¡Œé¢ç‰ˆ': 'ë°ìŠ¤í¬í†± ë²„ì „',
        'å´é‚Šæ¬„': 'ì‚¬ì´ë“œë°”',
        'åˆå§‹åŒ–': 'ì´ˆê¸°í™”',
        'å¦‚æžœæ˜¯': 'ë§Œì•½',
        'å€‹æ–‡æª”': 'ê°œ ë¬¸ì„œ',
        'æ ¹æ“šæ–‡æª”': 'ë¬¸ì„œì— ë”°ë¼',
        'ä¸Šå‚³å€åŸŸ': 'ì—…ë¡œë“œ ì˜ì—­',
        'æ‰¾ä¸åˆ°': 'ì°¾ì„ ìˆ˜ ì—†ìŒ',
        'æ‰‹æ©Ÿç‰ˆå…§å®¹è·é›¢å°Žèˆªæ¬„æ¸›å°‘': 'ëª¨ë°”ì¼ ë²„ì „ ì½˜í…ì¸ ì˜ ë‚´ë¹„ê²Œì´ì…˜ ë°” ê±°ë¦¬ ê°ì†Œ',
        'å…§å®¹å€åŸŸ': 'ì½˜í…ì¸  ì˜ì—­',
        'æ–‡æª”åˆ—è¡¨': 'ë¬¸ì„œ ëª©ë¡',
        'æ–‡æª”è©³æƒ…': 'ë¬¸ì„œ ì„¸ë¶€ì •ë³´',
        'æ–‡æª”åç¨±': 'ë¬¸ì„œ ì´ë¦„',
        'æ–‡æª”é¡žåž‹': 'ë¬¸ì„œ ìœ í˜•',
        'ä¸Šå‚³æ™‚é–“': 'ì—…ë¡œë“œ ì‹œê°„',
        'è™•ç†ç‹€æ…‹': 'ì²˜ë¦¬ ìƒíƒœ',
        'è™•ç†ä¸­': 'ì²˜ë¦¬ ì¤‘',
        'å·²å®Œæˆ': 'ì™„ë£Œë¨',
        'å¤±æ•—': 'ì‹¤íŒ¨',
        'é‡è©¦': 'ìž¬ì‹œë„',
        'åˆªé™¤': 'ì‚­ì œ',
        'ä¸‹è¼‰': 'ë‹¤ìš´ë¡œë“œ',
        'æŸ¥çœ‹': 'ë³´ê¸°',
        'ç·¨è¼¯': 'íŽ¸ì§‘',
        'å–æ¶ˆ': 'ì·¨ì†Œ',
        'ç¢ºèª': 'í™•ì¸',
        'ä¿å­˜': 'ì €ìž¥',
        'è¿”å›ž': 'ëŒì•„ê°€ê¸°',
        'ä¸‹ä¸€æ­¥': 'ë‹¤ìŒ',
        'ä¸Šä¸€æ­¥': 'ì´ì „',
        'å®Œæˆ': 'ì™„ë£Œ',
        'é–‹å§‹': 'ì‹œìž‘',
        'çµæŸ': 'ì¢…ë£Œ',
        'ç¸½è¨ˆ': 'í•©ê³„',
        'è«‹é¸æ“‡': 'ì„ íƒí•˜ì„¸ìš”',
        'è«‹è¼¸å…¥': 'ìž…ë ¥í•˜ì„¸ìš”',
        'è«‹ä¸Šå‚³': 'ì—…ë¡œë“œí•˜ì„¸ìš”',
        'é»žæ“Šä¸Šå‚³': 'í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ',
        'æ‹–æ‹½æ–‡ä»¶è‡³æ­¤': 'íŒŒì¼ì„ ì—¬ê¸°ë¡œ ë“œëž˜ê·¸',
        'æˆ–': 'ë˜ëŠ”',
        'æ”¯æ´çš„æ–‡ä»¶é¡žåž‹': 'ì§€ì›ë˜ëŠ” íŒŒì¼ ìœ í˜•',
        'æœ€å¤§æ–‡ä»¶å¤§å°': 'ìµœëŒ€ íŒŒì¼ í¬ê¸°',
        'ä¸Šå‚³æˆåŠŸ': 'ì—…ë¡œë“œ ì„±ê³µ',
        'ä¸Šå‚³å¤±æ•—': 'ì—…ë¡œë“œ ì‹¤íŒ¨',
        'è™•ç†æˆåŠŸ': 'ì²˜ë¦¬ ì„±ê³µ',
        'è™•ç†å¤±æ•—': 'ì²˜ë¦¬ ì‹¤íŒ¨',
        'åˆªé™¤æˆåŠŸ': 'ì‚­ì œ ì„±ê³µ',
        'åˆªé™¤å¤±æ•—': 'ì‚­ì œ ì‹¤íŒ¨',
        'ä¿å­˜æˆåŠŸ': 'ì €ìž¥ ì„±ê³µ',
        'ä¿å­˜å¤±æ•—': 'ì €ìž¥ ì‹¤íŒ¨',
        'è«‹ç¨å€™': 'ìž ì‹œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”',
        'åŠ è¼‰ä¸­': 'ë¡œë”© ì¤‘',
        'æ­£åœ¨è™•ç†': 'ì²˜ë¦¬ ì¤‘',
        'æ­£åœ¨ä¸Šå‚³': 'ì—…ë¡œë“œ ì¤‘',
        'æ­£åœ¨ä¸‹è¼‰': 'ë‹¤ìš´ë¡œë“œ ì¤‘',
        'éŠ€è¡Œå°å¸³å–®': 'ì€í–‰ ëª…ì„¸ì„œ',
        'æ”¶æ“š': 'ì˜ìˆ˜ì¦',
        'ç™¼ç¥¨': 'ì²­êµ¬ì„œ',
        'å¸³æˆ¶': 'ê³„ì •',
        'è¨ˆè²»': 'ê²°ì œ',
        'é…ç½®': 'ì„¤ì •',
        'å„€è¡¨æ¿': 'ëŒ€ì‹œë³´ë“œ',
        'é …ç›®': 'í”„ë¡œì íŠ¸',
        'æ–‡æª”': 'ë¬¸ì„œ',
        'ç”¨æˆ¶': 'ì‚¬ìš©ìž',
        'ç™»å‡º': 'ë¡œê·¸ì•„ì›ƒ',
        'ç™»å…¥': 'ë¡œê·¸ì¸',
        'è¨»å†Š': 'ê°€ìž…',
        'å¿˜è¨˜å¯†ç¢¼': 'ë¹„ë°€ë²ˆí˜¸ ì°¾ê¸°',
        'é‡ç½®å¯†ç¢¼': 'ë¹„ë°€ë²ˆí˜¸ ìž¬ì„¤ì •',
        'æ›´æ”¹å¯†ç¢¼': 'ë¹„ë°€ë²ˆí˜¸ ë³€ê²½',
        'å€‹äººè³‡æ–™': 'í”„ë¡œí•„',
        'é€šçŸ¥': 'ì•Œë¦¼',
        'å¹«åŠ©': 'ë„ì›€ë§',
        'é—œæ–¼': 'ì •ë³´',
        'è¯ç¹«æˆ‘å€‘': 'ë¬¸ì˜í•˜ê¸°',
        'éš±ç§æ”¿ç­–': 'ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨',
        'æœå‹™æ¢æ¬¾': 'ì„œë¹„ìŠ¤ ì•½ê´€',
    }
}

def translate_file(file_path, lang_code):
    """ç¿»è¯‘å•ä¸ªæ–‡ä»¶"""
    
    if not os.path.exists(file_path):
        return 0, 0
    
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    chinese_before = len(re.findall(r'[ä¸€-é¾¥]', content))
    
    # èŽ·å–è¯¥è¯­è¨€çš„ç¿»è¯‘å­—å…¸
    translations = TRANSLATIONS.get(lang_code, {})
    
    # æŒ‰é•¿åº¦æŽ’åºï¼Œå…ˆæ›¿æ¢é•¿çš„
    sorted_trans = sorted(translations.items(), key=lambda x: len(x[0]), reverse=True)
    
    replaced = 0
    for chinese, target in sorted_trans:
        if chinese in content:
            content = content.replace(chinese, target)
            replaced += 1
    
    # ä¿å­˜
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    chinese_after = len(re.findall(r'[ä¸€-é¾¥]', content))
    
    return chinese_before, chinese_after

def main():
    """ä¸»å‡½æ•°"""
    
    print("ðŸš€ å¼€å§‹å…¨é¢ç¿»è¯‘æ‰€æœ‰é¡µé¢...")
    print("="*70)
    
    # å®šä¹‰è¦å¤„ç†çš„é¡µé¢
    pages = [
        'firstproject.html',
        'account.html',
        'billing.html',
        'dashboard.html',
        'document-detail.html',
        'terms.html',
        'privacy.html',
    ]
    
    # è¯­è¨€é…ç½®
    languages = {
        'en': 'ðŸ‡¬ðŸ‡§è‹±æ–‡',
        'jp': 'ðŸ‡¯ðŸ‡µæ—¥æ–‡',
        'kr': 'ðŸ‡°ðŸ‡·éŸ©æ–‡',
    }
    
    # ç»Ÿè®¡
    total_stats = defaultdict(lambda: {'before': 0, 'after': 0})
    
    # å¤„ç†æ¯ä¸ªé¡µé¢
    for page_idx, page in enumerate(pages, 1):
        print(f"\n{'='*70}")
        print(f"Phase {page_idx}/{len(pages)}: {page}")
        print(f"{'='*70}")
        
        for lang_code, lang_name in languages.items():
            file_path = f"{lang_code}/{page}"
            
            print(f"\n  {lang_name} ({file_path})...")
            
            before, after = translate_file(file_path, lang_code)
            
            if before > 0:
                percentage = ((before - after) / before * 100)
                print(f"    ç¿»è¯‘å‰: {before:,} ä¸ªä¸­æ–‡å­—ç¬¦")
                print(f"    ç¿»è¯‘åŽ: {after:,} ä¸ªä¸­æ–‡å­—ç¬¦")
                print(f"    å·²ç¿»è¯‘: {before - after:,} ä¸ªå­—ç¬¦ ({percentage:.1f}%)")
                
                total_stats[lang_code]['before'] += before
                total_stats[lang_code]['after'] += after
            else:
                print(f"    æ–‡ä»¶ä¸å­˜åœ¨æˆ–æ— ä¸­æ–‡")
    
    # æœ€ç»ˆç»Ÿè®¡
    print(f"\n{'='*70}")
    print("ðŸŽ‰ å…¨é¢ç¿»è¯‘å®Œæˆï¼")
    print(f"{'='*70}")
    
    grand_total_before = 0
    grand_total_after = 0
    
    for lang_code, lang_name in languages.items():
        stats = total_stats[lang_code]
        before = stats['before']
        after = stats['after']
        translated = before - after
        
        if before > 0:
            percentage = (translated / before * 100)
            print(f"\n{lang_name}:")
            print(f"  åŽŸå§‹: {before:,} ä¸ªå­—ç¬¦")
            print(f"  å‰©ä½™: {after:,} ä¸ªå­—ç¬¦")
            print(f"  ç¿»è¯‘: {translated:,} ä¸ªå­—ç¬¦ ({percentage:.1f}%)")
            
            grand_total_before += before
            grand_total_after += after
    
    grand_translated = grand_total_before - grand_total_after
    grand_percentage = (grand_translated / grand_total_before * 100) if grand_total_before > 0 else 0
    
    print(f"\n{'='*70}")
    print(f"ðŸ“Š æ€»è®¡:")
    print(f"  åŽŸå§‹: {grand_total_before:,} ä¸ªå­—ç¬¦")
    print(f"  å‰©ä½™: {grand_total_after:,} ä¸ªå­—ç¬¦")
    print(f"  ç¿»è¯‘: {grand_translated:,} ä¸ªå­—ç¬¦ ({grand_percentage:.1f}%)")
    print(f"{'='*70}")

if __name__ == '__main__':
    main()

