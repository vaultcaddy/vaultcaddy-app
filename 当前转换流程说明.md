# ğŸ“– å½“å‰é“¶è¡Œå¯¹è´¦å•è½¬æ¢æµç¨‹è¯´æ˜

> **å›ç­”æ‚¨çš„é—®é¢˜ï¼š"è®²è§£ä¸€ä¸‹ç°åœ¨çš„è½¬æ¢çš„å·¥ä½œæµç¨‹"**  
> **æœ€åæ›´æ–°ï¼š** 2026-02-03

---

## ğŸ”„ å®Œæ•´æµç¨‹ï¼ˆ10æ­¥ï¼‰

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ï¸âƒ£ ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ + åˆ›å»ºæ–‡æ¡£è®°å½•                              â”‚
â”‚     â€¢ ç«‹å³åœ¨Firestoreåˆ›å»º"processing"çŠ¶æ€çš„æ–‡æ¡£              â”‚
â”‚     â€¢ ç”¨æˆ·é©¬ä¸Šçœ‹åˆ°"å¤„ç†ä¸­"çš„æ–‡ä»¶                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ï¸âƒ£ æ£€æŸ¥Creditsä½™é¢                                         â”‚
â”‚     â€¢ è®¡ç®—æ‰€æœ‰æ–‡ä»¶çš„æ€»é¡µæ•°                                   â”‚
â”‚     â€¢ creditsManager.checkCredits(totalPages)               â”‚
â”‚     â€¢ ä¸è¶³ â†’ åˆ é™¤æ–‡æ¡£ + åœæ­¢                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ï¸âƒ£ æ–‡ä»¶ç±»å‹åˆ¤æ–­                                            â”‚
â”‚     â€¢ æ£€æŸ¥æ˜¯å¦ä¸ºPDF                                          â”‚
â”‚     â€¢ æ˜¯ â†’ éœ€è¦è½¬æ¢  / å¦ â†’ ç›´æ¥å¤„ç†                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  4ï¸âƒ£ ä¸Šä¼ åˆ°Firebase Storage                                  â”‚
â”‚     â€¢ å¦‚æœæ˜¯PDFï¼Œå…ˆç”¨pdf.jsè½¬ä¸ºå›¾ç‰‡ï¼ˆ300 DPIï¼‰               â”‚
â”‚     â€¢ å¹¶è¡Œä¸Šä¼ æ‰€æœ‰å›¾ç‰‡                                       â”‚
â”‚     â€¢ è·å–å…¬å¼€URLæ•°ç»„                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  5ï¸âƒ£ æ‰£é™¤Creditsï¼ˆçœŸæ­£æ‰£é™¤ï¼‰                                 â”‚
â”‚     â€¢ creditsManager.deductCredits(pages)                   â”‚
â”‚     â€¢ æ¯é¡µæ‰£1 Credit                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  6ï¸âƒ£ è°ƒç”¨åƒé—®AI                                              â”‚
â”‚     â€¢ æ–‡ä»¶â†’Base64                                            â”‚
â”‚     â€¢ ç”ŸæˆPrompt â†’ åƒé—®VL-Max API                           â”‚
â”‚     â€¢ ç­‰å¾…8-15ç§’                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  7ï¸âƒ£ è§£æAIå“åº”                                              â”‚
â”‚     â€¢ æ¸…ç†markdownæ ‡è®°                                       â”‚
â”‚     â€¢ JSON.parse() + éªŒè¯                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8ï¸âƒ£ å‰ç«¯åå¤„ç†ï¼ˆæ ¸å¿ƒï¼‰                                      â”‚
â”‚     â€¢ postProcessTransactions()                             â”‚
â”‚     â€¢ å¡«å……ç©ºç™½æ—¥æœŸï¼ˆåŒæ—¥å¤šç¬”äº¤æ˜“ï¼‰                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  9ï¸âƒ£ ä¿å­˜åˆ°Firestore                                         â”‚
â”‚     â€¢ æ›´æ–°æ–‡æ¡£çŠ¶æ€ï¼šprocessing â†’ completed                   â”‚
â”‚     â€¢ ä¿å­˜æå–çš„æ•°æ®                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ”Ÿ åˆ·æ–°UIæ˜¾ç¤º                                               â”‚
â”‚     â€¢ è¯»å–æœ€æ–°æ•°æ®                                           â”‚
â”‚     â€¢ æ¸²æŸ“è¡¨æ ¼ï¼Œè®¡ç®—æ±‡æ€»                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**â­ å…³é”®é¡ºåºï¼ˆæ‚¨æŒ‡å‡ºçš„ï¼‰ï¼š**
1. ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ + å»ºç«‹æ–‡æ¡£
2. æ‰£é™¤Creditsï¼ˆå…ˆæ£€æŸ¥ï¼Œåæ‰£é™¤ï¼‰
3. æ–‡ä»¶ç±»å‹åˆ¤æ–­
4. ä¸Šä¼ åˆ°Firebase Storage

---

## è¯¦ç»†æ­¥éª¤

### 1ï¸âƒ£ ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ + åˆ›å»ºæ–‡æ¡£è®°å½•
- **ä½ç½®ï¼š** `firstproject.html` â†’ `handleUpload()` å‡½æ•°
- **æ”¯æŒæ ¼å¼ï¼š** PDFã€JPGã€PNG
- **è§¦å‘ï¼š** ç”¨æˆ·ç‚¹å‡»"Upload files"æˆ–æ‹–æ‹½æ–‡ä»¶
- **ç«‹å³åˆ›å»ºï¼š** åœ¨Firestoreä¸­åˆ›å»º"å¤„ç†ä¸­"çŠ¶æ€çš„æ–‡æ¡£è®°å½•
  ```javascript
  {
    name: file.name,
    status: 'processing',  // å¤„ç†ä¸­
    pages: 0,  // æš‚æ—¶ä¸º0
    createdAt: now
  }
  ```
- **ç”¨æˆ·ä½“éªŒï¼š** ç«‹å³åœ¨åˆ—è¡¨ä¸­çœ‹åˆ°"å¤„ç†ä¸­"çš„æ–‡ä»¶

### 2ï¸âƒ£ æ£€æŸ¥Creditsä½™é¢
- **å·¥å…·ï¼š** `credits-manager.js`
- **æ—¶æœºï¼š** åœ¨å¼€å§‹å¤„ç†ä¹‹å‰æ£€æŸ¥
- **è®¡ç®—ï¼š** å…ˆè®¡ç®—æ‰€æœ‰æ–‡ä»¶çš„æ€»é¡µæ•°
- **éªŒè¯ï¼š** `creditsManager.checkCredits(totalPages)`
- **ä¸è¶³å¤„ç†ï¼š** 
  - åˆ é™¤å·²åˆ›å»ºçš„å ä½æ–‡æ¡£
  - æ˜¾ç¤ºå……å€¼æç¤º
  - åœæ­¢å¤„ç†

### 3ï¸âƒ£ æ–‡ä»¶ç±»å‹åˆ¤æ–­ + PDFè½¬å›¾ç‰‡
- **å·¥å…·ï¼š** `pdf-to-image-converter.js`
- **åº“ï¼š** pdf.js
- **è®¾ç½®ï¼š** 300 DPIï¼ˆé«˜æ¸…ï¼‰
- **åˆ¤æ–­ï¼š** `pdfToImageConverter.isPDF(file)`
- **è½¬æ¢ï¼š** å¦‚æœæ˜¯PDF â†’ è½¬æ¢ä¸º1å¼ æˆ–å¤šå¼ å›¾ç‰‡
- **è¾“å‡ºï¼š** å›¾ç‰‡æ–‡ä»¶æ•°ç»„ `[file1.jpg, file2.jpg, ...]`

### 4ï¸âƒ£ ä¸Šä¼ åˆ°Firebase Storage
- **è·¯å¾„ï¼š** `projects/{projectId}/documents/{docId}/page_1.jpg`
- **æ–¹å¼ï¼š** å¹¶è¡Œä¸Šä¼ æ‰€æœ‰å›¾ç‰‡
  ```javascript
  Promise.all(filesToProcess.map(f => uploadFile(projectId, f)))
  ```
- **ä½œç”¨ï¼š** è·å–å…¬å¼€URLï¼Œä¾›AIè®¿é—®
- **æ›´æ–°æ–‡æ¡£ï¼š** æ·»åŠ  `imageUrls[]` åˆ°æ–‡æ¡£è®°å½•

### 5ï¸âƒ£ æ‰£é™¤Creditsï¼ˆçœŸæ­£æ‰£é™¤ï¼‰
- **å·¥å…·ï¼š** `credits-manager.js`
- **æ—¶æœºï¼š** ä¸Šä¼ StorageæˆåŠŸå
- **è§„åˆ™ï¼š** æ¯é¡µæ‰£1 Credit
- **æ‰£é™¤ï¼š** `creditsManager.deductCredits(pages)`
- **æ³¨æ„ï¼š** è¿™æ˜¯çœŸæ­£ä»ä½™é¢ä¸­æ‰£é™¤çš„æ—¶åˆ»

### 6ï¸âƒ£ è°ƒç”¨åƒé—®AIï¼ˆæ ¸å¿ƒæ­¥éª¤ï¼‰
**æ–‡ä»¶ï¼š** `qwen-vl-max-processor.js`

```javascript
// 1. æ–‡ä»¶â†’Base64
const base64 = await fileToBase64(file);

// 2. ç”ŸæˆPrompt
const prompt = generatePrompt('bank_statement');

// 3. æ„å»ºè¯·æ±‚
{
  model: "qwen3-vl-plus-2025-12-19",
  messages: [{
    role: "user",
    content: [
      {type: "image_url", image_url: {url: "data:image/jpeg;base64,..."}},
      {type: "text", text: prompt}
    ]
  }],
  temperature: 0.1,
  max_tokens: 4000
}

// 4. é€šè¿‡Workerè½¬å‘
POST â†’ deepseek-proxy.vaultcaddy.workers.dev

// 5. ç­‰å¾…8-15ç§’
// 6. æ¥æ”¶å“åº”
```

**Promptæ ¸å¿ƒå†…å®¹ï¼š**
```
ä½ æ˜¯OCRå¤å°æœºï¼Œåªå¤åˆ¶å¯è§æ–‡æœ¬ï¼Œä¸è¦è®¡ç®—ã€‚

å­—æ®µè§„åˆ™ï¼š
â€¢ date: å¦‚æœä¸ºç©º â†’ è¾“å‡º "" (ç©ºå­—ç¬¦ä¸²)
â€¢ debit: å€Ÿé¡¹é‡‘é¢
â€¢ credit: è´·é¡¹é‡‘é¢
â€¢ balance: ä½™é¢

è¾“å‡ºçº¯JSONï¼Œä¸è¦markdownã€‚
```

### 7ï¸âƒ£ è§£æå“åº”
- **æ¸…ç†ï¼š** ç§»é™¤markdownæ ‡è®°ï¼ˆ```jsonï¼‰
- **è§£æï¼š** JSON.parse()
- **éªŒè¯ï¼š** æ£€æŸ¥å¿…éœ€å­—æ®µ

### 8ï¸âƒ£ **å‰ç«¯åå¤„ç†ï¼ˆå…³é”®æ­¥éª¤ï¼‰**
**å‡½æ•°ï¼š** `postProcessTransactions()`

**ä½œç”¨ï¼š** å¡«å……æ’ç”Ÿé“¶è¡Œçš„ç©ºç™½æ—¥æœŸ

**é€»è¾‘ï¼š**
```javascript
lastValidDate = null

for each transaction:
    if (dateä¸ºç©º):
        transaction.date = lastValidDate  // ä½¿ç”¨ä¸Šä¸€ç¬”çš„æ—¥æœŸ
    else:
        lastValidDate = transaction.date  // æ›´æ–°æœ‰æ•ˆæ—¥æœŸ
```

**ç¤ºä¾‹ï¼š**
```
è¾“å…¥ï¼ˆAIæå–ï¼‰ï¼š
[
  {date: "10 Mar", desc: "ATM", debit: 500},
  {date: "",       desc: "è½¬è´¦", debit: 200},  â† ç©ºç™½
  {date: "",       desc: "POS", debit: 150}   â† ç©ºç™½
]

è¾“å‡ºï¼ˆå‰ç«¯å¤„ç†åï¼‰ï¼š
[
  {date: "10 Mar", desc: "ATM", debit: 500},
  {date: "10 Mar", desc: "è½¬è´¦", debit: 200},  â† å·²å¡«å……
  {date: "10 Mar", desc: "POS", debit: 150}   â† å·²å¡«å……
]
```

### 9ï¸âƒ£ ä¿å­˜åˆ°Firestore
**è·¯å¾„ï¼š** `projects/{projectId}/documents/{docId}`

**æ›´æ–°æ–‡æ¡£çŠ¶æ€ï¼š**
```javascript
{
  name: "æ–‡æ¡£åç§°",
  status: "completed",  // ä» "processing" æ”¹ä¸º "completed"
  processedData: {å¤„ç†åçš„å®Œæ•´æ•°æ®},
  rawText: {AIåŸå§‹å“åº”},
  processingTime: 12345,
  processor: "qwen-vl-max",
  model: "qwen3-vl-plus-2025-12-19",
  createdAt: Timestamp
}
```

### ğŸ”Ÿ åˆ·æ–°UIæ˜¾ç¤º
- ä»Firestoreè¯»å–æœ€æ–°æ•°æ®
- æ¸²æŸ“è¡¨æ ¼ï¼Œæ˜¾ç¤ºæ‰€æœ‰äº¤æ˜“
- è®¡ç®—æ±‡æ€»ï¼ˆæ€»æ”¶å…¥ã€æ€»æ”¯å‡ºã€ä½™é¢ï¼‰

---

## ğŸ¯ å…³é”®æŠ€æœ¯ç‚¹

### 1. Creditsçš„ä¸¤æ­¥å¤„ç†æœºåˆ¶

**ä¸ºä»€ä¹ˆåˆ†ä¸¤æ­¥ï¼Ÿ**

**æ­¥éª¤2ï¼šæ£€æŸ¥ä½™é¢ï¼ˆcheckCreditsï¼‰**
- **æ—¶æœºï¼š** åœ¨å¼€å§‹ä»»ä½•å¤„ç†ä¹‹å‰
- **ä½œç”¨ï¼š** ç¡®ä¿ç”¨æˆ·æœ‰è¶³å¤Ÿçš„Credits
- **ä½ç½®ï¼š** `handleUpload()` å‡½æ•°ä¸­
- **ä»£ç ï¼š**
  ```javascript
  const hasEnoughCredits = await creditsManager.checkCredits(totalPages);
  if (!hasEnoughCredits) {
      // åˆ é™¤å·²åˆ›å»ºçš„å ä½æ–‡æ¡£
      // æ˜¾ç¤ºå……å€¼æç¤º
      return; // åœæ­¢å¤„ç†
  }
  ```

**æ­¥éª¤5ï¼šçœŸæ­£æ‰£é™¤ï¼ˆdeductCreditsï¼‰**
- **æ—¶æœºï¼š** ä¸Šä¼ StorageæˆåŠŸåï¼ŒAIå¤„ç†ä¹‹å‰
- **ä½œç”¨ï¼š** ä»ç”¨æˆ·ä½™é¢ä¸­æ‰£é™¤Credits
- **ä½ç½®ï¼š** `uploadFileWithExistingDoc()` å‡½æ•°ä¸­
- **ä»£ç ï¼š**
  ```javascript
  await creditsManager.deductCredits(filesToProcess.length);
  logger.log(`ğŸ’° å·²æ‰£é™¤ ${filesToProcess.length} Credits`);
  ```

**ä¸ºä»€ä¹ˆä¸åœ¨æ­¥éª¤2å°±æ‰£é™¤ï¼Ÿ**
- âœ… é¿å…æå‰æ‰£è´¹ï¼ˆå¦‚æœPDFè½¬æ¢å¤±è´¥ï¼Œå°±ä¸æ‰£è´¹ï¼‰
- âœ… æŒ‰å®é™…å¤„ç†çš„é¡µæ•°æ‰£è´¹ï¼ˆæ›´å‡†ç¡®ï¼‰
- âœ… å¤±è´¥æ—¶å¯ä»¥é€€å›Credits

---

### 2. åŒé‡ç­–ç•¥ï¼ˆPrompt + åå¤„ç†ï¼‰

**Promptå‘Šè¯‰AIï¼š**
- "å¦‚æœæ—¥æœŸä¸ºç©ºï¼Œè¾“å‡ºç©ºå­—ç¬¦ä¸²''"
- "ä¸è¦è‡ªå·±å¡«å……æ—¥æœŸ"

**å‰ç«¯å¤„ç†ï¼š**
- æ£€æµ‹ç©ºå­—ç¬¦ä¸²
- ç”¨ç¡®å®šæ€§ç®—æ³•å¡«å……
- 100%å¯é 

### 3. ä¸ºä»€ä¹ˆä¸è®©AIç›´æ¥å¡«å……æ—¥æœŸï¼Ÿ

**é—®é¢˜ï¼š** AIè§†è§‰ç†è§£ä¸ç¨³å®š
- å¯èƒ½æŠŠ"10 Mar"å¤åˆ¶åˆ°é”™è¯¯çš„è¡Œ
- å¯èƒ½è¯†åˆ«é”™è¯¯çš„æ—¥æœŸæ–‡æœ¬
- å‡†ç¡®ç‡åªæœ‰60-70%

**è§£å†³ï¼š** å‰ç«¯JavaScriptç¡®å®šæ€§ç®—æ³•
- ç¡®å®šæ€§é€»è¾‘ï¼Œ100%å¯é 
- ä¸ä¾èµ–AIçš„è§†è§‰ç†è§£
- å‡†ç¡®ç‡98%+

---

## ğŸ“Š å¤šé¡µæ–‡æ¡£å¤„ç†

**æ–¹å¼ï¼š** æ‰¹é‡æ¨¡å¼

```
[å›¾1, å›¾2, å›¾3] â†’ å…¨éƒ¨Base64 â†’ ä¸€æ¬¡æ€§å‘ç»™AI â†’ 
AIçœ‹å®Œæ•´ä¸Šä¸‹æ–‡ â†’ è¿”å›åˆå¹¶ç»“æœ
```

**ä¼˜åŠ¿ï¼š**
- âœ… åªéœ€1æ¬¡APIè°ƒç”¨ï¼ˆçœé’±ï¼‰
- âœ… AIå¯ä»¥çœ‹åˆ°å®Œæ•´ä¿¡æ¯ï¼ˆæ›´å‡†ç¡®ï¼‰
- âœ… é€Ÿåº¦æ›´å¿«

---

## âš ï¸ æ’ç”Ÿé“¶è¡Œé—®é¢˜

æ‚¨æåˆ°"é—®é¢˜æ— æ³•è§£å†³"ï¼Œè®©æˆ‘è¯Šæ–­ï¼š

### å¯èƒ½æ€§1ï¼šAIå®Œå…¨ä¸è¯†åˆ«æ—¥æœŸï¼Ÿ
**æ£€æŸ¥ï¼š** æ‰“å¼€æ§åˆ¶å°ï¼ŒæŸ¥çœ‹AIåŸå§‹å“åº”
```javascript
// æŸ¥çœ‹æœ€æ–°æ–‡æ¡£
const docs = await window.simpleDataManager.getDocuments(currentProjectId);
console.log('AIåŸå§‹å“åº”:', docs[0].rawText);
```

**å¦‚æœç¬¬ä¸€ç¬”çš„æ—¥æœŸä¹Ÿæ˜¯ç©ºï¼Œè¯´æ˜AIè¯†åˆ«å¤±è´¥ã€‚**

### å¯èƒ½æ€§2ï¼šåå¤„ç†æ²¡æ‰§è¡Œï¼Ÿ
**æ£€æŸ¥ï¼š** åœ¨ `qwen-vl-max-processor.js` ç¬¬107è¡Œæ·»åŠ æ—¥å¿—
```javascript
console.log('ğŸ” åå¤„ç†å‰:', extractedData.transactions);
const processedData = this.postProcessTransactions(extractedData);
console.log('âœ… åå¤„ç†å:', processedData.transactions);
```

### å¯èƒ½æ€§3ï¼šUIä¸æ˜¾ç¤ºï¼Ÿ
**æ£€æŸ¥ï¼š** `firstproject.html` è¡¨æ ¼æ¸²æŸ“ä»£ç 

---

## ğŸ’¡ è§£å†³æ–¹æ¡ˆå»ºè®®

### å¦‚æœAIè¯†åˆ«å¤±è´¥
**æ–¹æ¡ˆAï¼š** å¢å¼ºPrompt
- æ·»åŠ æ›´å¤šç¤ºä¾‹
- æ˜ç¡®è¯´æ˜è¡¨æ ¼ç»“æ„

**æ–¹æ¡ˆBï¼š** OCRé¢„å¤„ç†
- ä½¿ç”¨Tesseract.jså…ˆè¯†åˆ«æ–‡æœ¬
- è·å–åæ ‡ä¿¡æ¯
- ç”¨è§„åˆ™å¼•æ“å¯¹é½å­—æ®µ

### å¦‚æœåå¤„ç†æœ‰bug
- æ£€æŸ¥ç©ºç™½æ—¥æœŸçš„åˆ¤æ–­æ¡ä»¶
- æ£€æŸ¥lastValidDateçš„æ›´æ–°é€»è¾‘

---

## ğŸ“ æ€»ç»“

**å½“å‰æµç¨‹ï¼ˆ10æ­¥ï¼‰ï¼š**
1. âœ… ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶ â†’ **ç«‹å³åˆ›å»ºæ–‡æ¡£è®°å½•**ï¼ˆçŠ¶æ€ï¼šprocessingï¼‰
2. âœ… **æ£€æŸ¥Credits** â†’ éªŒè¯ä½™é¢æ˜¯å¦è¶³å¤Ÿ
3. âœ… æ–‡ä»¶ç±»å‹åˆ¤æ–­ â†’ PDFéœ€è¦è½¬æ¢
4. âœ… PDFè½¬å›¾ç‰‡ â†’ pdf.jsï¼ˆ300 DPIï¼‰
5. âœ… ä¸Šä¼ Storage â†’ è·å–å›¾ç‰‡URL
6. âœ… **æ‰£é™¤Credits** â†’ çœŸæ­£ä»ä½™é¢ä¸­æ‰£é™¤
7. âœ… **AIæå–** â†’ åƒé—®VL-Maxï¼ˆ8-15ç§’ï¼‰
8. âœ… è§£æå“åº” â†’ æ¸…ç†å’ŒéªŒè¯JSON
9. âœ… **å‰ç«¯åå¤„ç†** â†’ **å¡«å……ç©ºç™½æ—¥æœŸ**ï¼ˆæ ¸å¿ƒï¼‰
10. âœ… æ›´æ–°æ–‡æ¡£çŠ¶æ€ â†’ completed + æ˜¾ç¤ºç»“æœ

**æ ¸å¿ƒåˆ›æ–°ï¼š**
- âœ… Promptå‘Šè¯‰AI"ç©ºç™½å°±è¾“å‡ºç©ºå­—ç¬¦ä¸²"
- âœ… å‰ç«¯ç”¨ç¡®å®šæ€§ç®—æ³•å¡«å……
- âœ… ä¸ä¾èµ–AIçš„å®Œç¾ç†è§£

**ä¸‹ä¸€æ­¥ï¼š**
è¯·å‘Šè¯‰æˆ‘å…·ä½“å“ªä¸€æ­¥æœ‰é—®é¢˜ï¼Œæˆ‘å¯ä»¥é’ˆå¯¹æ€§è§£å†³ï¼

---

**åˆ›å»ºæ—¶é—´ï¼š** 2026-02-03  
**å›ç­”é—®é¢˜ï¼š** "è®²è§£ä¸€ä¸‹ç°åœ¨çš„è½¬æ¢çš„å·¥ä½œæµç¨‹"

