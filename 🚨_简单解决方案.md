# ğŸš¨ ç®€å•è§£å†³æ–¹æ¡ˆ

## é—®é¢˜æ ¹æº
ç³»ç»Ÿä¸­æœ‰å¤šä¸ªå‡½æ•°åœ¨ä½¿ç”¨æ—§çš„ `createUsageRecord` APIï¼Œä¸æ–°çš„ Billing Meter Events å†²çªã€‚

## âœ… æœ€ç®€å•çš„è§£å†³æ–¹æ¡ˆ

**ä¸éœ€è¦ç¦ç”¨æ—§å‡½æ•°ï¼** 

å› ä¸ºæ–°è®¢é˜…ä½¿ç”¨çš„æ˜¯æ–° Price ID (`price_1Sdn7pJmiQ31C0GTTK1yVopH`)ï¼Œè¿™ä¸ª Price å…³è”åˆ° Billing Meterï¼Œ**ä¸ä¼šæœ‰** `meteredSubscriptionItemId`ã€‚

æ—§çš„å‡½æ•°ï¼ˆå¦‚ `reportDailyUsage`ã€`reportCreditsUsage`ï¼‰ä¾èµ– `meteredSubscriptionItemId`ï¼Œå¦‚æœæ‰¾ä¸åˆ°å°±ä¼šè·³è¿‡ï¼Œä¸ä¼šæ‰§è¡Œã€‚

---

## ğŸ¯ çœŸæ­£çš„é—®é¢˜

ä»æ—¥å¿—çœ‹åˆ°çš„é”™è¯¯ï¼š
```
Cannot create a usage record for si_Tca7cha4Q7VtAJ 
because it is not on the legacy metered billing system. 
Call /v1/billing/meter_events instead.
```

è¿™è¯´æ˜**æŸä¸ªåœ°æ–¹**è¿˜åœ¨å°è¯•ä¸ºæ–°è®¢é˜…è°ƒç”¨æ—§ APIã€‚

---

## ğŸ” è®©æˆ‘ä»¬æµ‹è¯•æ–°è®¢é˜…

ç°åœ¨ç”¨æˆ·çš„è®¢é˜… (`sub_1SfKxPJmiQ31C0GTalF`) åº”è¯¥å·²ç»ä½¿ç”¨æ–°çš„ Meter Priceã€‚

**æµ‹è¯•æ­¥éª¤**ï¼š

1. **ç™»å½•è´¦å·** 1234@gmail.com
2. **ä¸Šä¼  1 ä¸ªæ–°æ–‡æ¡£**  
3. **æŸ¥çœ‹ Firebase Logs** åº”è¯¥çœ‹åˆ°ï¼š
   ```
   âœ… ä½¿ç”¨é‡å·²æŠ¥å‘Šç»™ Stripe Billing Meter
   ```

å¦‚æœè¿˜æ˜¯çœ‹åˆ°æ—§çš„ API é”™è¯¯ï¼Œè¯´æ˜ `deductCredits` ä¸­çš„ `reportUsageToStripe` è¿˜æœ‰é—®é¢˜ã€‚

---

## ğŸ“ å½“å‰çŠ¶æ€

- âœ… `reportUsageToStripe` å·²æ”¹ç”¨ Billing Meter Events API
- âœ… æ–° Price ID å·²æ›´æ–°
- âœ… å·²éƒ¨ç½²

**ä¸‹ä¸€æ­¥**ï¼šè®©ç”¨æˆ·ä¸Šä¼ ä¸€ä¸ªæ–°æ–‡æ¡£æµ‹è¯•ï¼



