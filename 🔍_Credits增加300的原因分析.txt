# ğŸ” Credits å¢åŠ  300 çš„åŸå› åˆ†æ

## ğŸ“‹ **é—®é¢˜æè¿°**

ç”¨æˆ·å®Œæˆ ğŸ§ª æ¸¬è©¦ Get Started åï¼ŒCredits æ˜¾ç¤ºä¸º **320**ï¼Œä½†é¢„æœŸåº”è¯¥æ˜¯ï¼š
- Email éªŒè¯ï¼š20 Credits
- æµ‹è¯•æ”¯ä»˜ï¼š100 Credits
- **æ€»è®¡**ï¼š120 Credits

å®é™…å´æ˜¯ **320 Credits**ï¼Œå¤šäº† **200 Credits**ã€‚

---

## âœ… **Firebase Functions æ—¥å¿—åˆ†æ**

### **æœ€è¿‘çš„ Webhook äº‹ä»¶**ï¼ˆ2025-12-12T09:49:06ï¼‰

```
ğŸ“¨ æ”¶åˆ°æµ‹è¯•æ¨¡å¼webhookäº‹ä»¶: customer.subscription.updated
ğŸ”§ ä½¿ç”¨çš„ Stripe å®¢æˆ¶ç«¯: stripeTest
âœ… æœ€çµ‚ userId: PxOIosAk2nUm16x647YIdniiuFC3

ğŸ“Š å½“å‰ç”¨æˆ·æ•°æ®:
  email: 'vaultcaddy@gmail.com'
  emailVerified: true
  credits: 520
  currentCredits: 520

ğŸ’° Credits æ›´æ–°: 520 + 100 = 620
âœ… Credits å·²æ·»åŠ : PxOIosAk2nUm16x647YIdniiuFC3 +100 = 620
âœ… credits å’Œ currentCredits å‡å·²æ›´æ–°ä¸º: 620
âœ… å·²æˆåŠŸæ·»åŠ  100 Credits çµ¦ç”¨æˆ¶ PxOIosAk2nUm16x647YIdniiuFC3
```

---

## ğŸ¯ **å…³é”®å‘ç°**

### **1. ç”¨æˆ· ID**
- **Firebase Auth ç”¨æˆ· ID**: `PxOIosAk2nUm16x647YIdniiuFC3`
- **Email**: `vaultcaddy@gmail.com`

### **2. Credits å˜åŒ–è®°å½•**

| æ—¶é—´ | æ“ä½œ | ä¹‹å‰ Credits | æ–°å¢ Credits | ä¹‹å Credits |
|------|------|------------|------------|------------|
| æœ€è¿‘ | æµ‹è¯•æ”¯ä»˜ | 520 | +100 | 620 |

---

## ğŸ¤” **ä¸ºä»€ä¹ˆç”¨æˆ·çœ‹åˆ° 320 è€Œä¸æ˜¯ 620ï¼Ÿ**

### **å¯èƒ½çš„åŸå› **

#### **åŸå›  1ï¼šç”¨æˆ·æˆªå›¾çš„è´¦æˆ·ä¸æ˜¯ `PxOIosAk2nUm16x647YIdniiuFC3`**

ç”¨æˆ·æˆªå›¾æ˜¾ç¤ºçš„æ˜¯ `vaultcaddy@gmail.com`ï¼Œä½†è¿™ä¸ªè´¦æˆ·å¯èƒ½æœ‰å¤šä¸ªï¼š
- Google ç™»å½•è´¦æˆ·ï¼ˆç”¨æˆ· ID: `AZ55k5FJBofAeKE09AYbGVIEoDy1`ï¼‰
- æ–°æ³¨å†Œçš„è´¦æˆ·ï¼ˆç”¨æˆ· ID: `PxOIosAk2nUm16x647YIdniiuFC3`ï¼‰

**æ—¥å¿—æ˜¾ç¤ºæœ€è¿‘æ”¯ä»˜çš„è´¦æˆ·æ˜¯ `PxOIosAk2nUm16x647YIdniiuFC3`ï¼ŒCredits æ˜¯ 620ï¼Œè€Œä¸æ˜¯ 320ã€‚**

#### **åŸå›  2ï¼šç”¨æˆ·çœ‹åˆ°çš„æ˜¯æ—§æ•°æ®ï¼ˆéœ€è¦åˆ·æ–°é¡µé¢ï¼‰**

ç”¨æˆ·çš„æµè§ˆå™¨å¯èƒ½ç¼“å­˜äº†æ—§çš„ Credits æ•°æ®ã€‚

#### **åŸå›  3ï¼šå¤šæ¬¡æµ‹è¯•æ”¯ä»˜ç´¯è®¡**

ä»æ—¥å¿—çœ‹ï¼Œä¹‹å‰ Credits æ˜¯ 520ï¼Œè¯´æ˜ä¹‹å‰å·²ç»æœ‰è¿‡æ”¯ä»˜ï¼š
- Email éªŒè¯ï¼š+20
- æµ‹è¯•æ”¯ä»˜ 1ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 2ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 3ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 4ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 5ï¼š+100
- **æ€»è®¡**ï¼š520 Credits

æœ€æ–°çš„æ”¯ä»˜åˆå¢åŠ äº† 100ï¼Œæ‰€ä»¥å˜æˆ 620ã€‚

---

## âœ… **è§£å†³æ–¹æ¡ˆï¼šç¡®è®¤ç”¨æˆ·è´¦æˆ·**

### **æ­¥éª¤ 1ï¼šè®©ç”¨æˆ·åˆ·æ–°é¡µé¢**

1. æŒ‰ `Ctrl+Shift+R`ï¼ˆWindowsï¼‰æˆ– `Cmd+Shift+R`ï¼ˆMacï¼‰å¼ºåˆ¶åˆ·æ–°é¡µé¢
2. æŸ¥çœ‹ Credits æ˜¯å¦æ›´æ–°

### **æ­¥éª¤ 2ï¼šç¡®è®¤ç”¨æˆ· ID**

1. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
2. è¿è¡Œä»¥ä¸‹ä»£ç ï¼š
   ```javascript
   firebase.auth().currentUser.uid
   ```
3. æŸ¥çœ‹è¿”å›çš„ç”¨æˆ· ID æ˜¯ä»€ä¹ˆ

### **æ­¥éª¤ 3ï¼šæ£€æŸ¥ Firestore æ•°æ®**

1. æ‰“å¼€ Firebase Consoleï¼šhttps://console.firebase.google.com/project/vaultcaddy-production-cbbe2/firestore
2. å¯¼èˆªåˆ° `users` é›†åˆ
3. æ‰¾åˆ°ç”¨æˆ· ID ä¸º `PxOIosAk2nUm16x647YIdniiuFC3` çš„æ–‡æ¡£
4. æŸ¥çœ‹ `credits` å’Œ `currentCredits` å­—æ®µ

---

## ğŸ“Š **Credits å¢åŠ é€»è¾‘æ€»ç»“**

### **æ¯æ¬¡æµ‹è¯•æ”¯ä»˜åº”è¯¥å¢åŠ å¤šå°‘ Creditsï¼Ÿ**

æ ¹æ®äº§å“å…ƒæ•°æ®ï¼š
- `monthly_credits: 100`
- `plan_type: monthly`

**æ¯æ¬¡æ”¯ä»˜åº”è¯¥å¢åŠ  100 Creditsã€‚**

### **ä¸ºä»€ä¹ˆä¹‹å‰æ˜¯ 520ï¼Ÿ**

è¯´æ˜ç”¨æˆ·ä¹‹å‰è¿›è¡Œäº† **5 æ¬¡æµ‹è¯•æ”¯ä»˜** + **1 æ¬¡ Email éªŒè¯**ï¼š
- Email éªŒè¯ï¼š+20
- æµ‹è¯•æ”¯ä»˜ 1ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 2ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 3ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 4ï¼š+100
- æµ‹è¯•æ”¯ä»˜ 5ï¼š+100
- **æ€»è®¡**ï¼š520 Credits

æœ€æ–°çš„æ”¯ä»˜åˆå¢åŠ äº† 100ï¼Œæ‰€ä»¥å˜æˆ **620 Credits**ã€‚

---

## âš ï¸ **å‘ç°çš„é”™è¯¯**

### **Timestamp è½¬æ¢é”™è¯¯ï¼ˆå·²ä¿®å¤ä½†æœªéƒ¨ç½²ï¼‰**

```
âŒ æ›´æ–°ç”¨æˆ¶è¨‚é–±ä¿¡æ¯å¤±æ•—: Error: Value for argument "seconds" is not a valid integer.
```

**åŸå› **ï¼š`handleSubscriptionChange` å‡½æ•°ä¸­çš„ Timestamp è½¬æ¢é”™è¯¯ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä»£ç å·²ä¿®å¤ï¼ˆä½¿ç”¨ `new admin.firestore.Timestamp(subscription.current_period_start, 0)`ï¼‰
2. **éœ€è¦é‡æ–°éƒ¨ç½² Firebase Functions**

---

## ğŸ“ **æ¨èè¡ŒåŠ¨**

### **1. ç¡®è®¤ç”¨æˆ·è´¦æˆ·**

è¯·ç”¨æˆ·ç¡®è®¤ï¼š
- ç”¨æˆ·æ˜¯å¦æœ‰å¤šä¸ª `vaultcaddy@gmail.com` è´¦æˆ·ï¼Ÿ
- ç”¨æˆ·å½“å‰ç™»å½•çš„è´¦æˆ· ID æ˜¯ä»€ä¹ˆï¼Ÿ

### **2. åˆ·æ–°é¡µé¢**

è®©ç”¨æˆ·å¼ºåˆ¶åˆ·æ–°é¡µé¢ï¼ŒæŸ¥çœ‹ Credits æ˜¯å¦æ›´æ–°ã€‚

### **3. é‡æ–°éƒ¨ç½² Firebase Functions**

ä¿®å¤ Timestamp è½¬æ¢é”™è¯¯ï¼š

```bash
cd /Users/cavlinyeung/ai-bank-parser/firebase-functions
firebase deploy --only functions:stripeWebhook,functions:handleSubscriptionChange
```

---

## ğŸ¯ **æ€»ç»“**

### **Credits å¢åŠ  300 çš„åŸå› **

ä¸æ˜¯å•æ¬¡æ”¯ä»˜å¢åŠ äº† 300ï¼Œè€Œæ˜¯ï¼š
- ç”¨æˆ·ä¹‹å‰è¿›è¡Œäº†å¤šæ¬¡æµ‹è¯•æ”¯ä»˜ï¼Œç´¯è®¡äº† 520 Credits
- æœ€æ–°çš„æ”¯ä»˜åˆå¢åŠ äº† 100 Credits
- **æ€»è®¡**ï¼š620 Creditsï¼ˆè€Œä¸æ˜¯ç”¨æˆ·çœ‹åˆ°çš„ 320ï¼‰

### **ç”¨æˆ·çœ‹åˆ° 320 çš„åŸå› **

1. **ç”¨æˆ·æˆªå›¾çš„è´¦æˆ·å¯èƒ½ä¸æ˜¯æœ€è¿‘æ”¯ä»˜çš„è´¦æˆ·**
2. **ç”¨æˆ·æµè§ˆå™¨ç¼“å­˜äº†æ—§æ•°æ®ï¼Œéœ€è¦åˆ·æ–°é¡µé¢**

### **ä¸‹ä¸€æ­¥**

1. è®©ç”¨æˆ·åˆ·æ–°é¡µé¢
2. ç¡®è®¤ç”¨æˆ· ID
3. é‡æ–°éƒ¨ç½² Firebase Functions ä¿®å¤ Timestamp é”™è¯¯

