# âœ… Excel æ ¼å¼ä¼˜åŒ–ï¼šåˆ é™¤æ—¥æœŸåˆ—ï¼Œæ·»åŠ åˆ†ç±»åˆ—

## ğŸ“‹ ç”¨æˆ·éœ€æ±‚
1. **åˆ é™¤åˆ—**: `PopulatedDate` å’Œ `EndDate`
2. **æ·»åŠ åˆ—**: `LineItems_Category` (åˆ†é¡)
3. **åˆ†ç±»æ˜¾ç¤ºè§„åˆ™**:
   - å¦‚æœæœªåˆ†ç±» â†’ æ˜¾ç¤ºç©ºç™½
   - å¦‚æœé€‰æ‹©äº†åˆ†ç±» â†’ æ˜¾ç¤ºä¸­æ–‡åˆ†ç±»åç§°ï¼ˆå¦‚"å·¥è³‡æ”¯å‡º"ï¼‰

---

## âœ… å·²å®Œæˆçš„æ›´æ”¹

### ä¿®æ”¹æ–‡ä»¶
`document-detail.html`

### ä¿®æ”¹ä½ç½®
ç¬¬ 3030-3109 è¡Œï¼ˆExcelå¯¼å‡ºéƒ¨åˆ†ï¼‰

---

## ğŸ“Š æ–°çš„Excelæ ¼å¼ï¼ˆ12åˆ—ï¼‰

### åˆ—ç»“æ„å¯¹æ¯”

#### **ä¿®æ”¹å‰ï¼ˆ14åˆ—ï¼‰**:
```
A: CustomerName
B: AccountNumber
C: AccountType
D: BankName
E: BankAddress
F: PopulatedDate         â† âŒ åˆ é™¤
G: EndDate               â† âŒ åˆ é™¤
H: OpeningBalance
I: EndingBalance
J: LineItems_Date
K: LineItems_Description
L: LineItems_Credits
M: LineItems_Debits
N: LineItems_Balance
```

#### **ä¿®æ”¹åï¼ˆ12åˆ—ï¼‰**:
```
A: CustomerName
B: AccountNumber
C: AccountType
D: BankName
E: BankAddress
F: OpeningBalance
G: EndingBalance
H: LineItems_Date
I: LineItems_Description
J: LineItems_Category    â† âœ… æ–°å¢
K: LineItems_Credits
L: LineItems_Debits
M: LineItems_Balance
```

---

## ğŸ·ï¸ åˆ†ç±»æ˜ å°„è¡¨

### æ”¶å…¥ç±»åˆ«
| Value | ä¸­æ–‡æ˜¾ç¤º | è‹±æ–‡ |
|-------|---------|------|
| `salary` | å·¥è³‡ | Salary |
| `sales` | éŠ·å”®æ”¶å…¥ | Sales Revenue |
| `interest` | åˆ©æ¯æ”¶å…¥ | Interest Income |
| `other-income` | å…¶ä»–æ”¶å…¥ | Other Income |

### æ”¯å‡ºç±»åˆ«
| Value | ä¸­æ–‡æ˜¾ç¤º | è‹±æ–‡ |
|-------|---------|------|
| `office` | è¾¦å…¬è²»ç”¨ | Office Expenses |
| `transport` | äº¤é€šè²»ç”¨ | Transportation |
| `meal` | é¤é£²è²»ç”¨ | Meal Expenses |
| `utilities` | æ°´é›»è²» | Utilities |
| `rent` | ç§Ÿé‡‘ | Rent |
| `salary-expense` | å·¥è³‡æ”¯å‡º | Salary Expense |
| `marketing` | ç‡ŸéŠ·è²»ç”¨ | Marketing |
| `supplies` | è¾¦å…¬ç”¨å“ | Supplies |
| `other-expense` | å…¶ä»–æ”¯å‡º | Other Expense |

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1ï¸âƒ£ æ›´æ–°æ ‡é¢˜è¡Œ
```javascript
// ä¿®æ”¹å‰ï¼ˆ14åˆ—ï¼‰
const excelData = [[
    'CustomerName', 'AccountNumber', 'AccountType', 'BankName', 'BankAddress',
    'PopulatedDate', 'EndDate', 'OpeningBalance', 'EndingBalance',
    'LineItems_Date', 'LineItems_Description', 'LineItems_Credits', 'LineItems_Debits', 'LineItems_Balance'
]];

// ä¿®æ”¹åï¼ˆ12åˆ—ï¼‰
const excelData = [[
    'CustomerName', 'AccountNumber', 'AccountType', 'BankName', 'BankAddress',
    'OpeningBalance', 'EndingBalance',
    'LineItems_Date', 'LineItems_Description', 'LineItems_Category', 'LineItems_Credits', 'LineItems_Debits', 'LineItems_Balance'
]];
```

### 2ï¸âƒ£ æ·»åŠ åˆ†ç±»è½¬æ¢å‡½æ•°
```javascript
const getCategoryLabel = (categoryValue) => {
    if (!categoryValue) return '';  // æœªåˆ†ç±» â†’ ç©ºç™½
    
    const categoryMap = {
        // æ”¶å…¥ç±»åˆ«
        'salary': 'å·¥è³‡',
        'sales': 'éŠ·å”®æ”¶å…¥',
        'interest': 'åˆ©æ¯æ”¶å…¥',
        'other-income': 'å…¶ä»–æ”¶å…¥',
        // æ”¯å‡ºç±»åˆ«
        'office': 'è¾¦å…¬è²»ç”¨',
        'transport': 'äº¤é€šè²»ç”¨',
        'meal': 'é¤é£²è²»ç”¨',
        'utilities': 'æ°´é›»è²»',
        'rent': 'ç§Ÿé‡‘',
        'salary-expense': 'å·¥è³‡æ”¯å‡º',
        'marketing': 'ç‡ŸéŠ·è²»ç”¨',
        'supplies': 'è¾¦å…¬ç”¨å“',
        'other-expense': 'å…¶ä»–æ”¯å‡º'
    };
    
    return categoryMap[categoryValue] || categoryValue;
};

const category = getCategoryLabel(tx.category);
```

### 3ï¸âƒ£ æ›´æ–°æ•°æ®è¡Œ
```javascript
// ä¿®æ”¹å‰
excelData.push([
    customerName,
    accountNumber,
    accountType,
    bankName,
    bankAddress,
    populatedDate,      // â† åˆ é™¤
    endDate,           // â† åˆ é™¤
    openingBalance,
    closingBalance,
    tx.date || '',
    tx.description || '',
    credits,
    debits,
    parseFloat(tx.balance || 0).toFixed(2)
]);

// ä¿®æ”¹å
excelData.push([
    customerName,
    accountNumber,
    accountType,
    bankName,
    bankAddress,
    openingBalance,
    closingBalance,
    tx.date || '',
    tx.description || '',
    category,          // â† æ–°å¢
    credits,
    debits,
    parseFloat(tx.balance || 0).toFixed(2)
]);
```

### 4ï¸âƒ£ æ›´æ–°åˆ—å®½è®¾ç½®
```javascript
// ä¿®æ”¹å‰ï¼ˆ14åˆ—ï¼‰
ws['!cols'] = [
    {wch: 20}, {wch: 15}, {wch: 18}, {wch: 20}, {wch: 40},
    {wch: 12}, {wch: 12}, {wch: 15}, {wch: 15},
    {wch: 12}, {wch: 40}, {wch: 12}, {wch: 12}, {wch: 15}
];

// ä¿®æ”¹åï¼ˆ12åˆ—ï¼‰
ws['!cols'] = [
    {wch: 20}, {wch: 15}, {wch: 18}, {wch: 20}, {wch: 40},
    {wch: 15}, {wch: 15},
    {wch: 12}, {wch: 40}, {wch: 15}, {wch: 12}, {wch: 12}, {wch: 15}
];
```

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: åˆ·æ–°é¡µé¢
```bash
Cmd + Shift + R  # å¼ºåˆ¶åˆ·æ–°
```

æ‰“å¼€: `https://vaultcaddy.com/document-detail.html?project=SJJkhY7CFdqh8zyVAM6B&id=vPwfbEF32mLC72EsZsDW`

### æ­¥éª¤ 2: ä¸ºäº¤æ˜“æ·»åŠ åˆ†ç±»
1. åœ¨äº¤æ˜“åˆ—è¡¨ä¸­ï¼Œé€‰æ‹©ä¸€ç¬”äº¤æ˜“
2. ä»"åˆ†é¡"ä¸‹æ‹‰èœå•ä¸­é€‰æ‹©åˆ†ç±»ï¼ˆå¦‚"å·¥è³‡æ”¯å‡º"ï¼‰
3. ç­‰å¾…è‡ªåŠ¨ä¿å­˜

### æ­¥éª¤ 3: å¯¼å‡ºExcel
1. ç‚¹å‡» **Export** æŒ‰é’®
2. é€‰æ‹© **Excel (.xlsx)**
3. æ‰“å¼€ä¸‹è½½çš„æ–‡ä»¶

### æ­¥éª¤ 4: éªŒè¯Excelæ ¼å¼

**é¢„æœŸç»“æœ**:
- âœ… **åˆ—æ•°**: 12åˆ—ï¼ˆä¸å†æ˜¯14åˆ—ï¼‰
- âœ… **ç¼ºå°‘**: `PopulatedDate` å’Œ `EndDate` åˆ—
- âœ… **æ–°å¢**: `LineItems_Category` åˆ—ï¼ˆJåˆ—ï¼‰
- âœ… **åˆ†ç±»æ˜¾ç¤º**:
  - æœªåˆ†ç±»äº¤æ˜“ â†’ Jåˆ—ä¸ºç©ºç™½
  - å·²åˆ†ç±»äº¤æ˜“ â†’ Jåˆ—æ˜¾ç¤ºä¸­æ–‡åˆ†ç±»åç§°ï¼ˆå¦‚"å·¥è³‡æ”¯å‡º"ï¼‰

---

## ğŸ“ ç¤ºä¾‹æ•°æ®

### ç½‘é¡µç‰ˆ:
| æ—¥æœŸ | æè¿° | åˆ†é¡ | é‡‘é¡ | ä½™é¢ |
|------|------|------|------|------|
| 2021-07-02 | SIC ALIPAY HK LTD | **å·¥è³‡æ”¯å‡º** | +21.62 | 59,434.45 |
| 2021-07-02 | Transfer | **æœªåˆ†é¡** | -25,823.00 | 36,071.41 |

### Excelç‰ˆï¼ˆæ–°æ ¼å¼ï¼‰:
```
| H: LineItems_Date | I: LineItems_Description | J: LineItems_Category | K: Credits | L: Debits | M: Balance |
|-------------------|--------------------------|----------------------|------------|-----------|------------|
| 2021-07-02        | SIC ALIPAY HK LTD        | å·¥è³‡æ”¯å‡º              | 21.62      |           | 59434.45   |
| 2021-07-02        | Transfer                 |                      |            | 25823.00  | 36071.41   |
```

---

## ğŸ¯ ä¼˜ç‚¹

### 1ï¸âƒ£ **ç®€åŒ–æ ¼å¼**
- ä»14åˆ—å‡å°‘åˆ°12åˆ—
- åˆ é™¤äº†å†—ä½™çš„æ—¥æœŸåˆ—ï¼ˆæœŸåˆ/æœŸæœ«æ—¥æœŸï¼‰

### 2ï¸âƒ£ **å¢å¼ºåŠŸèƒ½**
- æ·»åŠ äº†åˆ†ç±»åˆ—ï¼Œæ–¹ä¾¿ä¼šè®¡åˆ†æ
- æ”¯æŒè‡ªå®šä¹‰åˆ†ç±»

### 3ï¸âƒ£ **çµæ´»æ˜¾ç¤º**
- æœªåˆ†ç±»äº¤æ˜“æ˜¾ç¤ºç©ºç™½
- å·²åˆ†ç±»äº¤æ˜“æ˜¾ç¤ºä¸­æ–‡åç§°

### 4ï¸âƒ£ **å‘åå…¼å®¹**
- æ‰€æœ‰åŸºæœ¬å­—æ®µä¿ç•™
- äº¤æ˜“æ•°æ®å®Œæ•´

---

## ğŸ“ æ–‡ä»¶æ›´æ”¹æ€»ç»“

| æ–‡ä»¶ | æ›´æ”¹å†…å®¹ | è¡Œæ•° |
|-----|---------|------|
| `document-detail.html` | æ›´æ–°Excelæ ‡é¢˜è¡Œï¼ˆåˆ é™¤2åˆ—ï¼Œæ·»åŠ 1åˆ—ï¼‰ | ~3031-3035 |
| `document-detail.html` | æ·»åŠ  `getCategoryLabel()` å‡½æ•° | ~3041-3060 |
| `document-detail.html` | æ›´æ–°æ•°æ®è¡Œï¼ˆåˆ é™¤2ä¸ªå­—æ®µï¼Œæ·»åŠ categoryï¼‰ | ~3065-3093 |
| `document-detail.html` | æ›´æ–°åˆ—å®½é…ç½®ï¼ˆ12åˆ—ï¼‰ | ~3104-3107 |

---

## ğŸ”— ç›¸å…³æ–‡æ¡£
- `âœ…_Excelå¯¼å‡ºå’Œå­—æ®µåç§°ä¿®å¤_2026-01-21.md` - Excelå¯¼å‡ºCredits/Debitsä¿®å¤
- `âœ…_ä¿®å¤åˆ†è¡Œåœ°å€æ˜ å°„åˆ°BankAddress_2026-01-21.md` - BankAddressæ˜ å°„ä¿®å¤

---

**åˆ›å»ºæ—¶é—´**: 2026-01-21  
**ä½œè€…**: VaultCaddy AI Assistant  
**ç›¸å…³æ–‡ä»¶**: `document-detail.html`, `document-detail-new.js`
