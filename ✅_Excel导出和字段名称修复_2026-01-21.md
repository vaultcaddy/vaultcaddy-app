# âœ… Excel å¯¼å‡ºå’Œå­—æ®µåç§°ä¿®å¤

## ğŸ“‹ ç”¨æˆ·åé¦ˆçš„é—®é¢˜

### é—®é¢˜ 1: Excel å¯¼å‡ºä¸­æ‰€æœ‰é‡‘é¢éƒ½æ˜¾ç¤ºä¸º Creditsï¼ˆæ”¶å…¥ï¼‰
**ç°è±¡**: 
- å›¾1ï¼ˆExcelæ–‡ä»¶ï¼‰ä¸­æ‰€æœ‰äº¤æ˜“éƒ½æ˜¾ç¤ºåœ¨ `LineItems_Credits` åˆ—
- `LineItems_Debits` åˆ—å…¨éƒ¨ä¸ºç©º
- ä½†ç½‘é¡µç‰ˆï¼ˆå›¾2ï¼‰ä¸­å·²ç»æ­£ç¡®æ˜¾ç¤ºäº† +ï¼ˆæ”¶å…¥ï¼‰å’Œ -ï¼ˆæ”¯å‡ºï¼‰

**åŸå› **: 
å€Ÿè´·åˆ¤æ–­é€»è¾‘æœ‰è¯¯ï¼Œæ¡ä»¶ä½¿ç”¨äº† `||`ï¼ˆæˆ–ï¼‰è¿ç®—ç¬¦ï¼Œå¯¼è‡´åªè¦æ»¡è¶³ä»»ä¸€æ¡ä»¶å°±ä¼šå½’ç±»ä¸ºæ”¶å…¥ã€‚

### é—®é¢˜ 2: å­—æ®µåç§°ä¸æ­£ç¡®
**ç°è±¡**: 
- é¡µé¢æ˜¾ç¤º"åˆ†è¡Œåç¨±"
- ç”¨æˆ·å¸Œæœ›æ”¹ä¸º"åˆ†è¡Œåœ°å€"

---

## âœ… å·²å®Œæˆçš„ä¿®å¤

### 1ï¸âƒ£ ä¿®å¤ Excel å¯¼å‡ºçš„ Credits/Debits åˆ¤æ–­é€»è¾‘

**ä¿®æ”¹æ–‡ä»¶**: `document-detail.html`
**ä¿®æ”¹ä½ç½®**: ç¬¬ 3036-3074 è¡Œï¼ˆExcelå¯¼å‡ºéƒ¨åˆ†ï¼‰

#### **ä¿®æ”¹å‰çš„é€»è¾‘**ï¼ˆæœ‰é—®é¢˜ï¼‰:
```javascript
if (tx.transactionSign === 'income' || amount > 0) {
    credits = Math.abs(amount).toFixed(2);
} else if (tx.transactionSign === 'expense' || amount < 0) {
    debits = Math.abs(amount).toFixed(2);
}
```

**é—®é¢˜**: ä½¿ç”¨ `||` è¿ç®—ç¬¦ï¼Œåªè¦ `amount > 0` å°±ä¼šè®¾ç½®ä¸º creditsï¼Œå³ä½¿ `transactionSign` æ˜¯ 'expense'ã€‚

#### **ä¿®æ”¹åçš„é€»è¾‘**ï¼ˆæ­£ç¡®ï¼‰:
```javascript
// ğŸ”¥ ä¿®æ­£åˆ¤æ–­é€»è¾‘ï¼šä¼˜å…ˆä½¿ç”¨ transactionSign
if (tx.transactionSign === 'income') {
    // æ”¶å…¥ = Credits
    credits = Math.abs(amount).toFixed(2);
    debits = '';
} else if (tx.transactionSign === 'expense') {
    // æ”¯å‡º = Debits
    credits = '';
    debits = Math.abs(amount).toFixed(2);
} else {
    // å¦‚æœæ²¡æœ‰ transactionSignï¼Œæ ¹æ®é‡‘é¢ç¬¦å·åˆ¤æ–­
    if (amount >= 0) {
        credits = Math.abs(amount).toFixed(2);
        debits = '';
    } else {
        credits = '';
        debits = Math.abs(amount).toFixed(2);
    }
}
```

**æ”¹è¿›**:
1. âœ… **ä¼˜å…ˆä½¿ç”¨ `transactionSign`**: æ˜ç¡®çš„æ”¶å…¥/æ”¯å‡ºæ ‡è®°
2. âœ… **ç‹¬ç«‹åˆ¤æ–­**: ä½¿ç”¨ `if...else if...else` ç¡®ä¿äº’æ–¥
3. âœ… **æ˜¾å¼æ¸…ç©º**: ç¡®ä¿æœªä½¿ç”¨çš„åˆ—ä¸ºç©ºå­—ç¬¦ä¸²
4. âœ… **å¤‡ç”¨é€»è¾‘**: å¦‚æœæ²¡æœ‰ `transactionSign`ï¼Œæ‰æ ¹æ®é‡‘é¢ç¬¦å·åˆ¤æ–­

---

### 2ï¸âƒ£ æ›´æ–°å­—æ®µåç§°ï¼šåˆ†è¡Œåç¨± â†’ åˆ†è¡Œåœ°å€

**ä¿®æ”¹æ–‡ä»¶**: `document-detail-new.js`
**ä¿®æ”¹ä½ç½®**: ç¿»è¯‘å¯¹è±¡ï¼ˆ4ä¸ªè¯­è¨€ç‰ˆæœ¬ï¼‰

#### **ä¸­æ–‡ï¼ˆç¹ä½“ï¼‰**:
```javascript
// ä¿®æ”¹å‰
branchName: 'åˆ†è¡Œåç¨±',

// ä¿®æ”¹å
branchName: 'åˆ†è¡Œåœ°å€',
```

#### **è‹±æ–‡**:
```javascript
// ä¿®æ”¹å‰
branchName: 'Branch',

// ä¿®æ”¹å
branchName: 'Branch Address',
```

#### **æ—¥æ–‡**:
```javascript
// ä¿®æ”¹å‰
branchName: 'æ”¯åº—å',

// ä¿®æ”¹å
branchName: 'æ”¯åº—ä½æ‰€',
```

#### **éŸ©æ–‡**:
```javascript
// ä¿®æ”¹å‰
branchName: 'ì§€ì ëª…',

// ä¿®æ”¹å
branchName: 'ì§€ì  ì£¼ì†Œ',
```

#### **Placeholder ç¤ºä¾‹**:
```javascript
// ä¿®æ”¹å‰
placeholder="${currentLang === 'zh-TW' ? 'ä¸­ç’°åˆ†è¡Œ' : 'Central Branch'}"

// ä¿®æ”¹å
placeholder="${currentLang === 'zh-TW' ? 'é¦™æ¸¯ä¸­ç’°èŠ±åœ’é“33æ¨“' : 'Central Branch Address'}"
```

---

## ğŸ“Š Excel æ–‡ä»¶æ ¼å¼è¯´æ˜

### 14åˆ—å®Œæ•´æ ¼å¼:
| åˆ—å | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `CustomerName` | å®¢æˆ·åç§° | TUG COMPANY LIMITED |
| `AccountNumber` | è´¦æˆ·å·ç  | 861-512-08367-3 |
| `AccountType` | è´¦æˆ·ç±»å‹ | Integrated Account |
| `BankName` | é“¶è¡Œåç§° | ä¸­åœ‹å·¥å•†éŠ€è¡Œï¼ˆäºæ´²ï¼‰æœ‰é™å…¬å¸ |
| `BankAddress` | é“¶è¡Œåœ°å€ | EAST POINT CITY (766)... |
| `PopulatedDate` | å¯¹è´¦å•å¼€å§‹æ—¥æœŸ | 07/01/2021 |
| `EndDate` | å¯¹è´¦å•ç»“æŸæ—¥æœŸ | 07/06/2021 |
| `OpeningBalance` | æœŸåˆä½™é¢ | 59417.89 |
| `EndingBalance` | æœŸæœ«ä½™é¢ | 25645.72 |
| `LineItems_Date` | äº¤æ˜“æ—¥æœŸ | 07/01/2021 |
| `LineItems_Description` | äº¤æ˜“æè¿° | æ‰¿ä¸Šè½‰é¡ |
| `LineItems_Credits` | å­˜å…¥ï¼ˆæ”¶å…¥ï¼‰| 21.62 æˆ– ç©º |
| `LineItems_Debits` | æ”¯å‡º | 93.06 æˆ– ç©º |
| `LineItems_Balance` | ä½™é¢ | 59417.89 |

### Credits vs Debits è§„åˆ™:
- âœ… **æ”¶å…¥ (income)**: é‡‘é¢æ˜¾ç¤ºåœ¨ `LineItems_Credits` åˆ—
- âœ… **æ”¯å‡º (expense)**: é‡‘é¢æ˜¾ç¤ºåœ¨ `LineItems_Debits` åˆ—
- âœ… **äº’æ–¥**: æ¯ç¬”äº¤æ˜“åªèƒ½æ˜¯æ”¶å…¥æˆ–æ”¯å‡ºä¹‹ä¸€

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: åˆ·æ–°é¡µé¢
```bash
Cmd + Shift + R  # å¼ºåˆ¶åˆ·æ–°
```

æ‰“å¼€: `https://vaultcaddy.com/document-detail.html?project=SJJkhY7CFdqh8zyVAM6B&id=vPwfbEF32mLC72EsZsDW`

### æ­¥éª¤ 2: éªŒè¯å­—æ®µåç§°
**é¢„æœŸç»“æœ**:
- âœ… å­—æ®µæ ‡ç­¾æ˜¾ç¤º"åˆ†è¡Œåœ°å€"ï¼ˆä¸æ˜¯"åˆ†è¡Œåç¨±"ï¼‰
- âœ… Placeholder æ˜¾ç¤º"é¦™æ¸¯ä¸­ç’°èŠ±åœ’é“33æ¨“"

### æ­¥éª¤ 3: æµ‹è¯• Excel å¯¼å‡º
1. ç‚¹å‡» **Export** æŒ‰é’®
2. é€‰æ‹© **Excel (.xlsx)**
3. æ‰“å¼€ä¸‹è½½çš„æ–‡ä»¶

**é¢„æœŸç»“æœ**:
- âœ… **æ”¶å…¥äº¤æ˜“**: é‡‘é¢æ˜¾ç¤ºåœ¨ `LineItems_Credits` åˆ—
  - ä¾‹å¦‚: 21.62, 5.06 ç­‰
- âœ… **æ”¯å‡ºäº¤æ˜“**: é‡‘é¢æ˜¾ç¤ºåœ¨ `LineItems_Debits` åˆ—
  - ä¾‹å¦‚: 93.06, 2366.90 ç­‰
- âœ… **äº’æ–¥**: æ¯è¡Œåªæœ‰ä¸€ä¸ªåˆ—æœ‰å€¼ï¼ˆCredits æˆ– Debitsï¼‰

### æ­¥éª¤ 4: å¯¹æ¯”ç½‘é¡µç‰ˆå’ŒExcel
- ç½‘é¡µç‰ˆæ˜¾ç¤º `+21.62` â†’ Excel æ˜¾ç¤º Credits: `21.62`
- ç½‘é¡µç‰ˆæ˜¾ç¤º `-93.06` â†’ Excel æ˜¾ç¤º Debits: `93.06`

---

## ğŸ“ æ–‡ä»¶æ›´æ”¹æ€»ç»“

| æ–‡ä»¶ | æ›´æ”¹å†…å®¹ | è¡Œæ•° |
|-----|---------|------|
| `document-detail.html` | ä¿®å¤ Credits/Debits åˆ¤æ–­é€»è¾‘ | ~3036-3074 |
| `document-detail-new.js` | æ›´æ–°ä¸­æ–‡ç¿»è¯‘ï¼šåˆ†è¡Œåç¨± â†’ åˆ†è¡Œåœ°å€ | ~40 |
| `document-detail-new.js` | æ›´æ–°è‹±æ–‡ç¿»è¯‘ï¼šBranch â†’ Branch Address | ~107 |
| `document-detail-new.js` | æ›´æ–°æ—¥æ–‡ç¿»è¯‘ï¼šæ”¯åº—å â†’ æ”¯åº—ä½æ‰€ | ~174 |
| `document-detail-new.js` | æ›´æ–°éŸ©æ–‡ç¿»è¯‘ï¼šì§€ì ëª… â†’ ì§€ì  ì£¼ì†Œ | ~241 |
| `document-detail-new.js` | æ›´æ–° placeholder ç¤ºä¾‹ | ~1545 |

---

## ğŸ¯ ä¸‹ä¸€æ­¥

1. **ç«‹å³æµ‹è¯•**: åˆ·æ–°é¡µé¢ï¼ŒéªŒè¯æ‰€æœ‰åŠŸèƒ½
2. **éªŒè¯Excel**: æ‰“å¼€å¯¼å‡ºçš„Excelæ–‡ä»¶ï¼Œç¡®è®¤ Credits/Debits æ­£ç¡®åˆ†ç¦»
3. **éªŒè¯å­—æ®µ**: ç¡®è®¤"åˆ†è¡Œåœ°å€"å­—æ®µæ˜¾ç¤ºæ­£ç¡®

---

## âœ… å®ŒæˆçŠ¶æ€

| ä»»åŠ¡ | çŠ¶æ€ |
|-----|------|
| ä¿®å¤ Excel Credits/Debits åˆ¤æ–­é€»è¾‘ | âœ… å®Œæˆ |
| æ›´æ–°å­—æ®µåç§°ï¼ˆä¸­æ–‡ï¼‰ | âœ… å®Œæˆ |
| æ›´æ–°å­—æ®µåç§°ï¼ˆè‹±æ–‡ï¼‰ | âœ… å®Œæˆ |
| æ›´æ–°å­—æ®µåç§°ï¼ˆæ—¥æ–‡ï¼‰ | âœ… å®Œæˆ |
| æ›´æ–°å­—æ®µåç§°ï¼ˆéŸ©æ–‡ï¼‰ | âœ… å®Œæˆ |
| æ›´æ–° placeholder ç¤ºä¾‹ | âœ… å®Œæˆ |

---

**åˆ›å»ºæ—¶é—´**: 2026-01-21  
**ä½œè€…**: VaultCaddy AI Assistant  
**ç›¸å…³æ–‡ä»¶**: `document-detail.html`, `document-detail-new.js`
