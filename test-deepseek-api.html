<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DeepSeek API æ¸¬è©¦å·¥å…·</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h1 {
            color: #1f2937;
            margin-bottom: 30px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            background: #f9fafb;
            border-radius: 8px;
            border-left: 4px solid #3b82f6;
        }
        .test-title {
            font-size: 18px;
            font-weight: 600;
            color: #1f2937;
            margin-bottom: 15px;
        }
        .test-description {
            color: #6b7280;
            margin-bottom: 15px;
            line-height: 1.6;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background 0.2s;
        }
        button:hover {
            background: #2563eb;
        }
        button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        .result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 6px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.6;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        .result.success {
            background: #d1fae5;
            color: #065f46;
            border: 1px solid #10b981;
        }
        .result.error {
            background: #fee2e2;
            color: #991b1b;
            border: 1px solid #ef4444;
        }
        .result.info {
            background: #dbeafe;
            color: #1e40af;
            border: 1px solid #3b82f6;
        }
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #fff;
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 0.6s linear infinite;
            margin-left: 8px;
            vertical-align: middle;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        code {
            background: #f3f4f6;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 13px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” DeepSeek API è¨ºæ–·å·¥å…·</h1>

        <!-- æ¸¬è©¦ 1ï¼šWorker å¥åº·æª¢æŸ¥ -->
        <div class="test-section">
            <div class="test-title">æ¸¬è©¦ 1ï¼šCloudflare Worker å¥åº·æª¢æŸ¥</div>
            <div class="test-description">
                æª¢æŸ¥ Worker æ˜¯å¦æ­£ç¢ºéƒ¨ç½²ä¸¦æ”¯æŒ <code>deepseek-reasoner</code> æ¨¡å‹
            </div>
            <button onclick="testWorkerHealth()" id="test1-btn">é–‹å§‹æ¸¬è©¦</button>
            <div id="test1-result"></div>
        </div>

        <!-- æ¸¬è©¦ 2ï¼šç›´æ¥æ¸¬è©¦ DeepSeek API -->
        <div class="test-section">
            <div class="test-title">æ¸¬è©¦ 2ï¼šç›´æ¥æ¸¬è©¦ DeepSeek API Key</div>
            <div class="test-description">
                ç›´æ¥èª¿ç”¨ DeepSeek APIï¼Œé©—è­‰ API Key æ˜¯å¦æœ‰æ•ˆ<br>
                <strong>API Key:</strong> <code>sk-d0edd459796441c1905439794123867</code><br>
                <br>
                <strong>âš ï¸ æ³¨æ„ï¼š</strong> æ­¤æ¸¬è©¦å¯èƒ½å›  CORS é™åˆ¶è€Œå¤±æ•—ï¼Œé€™æ˜¯æ­£å¸¸çš„ï¼<br>
                DeepSeek API ä¸å…è¨±ç›´æ¥å¾ç€è¦½å™¨èª¿ç”¨ï¼Œå¿…é ˆé€šéæœå‹™å™¨ï¼ˆå¦‚ Cloudflare Workerï¼‰ã€‚<br>
                <strong>åªè¦æ¸¬è©¦ 3ã€4 æˆåŠŸï¼Œå°±èªªæ˜é…ç½®æ­£ç¢ºï¼</strong>
            </div>
            <button onclick="testDeepSeekAPI()" id="test2-btn">é–‹å§‹æ¸¬è©¦</button>
            <div id="test2-result"></div>
        </div>

        <!-- æ¸¬è©¦ 3ï¼šé€šé Worker èª¿ç”¨ DeepSeek -->
        <div class="test-section">
            <div class="test-title">æ¸¬è©¦ 3ï¼šé€šé Worker èª¿ç”¨ DeepSeek API</div>
            <div class="test-description">
                æ¨¡æ“¬å¯¦éš›æ‡‰ç”¨çš„èª¿ç”¨æµç¨‹ï¼Œæ¸¬è©¦å®Œæ•´éˆè·¯
            </div>
            <button onclick="testWorkerProxy()" id="test3-btn">é–‹å§‹æ¸¬è©¦</button>
            <div id="test3-result"></div>
        </div>

        <!-- æ¸¬è©¦ 4ï¼šæ¸¬è©¦ deepseek-reasoner æ¨¡å‹ -->
        <div class="test-section">
            <div class="test-title">æ¸¬è©¦ 4ï¼šæ¸¬è©¦ deepseek-reasoner æ¨¡å‹</div>
            <div class="test-description">
                æ¸¬è©¦ <code>deepseek-reasoner</code> æ¨¡å‹çš„èª¿ç”¨å’Œè¼¸å‡º
            </div>
            <button onclick="testReasonerModel()" id="test4-btn">é–‹å§‹æ¸¬è©¦</button>
            <div id="test4-result"></div>
        </div>
    </div>

    <script>
        const WORKER_URL = 'https://deepseek-proxy.vaultcaddy.workers.dev';
        const DEEPSEEK_API_URL = 'https://api.deepseek.com/v1/chat/completions';
        const API_KEY = 'sk-d0edd459796441c1905439794123867';

        // æ¸¬è©¦ 1ï¼šWorker å¥åº·æª¢æŸ¥
        async function testWorkerHealth() {
            const btn = document.getElementById('test1-btn');
            const result = document.getElementById('test1-result');
            
            btn.disabled = true;
            btn.innerHTML = 'æ¸¬è©¦ä¸­<span class="loading"></span>';
            result.innerHTML = '<div class="result info">â³ æ­£åœ¨æ¸¬è©¦...</div>';

            try {
                const response = await fetch(WORKER_URL, {
                    method: 'GET'
                });

                const data = await response.json();
                
                if (data.status === 'ok' && data.supported_models.includes('deepseek-reasoner')) {
                    result.innerHTML = `<div class="result success">âœ… Worker å¥åº·æª¢æŸ¥é€šéï¼

ç‹€æ…‹: ${data.status}
ç‰ˆæœ¬: ${data.version}
æ”¯æŒçš„æ¨¡å‹: ${data.supported_models.join(', ')}
æœ€å¤§è¶…æ™‚: ${data.max_timeout}
æ›´æ–°æ—¥æœŸ: ${data.updated}

ğŸ‰ Worker å·²æ­£ç¢ºéƒ¨ç½²ä¸¦æ”¯æŒ deepseek-reasonerï¼</div>`;
                } else {
                    result.innerHTML = `<div class="result error">âŒ Worker éƒ¨ç½²æœ‰å•é¡Œ

éŸ¿æ‡‰å…§å®¹:
${JSON.stringify(data, null, 2)}

å•é¡Œï¼šæœªæ‰¾åˆ° deepseek-reasoner æ¨¡å‹æ”¯æŒ</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="result error">âŒ Worker å¥åº·æª¢æŸ¥å¤±æ•—

éŒ¯èª¤: ${error.message}

å¯èƒ½åŸå› ï¼š
1. Worker æœªéƒ¨ç½²
2. Worker URL ä¸æ­£ç¢º
3. ç¶²çµ¡é€£æ¥å•é¡Œ</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'é‡æ–°æ¸¬è©¦';
            }
        }

        // æ¸¬è©¦ 2ï¼šç›´æ¥æ¸¬è©¦ DeepSeek API
        async function testDeepSeekAPI() {
            const btn = document.getElementById('test2-btn');
            const result = document.getElementById('test2-result');
            
            btn.disabled = true;
            btn.innerHTML = 'æ¸¬è©¦ä¸­<span class="loading"></span>';
            result.innerHTML = '<div class="result info">â³ æ­£åœ¨èª¿ç”¨ DeepSeek API...</div>';

            try {
                const response = await fetch(DEEPSEEK_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'deepseek-reasoner',
                        messages: [
                            {role: 'system', content: 'ä½ æ˜¯æ¸¬è©¦åŠ©æ‰‹'},
                            {role: 'user', content: 'å›ç­”ï¼š1+1=?'}
                        ],
                        max_tokens: 100
                    })
                });

                const data = await response.json();
                
                if (response.ok && data.choices) {
                    result.innerHTML = `<div class="result success">âœ… API Key æœ‰æ•ˆï¼

æ¨¡å‹: ${data.model}
AI å›ç­”: ${data.choices[0].message.content}

è¼¸å…¥ tokens: ${data.usage.prompt_tokens}
è¼¸å‡º tokens: ${data.usage.completion_tokens}
ç¸½è¨ˆ tokens: ${data.usage.total_tokens}

ğŸ‰ DeepSeek API èª¿ç”¨æˆåŠŸï¼</div>`;
                } else {
                    result.innerHTML = `<div class="result error">âŒ API Key ç„¡æ•ˆæˆ–èª¿ç”¨å¤±æ•—

HTTP ç‹€æ…‹: ${response.status}
éŒ¯èª¤å…§å®¹:
${JSON.stringify(data, null, 2)}

è§£æ±ºæ–¹æ¡ˆï¼š
1. æª¢æŸ¥ API Key æ˜¯å¦æ­£ç¢º
2. ç¢ºèª API Key æ²’æœ‰éæœŸ
3. ç¢ºèªå¸³æˆ¶æœ‰é¤˜é¡</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="result error">âŒ DeepSeek API èª¿ç”¨å¤±æ•—

éŒ¯èª¤: ${error.message}

å¯èƒ½åŸå› ï¼š
1. API Key ç„¡æ•ˆ
2. ç¶²çµ¡é€£æ¥å•é¡Œ
3. CORS å•é¡Œ</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'é‡æ–°æ¸¬è©¦';
            }
        }

        // æ¸¬è©¦ 3ï¼šé€šé Worker èª¿ç”¨
        async function testWorkerProxy() {
            const btn = document.getElementById('test3-btn');
            const result = document.getElementById('test3-result');
            
            btn.disabled = true;
            btn.innerHTML = 'æ¸¬è©¦ä¸­<span class="loading"></span>';
            result.innerHTML = '<div class="result info">â³ æ­£åœ¨é€šé Worker èª¿ç”¨...</div>';

            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'deepseek-reasoner',
                        messages: [
                            {role: 'system', content: 'ä½ æ˜¯æ¸¬è©¦åŠ©æ‰‹'},
                            {role: 'user', content: 'å›ç­”ï¼š2+2=?'}
                        ],
                        max_tokens: 100
                    })
                });

                const data = await response.json();
                
                if (response.ok && data.choices) {
                    result.innerHTML = `<div class="result success">âœ… Worker ä»£ç†èª¿ç”¨æˆåŠŸï¼

æ¨¡å‹: ${data.model}
AI å›ç­”: ${data.choices[0].message.content}

è¼¸å…¥ tokens: ${data.usage.prompt_tokens}
è¼¸å‡º tokens: ${data.usage.completion_tokens}
ç¸½è¨ˆ tokens: ${data.usage.total_tokens}

ğŸ‰ å®Œæ•´éˆè·¯æ¸¬è©¦é€šéï¼</div>`;
                } else {
                    result.innerHTML = `<div class="result error">âŒ Worker ä»£ç†èª¿ç”¨å¤±æ•—

HTTP ç‹€æ…‹: ${response.status}
éŒ¯èª¤å…§å®¹:
${JSON.stringify(data, null, 2)}

å¯èƒ½åŸå› ï¼š
1. Worker ä¸­çš„ API Key ä¸æ­£ç¢º
2. Worker ä»£ç¢¼æœ‰å•é¡Œ
3. DeepSeek API è¿”å›éŒ¯èª¤</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="result error">âŒ Worker ä»£ç†èª¿ç”¨å¤±æ•—

éŒ¯èª¤: ${error.message}

å¯èƒ½åŸå› ï¼š
1. Worker æœªæ­£ç¢ºéƒ¨ç½²
2. ç¶²çµ¡é€£æ¥å•é¡Œ
3. Worker è¶…æ™‚</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'é‡æ–°æ¸¬è©¦';
            }
        }

        // æ¸¬è©¦ 4ï¼šæ¸¬è©¦ reasoner æ¨¡å‹
        async function testReasonerModel() {
            const btn = document.getElementById('test4-btn');
            const result = document.getElementById('test4-result');
            
            btn.disabled = true;
            btn.innerHTML = 'æ¸¬è©¦ä¸­<span class="loading"></span>';
            result.innerHTML = '<div class="result info">â³ æ­£åœ¨æ¸¬è©¦ reasoner æ¨¡å‹...</div>';

            try {
                const response = await fetch(WORKER_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'deepseek-reasoner',
                        messages: [
                            {role: 'system', content: 'ä½ æ˜¯æœƒè¨ˆAIåŠ©æ‰‹'},
                            {role: 'user', content: 'è§£é‡‹ä»€éº¼æ˜¯éŠ€è¡Œå°å¸³å–®ï¼Ÿ'}
                        ],
                        max_tokens: 8192
                    })
                });

                const data = await response.json();
                
                if (response.ok && data.choices) {
                    const answer = data.choices[0].message.content;
                    result.innerHTML = `<div class="result success">âœ… Reasoner æ¨¡å‹æ¸¬è©¦æˆåŠŸï¼

æ¨¡å‹: ${data.model}
AI å›ç­”: ${answer.substring(0, 200)}${answer.length > 200 ? '...' : ''}

è¼¸å…¥ tokens: ${data.usage.prompt_tokens}
è¼¸å‡º tokens: ${data.usage.completion_tokens}
ç¸½è¨ˆ tokens: ${data.usage.total_tokens}

max_tokens è¨­ç½®: 8192

ğŸ‰ Reasoner æ¨¡å‹å·¥ä½œæ­£å¸¸ï¼Œå¯ä»¥è™•ç†é•·è¼¸å‡ºï¼</div>`;
                } else {
                    result.innerHTML = `<div class="result error">âŒ Reasoner æ¨¡å‹æ¸¬è©¦å¤±æ•—

HTTP ç‹€æ…‹: ${response.status}
éŒ¯èª¤å…§å®¹:
${JSON.stringify(data, null, 2)}</div>`;
                }
            } catch (error) {
                result.innerHTML = `<div class="result error">âŒ Reasoner æ¨¡å‹æ¸¬è©¦å¤±æ•—

éŒ¯èª¤: ${error.message}</div>`;
            } finally {
                btn.disabled = false;
                btn.innerHTML = 'é‡æ–°æ¸¬è©¦';
            }
        }

        // é é¢è¼‰å…¥æ™‚çš„æç¤º
        console.log('ğŸ” DeepSeek API è¨ºæ–·å·¥å…·å·²è¼‰å…¥');
        console.log('ğŸ“ è«‹ä¾æ¬¡åŸ·è¡Œ 4 å€‹æ¸¬è©¦');
        console.log('');
        console.log('æ¸¬è©¦ 1ï¼šæª¢æŸ¥ Worker æ˜¯å¦éƒ¨ç½²');
        console.log('æ¸¬è©¦ 2ï¼šæª¢æŸ¥ API Key æ˜¯å¦æœ‰æ•ˆ');
        console.log('æ¸¬è©¦ 3ï¼šæª¢æŸ¥å®Œæ•´éˆè·¯æ˜¯å¦æ­£å¸¸');
        console.log('æ¸¬è©¦ 4ï¼šæª¢æŸ¥ reasoner æ¨¡å‹æ˜¯å¦å·¥ä½œ');
    </script>
</body>
</html>

