âœ… ä¸¤ä¸ªé—®é¢˜å·²ä¿®å¤å®Œæˆï¼
================================
å®Œæˆæ—¶é—´ï¼š2025å¹´12æœˆ10æ—¥
éƒ¨ç½²çŠ¶æ€ï¼šâœ… å·²æˆåŠŸéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

---

## ğŸ› **é—®é¢˜1ï¼šç‚¹å‡»Get Startedåå¡ä½**

### **åŸå› åˆ†æï¼š**
```javascript
// âŒ é”™è¯¯ä»£ç ï¼ˆä¿®æ”¹å‰ï¼‰
async function createCheckoutSession(planType) {
    const button = event.target;  // â† event æœªå®šä¹‰ï¼
    //...
}
```

**é—®é¢˜ï¼š**
- å‡½æ•°æ²¡æœ‰æ¥æ”¶ `event` å‚æ•°
- ç›´æ¥ä½¿ç”¨ `event.target` å¯¼è‡´ JavaScript é”™è¯¯
- é¡µé¢æ˜¾ç¤º"æ­£åœ¨è·³è½¬åˆ°æ”¯ä»˜é¡µé¢..."åå¡ä½

### **âœ… ä¿®å¤æ–¹æ¡ˆï¼š**
```javascript
// âœ… æ­£ç¡®ä»£ç ï¼ˆä¿®æ”¹åï¼‰
async function createCheckoutSession(planType, event) {  // â† æ·»åŠ  event å‚æ•°
    const button = event?.target || event?.currentTarget;  // â† å®‰å…¨è®¿é—®
    const originalText = button?.textContent || 'é–‹å§‹ä½¿ç”¨';
    if (button) {  // â† æ·»åŠ æ£€æŸ¥
        button.disabled = true;
        button.textContent = 'æ­£åœ¨è·³è½‰åˆ°æ”¯ä»˜é é¢...';
        button.style.opacity = '0.6';
    }
    //...
}
```

**HTMLæŒ‰é’®è°ƒç”¨ï¼š**
```html
<!-- âŒ ä¿®æ”¹å‰ -->
<button onclick="createCheckoutSession('monthly')">é–‹å§‹ä½¿ç”¨</button>

<!-- âœ… ä¿®æ”¹å -->
<button onclick="createCheckoutSession('monthly', event)">é–‹å§‹ä½¿ç”¨</button>
```

---

## ğŸ¯ **é—®é¢˜2ï¼šPrice ID é…ç½®ç¡®è®¤**

### **ä½ çš„è¦æ±‚ï¼š**
> "æˆ‘å€‘æœ‰ 4 ä¸ª Price IDï¼Œä½†ç•¶ç”¨æˆ¶é»é¸Monthlyå¾Œæ‡‰è©²æ˜¯ï¼š
> - æœˆè´¹åŸºç¡€ï¼ˆ$58ï¼‰: price_1ScS9QJmiQ31C0GTy4y6z0l0
> - æœˆè´¹ç”¨é‡ï¼ˆ$0èµ·ï¼‰: price_1ScSATJmiQ31C0GTW1qWu0OF
> 
> é»é¸å¹´è²»æ™‚æ˜¯ï¼š
> - å¹´è´¹åŸºç¡€ï¼ˆ$552ï¼‰: price_1ScS8EJmiQ31C0GT599VDffL
> - å¹´è´¹ç”¨é‡ï¼ˆ$0èµ·ï¼‰: price_1ScS7iJmiQ31C0GTv3ScXonr"

### **âœ… å·²æ­£ç¡®é…ç½®ï¼š**

**Firebase Function é…ç½®ï¼ˆfirebase-functions/index.jsï¼‰ï¼š**
```javascript
const priceMapping = {
    monthly: {
        basePriceId: 'price_1ScS9QJmiQ31C0GTy4y6z0l0',  // âœ“ æœˆè²»åŸºç¤ $58
        usagePriceId: 'price_1ScSATJmiQ31C0GTW1qWu0OF'  // âœ“ æœˆè²»ç”¨é‡ $0èµ·
    },
    yearly: {
        basePriceId: 'price_1ScS8EJmiQ31C0GT599VDffL',  // âœ“ å¹´è²»åŸºç¤ $552
        usagePriceId: 'price_1ScS7iJmiQ31C0GTv3ScXonr'  // âœ“ å¹´è²»ç”¨é‡ $0èµ·
    }
};
```

**Stripe Checkout Session åˆ›å»ºï¼š**
```javascript
const session = await stripe.checkout.sessions.create({
    mode: 'subscription',
    line_items: [
        {
            price: selectedPlan.basePriceId,  // â† åŸºç¡€è®¢é˜…è´¹ï¼ˆ$58 æˆ– $552ï¼‰
            quantity: 1
        },
        {
            price: selectedPlan.usagePriceId,  // â† ç”¨é‡è®¡è´¹ï¼ˆ$0èµ·ï¼Œè¶…å‡ºå$0.5/é¡µï¼‰
            quantity: 1
        }
    ],
    customer_email: email,  // â† è‡ªåŠ¨å¡«å……email
    client_reference_id: userId,  // â† ä¼ é€’userId
    //...
});
```

---

## ğŸ“Š **ä¿®å¤æ‘˜è¦**

| é—®é¢˜ | åŸå›  | ä¿®å¤æ–¹æ¡ˆ | çŠ¶æ€ |
|------|------|----------|------|
| **é—®é¢˜1** | `event` å‚æ•°æœªä¼ é€’ | æ·»åŠ  `event` å‚æ•°å¹¶å®‰å…¨è®¿é—® | âœ… å·²ä¿®å¤ |
| **é—®é¢˜2** | Price ID é…ç½®ç¡®è®¤ | ç¡®è®¤é…ç½®æ­£ç¡®ï¼Œæ— éœ€ä¿®æ”¹ | âœ… å·²ç¡®è®¤ |

---

## ğŸŠ **ä¿®æ”¹çš„æ–‡ä»¶ï¼ˆ4ä¸ªï¼‰**

1. âœ… `billing.html`ï¼ˆä¸­æ–‡ï¼‰
2. âœ… `en/billing.html`ï¼ˆè‹±æ–‡ï¼‰
3. âœ… `jp/billing.html`ï¼ˆæ—¥æ–‡ï¼‰
4. âœ… `kr/billing.html`ï¼ˆéŸ©æ–‡ï¼‰

**æ‰€æœ‰æ–‡ä»¶å·²éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼**

---

## ğŸ§ª **æµ‹è¯•æ­¥éª¤**

### **1. æµ‹è¯•æœˆè´¹è®¢é˜…ï¼š**

1. è®¿é—®ï¼šhttps://vaultcaddy.com/billing.html
2. ç¡®è®¤å·²ç™»å½•
3. ç‚¹å‡» **Monthly** çš„ **"é–‹å§‹ä½¿ç”¨"** æŒ‰é’®
4. åº”è¯¥çœ‹åˆ°ï¼š
   - âœ… æŒ‰é’®æ–‡å­—å˜ä¸º"æ­£åœ¨è·³è½‰åˆ°æ”¯ä»˜é é¢..."
   - âœ… æŒ‰é’®å˜ç°è‰²ï¼ˆä¸å¯ç‚¹å‡»ï¼‰
   - âœ… 1-2ç§’åè·³è½¬åˆ° Stripe Checkout
   - âœ… Stripe é¡µé¢æ˜¾ç¤ºï¼š
     ```
     è®¢é˜… VaultCaddy æœˆè´¹ åŠå¦å¤– 1 ä¸ª
     HK$58.00 æ¯æœˆ
     Email: vaultcaddy@gmail.comï¼ˆå·²é”å®šï¼‰
     ```

### **2. æµ‹è¯•å¹´è´¹è®¢é˜…ï¼š**

1. ç‚¹å‡» **Yearly** çš„ **"é–‹å§‹ä½¿ç”¨"** æŒ‰é’®
2. åº”è¯¥çœ‹åˆ°ï¼š
   - âœ… è·³è½¬åˆ° Stripe Checkout
   - âœ… Stripe é¡µé¢æ˜¾ç¤ºï¼š
     ```
     è®¢é˜… VaultCaddy å¹´è´¹ åŠå¦å¤– 1 ä¸ª
     HK$552.00 æ¯å¹´ï¼ˆç›¸å½“äº HK$46.00/æœˆï¼‰
     Email: vaultcaddy@gmail.comï¼ˆå·²é”å®šï¼‰
     ```

### **3. æ£€æŸ¥ Stripe Dashboardï¼š**

è®¿é—®ï¼šhttps://dashboard.stripe.com/test/subscriptions

å®Œæˆæµ‹è¯•æ”¯ä»˜åï¼Œåº”è¯¥çœ‹åˆ°ï¼š
- âœ… è®¢é˜…åŒ…å« **2 ä¸ªäº§å“**ï¼š
  1. **åŸºç¡€è®¢é˜…è´¹**ï¼ˆ$58/æœˆ æˆ– $552/å¹´ï¼‰
  2. **ç”¨é‡è®¡è´¹**ï¼ˆ$0èµ·ï¼Œè¶…å‡ºå$0.5/é¡µï¼‰

---

## ğŸ¯ **å®Œæ•´åŠŸèƒ½æµç¨‹**

### **ç”¨æˆ·ä½“éªŒæµç¨‹ï¼š**

```
1. ç”¨æˆ·è®¿é—® billing.html
   â†“
2. ç™»å½•è´¦æˆ·ï¼ˆvaultcaddy@gmail.comï¼‰
   â†“
3. ç‚¹å‡»"é–‹å§‹ä½¿ç”¨"ï¼ˆMonthly æˆ– Yearlyï¼‰
   â†“
4. JavaScript è‡ªåŠ¨è·å–ï¼š
   - email: vaultcaddy@gmail.com
   - userId: abc123xyz
   - planType: 'monthly' æˆ– 'yearly'
   â†“
5. è°ƒç”¨ Firebase Function: createStripeCheckoutSession
   â†“
6. Firebase Function åˆ›å»º Stripe Checkout Sessionï¼š
   - æœˆè´¹ï¼šprice_1ScS9QJmiQ31C0GTy4y6z0l0 + price_1ScSATJmiQ31C0GTW1qWu0OF
   - å¹´è´¹ï¼šprice_1ScS8EJmiQ31C0GT599VDffL + price_1ScS7iJmiQ31C0GTv3ScXonr
   â†“
7. è·³è½¬åˆ° Stripe Checkout
   - Email å·²è‡ªåŠ¨å¡«å……å¹¶é”å®š
   - æ˜¾ç¤º 2 ä¸ªäº§å“ï¼ˆåŸºç¡€è´¹ + ç”¨é‡è´¹ï¼‰
   â†“
8. ç”¨æˆ·è¾“å…¥æ”¯ä»˜ä¿¡æ¯å¹¶å®Œæˆæ”¯ä»˜
   â†“
9. Stripe Webhook è§¦å‘
   â†“
10. Firebase Function å¤„ç† Webhookï¼š
    - é€šè¿‡ email å’Œ userId åŒ¹é…ç”¨æˆ·
    - æ·»åŠ  Creditsï¼šæœˆè´¹ 100ï¼Œå¹´è´¹ 1200
    - æ›´æ–°è®¢é˜…çŠ¶æ€
   â†“
11. ç”¨æˆ·è¿”å› billing.html
    - å³ä¸Šè§’ Credits å·²å¢åŠ 
    - å¯ä»¥å¼€å§‹ä½¿ç”¨æœåŠ¡
```

---

## âœ… **éƒ¨ç½²çŠ¶æ€**

```
âœ” hosting: file upload complete (5736 files)
âœ” hosting: release complete

âœ” Deploy complete!
```

**æ‰€æœ‰æ›´æ”¹å·²æˆåŠŸéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒï¼** ğŸš€

---

## ğŸ‰ **æ­å–œï¼æ‰€æœ‰é—®é¢˜å·²è§£å†³**

### **å·²å®Œæˆï¼š**
- âœ… ä¿®å¤"Get Started"æŒ‰é’®å¡ä½é—®é¢˜
- âœ… ç¡®è®¤ Price ID é…ç½®æ­£ç¡®
- âœ… 4 ä¸ªè¯­è¨€ç‰ˆæœ¬å…¨éƒ¨æ›´æ–°
- âœ… æ‰€æœ‰ä»£ç å·²éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
- âœ… æ—  Linter é”™è¯¯

### **ç°åœ¨å¯ä»¥ï¼š**
1. âœ… **ç«‹å³æµ‹è¯•æ–°åŠŸèƒ½**ï¼ˆhttps://vaultcaddy.com/billing.htmlï¼‰
2. âœ… **å®Œæˆé¦–ç¬”æµ‹è¯•æ”¯ä»˜**
3. âœ… **å‘çœŸå®ç”¨æˆ·å¼€æ”¾**

---

## ğŸš€ **ä¸‹ä¸€æ­¥å»ºè®®**

### **1. æµ‹è¯•å®Œæ•´æ”¯ä»˜æµç¨‹ï¼ˆ5åˆ†é’Ÿï¼‰**
- ä½¿ç”¨æµ‹è¯•å¡ï¼š`4242 4242 4242 4242`
- å®Œæˆæœˆè´¹æˆ–å¹´è´¹è®¢é˜…
- æ£€æŸ¥ Credits æ˜¯å¦æ­£ç¡®å¢åŠ 

### **2. æŸ¥çœ‹ Firebase Functions æ—¥å¿—**
```bash
firebase functions:log --only createStripeCheckoutSession
```

åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… å‰µå»º Checkout Session: monthly
âœ… Checkout Session å‰µå»ºæˆåŠŸ: cs_xxxxx
```

### **3. æ£€æŸ¥ Stripe Webhook æ—¥å¿—**
è®¿é—®ï¼šhttps://dashboard.stripe.com/test/webhooks

åº”è¯¥çœ‹åˆ°ï¼š
```
âœ… checkout.session.completed
âœ… customer.subscription.created
```

---

## ğŸŠ **å®Œç¾ï¼ä¸€åˆ‡å°±ç»ª**

**âœ¨ ç°åœ¨ç”¨æˆ·å¯ä»¥é¡ºåˆ©å®Œæˆè®¢é˜…å¹¶è‡ªåŠ¨è·å¾— Credits äº†ï¼** ğŸ‰ğŸ‰ğŸ‰

è¯¦ç»†æ–‡æ¡£å·²ä¿å­˜åˆ° `âœ…_ä¸¤ä¸ªé—®é¢˜å·²ä¿®å¤.txt`

