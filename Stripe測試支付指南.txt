# 🧪 Stripe 測試支付完整指南

## 📋 測試鏈接
**您的 Stripe 支付鏈接：**
```
https://buy.stripe.com/dRm6oI3nmeBs3L00RYf7i07
```

---

## 💳 Stripe 測試卡號

### ✅ 成功支付測試卡

**1. 基本成功測試**
```
卡號：4242 4242 4242 4242
到期日：任何未來日期（例如：12/25）
CVC：任何3位數字（例如：123）
郵編：任何5位數字（例如：12345）
```

**2. 3D安全驗證成功**
```
卡號：4000 0027 6000 3184
到期日：任何未來日期
CVC：任何3位數字
結果：會彈出3D驗證窗口，點擊"Complete"完成支付
```

---

### ❌ 失敗測試卡

**1. 卡片被拒絕（通用）**
```
卡號：4000 0000 0000 0002
結果：Your card was declined
```

**2. 餘額不足**
```
卡號：4000 0000 0000 9995
結果：Your card has insufficient funds
```

**3. 卡片過期**
```
卡號：4000 0000 0000 0069
結果：Your card has expired
```

**4. CVC錯誤**
```
卡號：4000 0000 0000 0127
結果：Your card's security code is incorrect
```

---

## 🧪 測試步驟

### 步驟1：打開支付鏈接
```
1. 點擊鏈接：https://buy.stripe.com/dRm6oI3nmeBs3L00RYf7i07
2. 應該看到 Stripe 的支付頁面
3. 頁面標題應該是您設置的產品名稱（例如："年付訂閱"）
```

---

### 步驟2：填寫測試信息

**電子郵件：**
```
任何有效的電子郵件格式
建議：test@example.com 或您的真實郵箱（測試模式不會收費）
```

**卡片信息：**
```
使用上面的測試卡號之一
例如：4242 4242 4242 4242
```

**姓名：**
```
任何姓名
例如：Test User
```

**地址（如果需要）：**
```
國家：Hong Kong
郵編：00000 或任何5位數字
```

---

### 步驟3：提交支付

**點擊支付按鈕後：**
1. ✅ **成功情況**：
   - 會跳轉到成功頁面（如果您設置了成功URL）
   - 或顯示"Payment successful"消息
   - Stripe Dashboard會記錄這筆測試交易

2. ❌ **失敗情況**：
   - 會顯示錯誤消息（根據使用的測試卡）
   - 不會創建訂閱
   - 不會扣款

---

### 步驟4：在 Stripe Dashboard 查看結果

**登錄 Stripe：**
```
1. 訪問：https://dashboard.stripe.com/
2. 確保處於"測試模式"（右上角有"TEST MODE"標識）
3. 點擊左側"支付"或"Payments"
4. 應該能看到您剛才的測試支付記錄
```

**檢查內容：**
- ✅ 支付金額正確（HKD $62 或 $78）
- ✅ 客戶郵箱正確
- ✅ 支付狀態（成功/失敗）
- ✅ 訂閱信息（如果是訂閱產品）

---

## 🎯 常見測試場景

### 場景1：測試成功支付流程
```
目的：確認支付流程正常
卡號：4242 4242 4242 4242
預期：支付成功，創建訂閱
```

### 場景2：測試3D驗證
```
目的：確認3D安全驗證功能
卡號：4000 0027 6000 3184
預期：彈出驗證窗口，點擊Complete後成功
```

### 場景3：測試失敗處理
```
目的：確認錯誤消息顯示正確
卡號：4000 0000 0000 0002
預期：顯示"卡片被拒絕"錯誤
```

### 場景4：測試webhook（如果配置了）
```
目的：確認webhook通知正常
卡號：4242 4242 4242 4242
檢查：Stripe Dashboard → Developers → Webhooks
預期：看到 payment_intent.succeeded 事件
```

---

## 📊 Stripe Dashboard 重要功能

### 1. 支付記錄（Payments）
```
位置：左側菜單 → Payments
查看：所有測試支付記錄
操作：點擊單筆支付查看詳情
```

### 2. 訂閱管理（Subscriptions）
```
位置：左側菜單 → Subscriptions
查看：所有測試訂閱
操作：取消、修改訂閱
```

### 3. 客戶管理（Customers）
```
位置：左側菜單 → Customers
查看：測試客戶列表
操作：查看客戶訂閱歷史
```

### 4. 日誌（Logs）
```
位置：Developers → Logs
查看：所有API請求和webhook事件
用途：調試問題
```

---

## ⚠️ 重要提醒

### 測試模式 vs 生產模式

**測試模式（Test Mode）：**
- ✅ 不會產生真實扣款
- ✅ 只能使用測試卡號
- ✅ 所有數據都是測試數據
- ✅ 右上角有"TEST MODE"標識

**生產模式（Live Mode）：**
- ❌ 會產生真實扣款
- ❌ 需要使用真實卡號
- ❌ 所有數據都是真實數據
- ⚠️ **請確保在上線前充分測試！**

---

### 測試數據清理

**測試完成後：**
```
1. 測試數據會自動保留在測試模式中
2. 不會影響生產環境
3. 可以在Dashboard中手動刪除測試數據（可選）
4. 切換到生產模式時，測試數據不會顯示
```

---

## 🔧 常見問題

### Q1：支付頁面打不開？
```
A：檢查鏈接是否正確，確保以 https://buy.stripe.com/ 開頭
```

### Q2：測試卡號被拒絕？
```
A：確保在Stripe測試模式下，使用正確的測試卡號格式
```

### Q3：看不到支付記錄？
```
A：確認Stripe Dashboard處於測試模式（右上角"TEST MODE"）
```

### Q4：如何取消測試訂閱？
```
A：Dashboard → Subscriptions → 選擇訂閱 → Cancel subscription
```

### Q5：測試支付會收到郵件嗎？
```
A：測試模式下不會發送真實郵件，但可以在Dashboard → Emails查看預覽
```

---

## 📱 手機測試

**使用手機測試：**
1. 在手機瀏覽器打開支付鏈接
2. 使用相同的測試卡號
3. 確認手機版界面顯示正常
4. 測試支付流程是否順暢

---

## ✅ 測試檢查清單

在上線前，請確保測試以下項目：

- [ ] 成功支付流程
- [ ] 3D驗證流程
- [ ] 失敗支付處理
- [ ] 桌面版界面
- [ ] 手機版界面
- [ ] 支付金額正確
- [ ] 訂閱創建成功
- [ ] 客戶信息保存
- [ ] 郵件通知（如果配置）
- [ ] Webhook事件（如果配置）

---

## 🚀 上線前準備

**完成測試後，上線前需要：**

1. **切換到生產模式**
   - Stripe Dashboard右上角切換到"Live Mode"
   - 確認所有配置正確

2. **更新支付鏈接**
   - 將測試鏈接替換為生產鏈接
   - 確認VaultCaddy網站使用生產鏈接

3. **配置webhook（如果需要）**
   - 設置生產環境的webhook URL
   - 測試webhook是否正常接收

4. **測試一筆真實小額支付**
   - 使用真實卡號測試一次
   - 確認整個流程正常
   - 完成後可以退款

---

## 📞 需要幫助？

**Stripe 支援：**
- 文檔：https://stripe.com/docs
- 支持：https://support.stripe.com/

**VaultCaddy 整合問題：**
- 檢查Firebase Functions日誌
- 檢查webhook配置
- 查看Stripe Dashboard日誌

---

🎉 **祝測試順利！有任何問題隨時問我！**
