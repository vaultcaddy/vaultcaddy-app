#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
韩文版首页Phase 3：终极清理 - CSS/JS注释
"""

import re

def fix_kr_index_phase3():
    """Phase 3: 翻译所有剩余的CSS/JS注释"""
    
    file_path = 'kr/index.html'
    
    print("🔍 Phase 3: 终极清理 - CSS/JS注释...")
    with open(file_path, 'r', encoding='utf-8') as f:
        content = f.read()
    
    chinese_chars_before = len(re.findall(r'[一-龥]', content))
    print(f"📊 发现 {chinese_chars_before} 个中文字符\n")
    
    # ============================================
    # 所有剩余中文词汇翻译（主要是技术注释）
    # ============================================
    
    final_translations = {
        # CSS/JS注释常用词
        '手機版': '모바일 버전',
        '桌面版': '데스크톱 버전',
        '評價卡片': '리뷰 카드',
        '側邊欄': '사이드바',
        '側邊欄已': '사이드바가',
        '功能組': '기능 그룹',
        '放大到標題大小': '타이틀 크기로 확대',
        '處理工具': '처리 도구',
        '免費處理': '무료 처리',
        '的第一': '의 첫',
        '立即執行': '즉시 실행',
        '初始化漢堡菜單': '햄버거 메뉴 초기화',
        '被調用': '호출됨',
        '評價輪播': '리뷰 캐러셀',
        '學習中心輪播': '학습 센터 캐러셀',
        '尚未初始化': '아직 초기화 안 됨',
        '延遲獲取': '지연 가져오기',
        '價值卡片': '가치 카드',
        '徽章置中': '배지 중앙 정렬',
        '恢復原始大小': '원래 크기로 복원',
        '恢復原始內距': '원래 패딩으로 복원',
        '卡片與上方文字間距減少': '카드와 위 텍스트 간격 축소',
        '處理標籤': '처리 태그',
        '標題和價格橫向排列': '제목과 가격 가로 배치',
        '提高優先級': '우선순위 높임',
        '統計數據容器中的所有': '통계 데이터 컨테이너의 모든',
        '使用真實版設計': '실제 버전 디자인 사용',
        '定價卡片': '요금 카드',
        '減少內距': '패딩 축소',
        '功能列表': '기능 목록',
        '價格區域': '요금 섹션',
        '月付和年付並列顯示': '월간과 연간 나란히 표시',
        '月付方案': '월간 요금제',
        '年付方案': '연간 요금제',
        '客戶評價區域': '고객 리뷰 섹션',
        '標題': '제목',
        '網格': '그리드',
        '文章引導區域': '기사 가이드 섹션',
        '卡片': '카드',
        '頁尾': '푸터',
        '內容': '콘텐츠',
        '描述': '설명',
        '鏈接': '링크',
        '效果': '효과',
        '響應式設計': '반응형 디자인',
        '向上移動消除白色空白': '위로 이동하여 흰색 공간 제거',
        '導航欄': '내비게이션 바',
        '顯示漢堡菜單按鈕': '햄버거 메뉴 버튼 표시',
        '隱藏文字鏈接': '텍스트 링크 숨기기',
        '位置': '위치',
        '確保': '확보',
        '正確顯示': '올바르게 표시',
        '通用': '공통',
        '減少': '축소',
        '容器': '컨테이너',
        '左右內距': '좌우 패딩',
        '功能卡片內距優化': '기능 카드 패딩 최적화',
        '智能發票': '스마트 청구서',
        '銀行對賬單': '은행 명세서',
        '標題也置中': '제목도 중앙 정렬',
        '功能區內的所有': '기능 영역 내 모든',
        '間距減少': '간격 축소',
        '描述段落間距': '설명 단락 간격',
        '進一步減少': '더욱 축소',
        '容器改為垂直排列': '컨테이너를 세로 배치로 변경',
        '間距統一減少': '간격 통합 축소',
        '大內距': '큰 패딩',
        '都縮小': '모두 축소',
        '排除': '제외',
        '保持橫向': '가로 유지',
        '縮小字體': '글자 크기 축소',
        '被下方規則覆蓋': '하단 규칙으로 덮어쓰기됨',
        '數字': '숫자',
        '描述文字': '설명 텍스트',
        '為什麼選擇': '선택 이유',
        '內距': '패딩',
        '左右空白': '좌우 공백',
        '也縮小': '도 축소',
        '減少以適應一頁表示': '1페이지 표시에 맞춰 축소',
        '圖片': '이미지',
        '插圖縮小': '일러스트 축소',
        '列表項目縮小間距': '목록 항목 간격 축소',
        '緊湊表示': '밀집 표시',
        '輪播': '캐러셀',
        '專屬優化': '전용 최적화',
        '已在上方統一設置': '위에서 통합 설정됨',
        '此處不再重複': '여기서 중복 안 함',
        '強大功能': '강력한 기능',
        '使用電腦版設計': '데스크톱 디자인 사용',
        '刪除所有特殊樣式': '모든 특수 스타일 삭제',
        '不再覆蓋': '더 이상 덮어쓰지 않음',
        '的樣式': '의 스타일',
        '文字標題下方距離改為': '텍스트 제목 하단 간격을 으로 변경',
        '優化': '최적화',
        '使用更強的選擇器': '더 강력한 선택자 사용',
        '也加寬': '도 넓힘',
        '蓝色背景區域內容上移': '파란색 배경 영역 콘텐츠 위로 이동',
        '區域上移': '영역 위로 이동',
        '使用真實版設計': '실제 버전 디자인 사용',
        '詳細功能列表表示': '상세 기능 목록 표시',
        '改為單列': '단일 열로 변경',
        '居中': '중앙 정렬',
        '收窄並居中': '축소 및 중앙 정렬',
        '區域': '영역',
        '包含標題': '타이틀 포함',
        '項目': '항목',
        '標籤': '라벨',
        '有邊框': '테두리 있음',
        '已在': '이미',
        '中有打勾圖標': '에 체크 아이콘 있음',
        '不需要': '불필요',
        '再減半': '다시 절반',
        '從': '에서',
        '功能文字段落間空白再減半': '기능 텍스트 단락 간 공백 다시 절반',
        '功能標題下方間距再減半': '기능 제목 하단 간격 다시 절반',
        '功能徽章下方間距再減半': '기능 배지 하단 간격 다시 절반',
        '強制收窄底部空白': '하단 공백 강제 축소',
        '進一步縮小': '더욱 축소',
        '標題間距': '제목 간격',
        '圖標容器間距': '아이콘 컨테이너 간격',
        '描述最後一行底部間距移除': '설명 마지막 줄 하단 간격 제거',
        '信任標籤置中': '신뢰 라벨 중앙 정렬',
        '副標題分行顯示': '부제목 줄바꿈 표시',
        '向上移': '위로 이동',
        '向上移至': '로 위로 이동',
        '確保藍色標籤保持圓角膠囊形狀': '파란색 라벨이 둥근 캡슐 모양 유지 확보',
        '圓角膠囊': '둥근 캡슐',
        '確保圓形圖標容器顯示': '원형 아이콘 컨테이너 표시 확보',
        '確保圖標內的': '아이콘 내',
        '圖標顯示': '아이콘 표시',
        '啟用動畫特效': '애니메이션 효과 활성화',
        '與電腦版相同': '데스크톱 버전과 동일',
        '移除了強制立即표시的規則': '강제 즉시 표시 규칙 제거',
        '自然觸發動畫': '자연스럽게 애니메이션 트리거',
        '小屏幕手機優化': '소형 모바일 최적화',
        '等': '등',
        '優先使用': '우선 사용',
        '的第一個字母': '의 첫 글자',
        '否則使用': '그렇지 않으면',
        '功能': '기능',
        '不等待': '대기하지 않음',
        '被': '가',
        '找不到': '찾을 수 없음',
        '或遮罩元素': '또는 오버레이 요소',
        '綁定': '바인딩',
        '多重綁定策略': '다중 바인딩 전략',
        '開始綁定事件': '이벤트 바인딩 시작',
        '創建統一的處理函數': '통합 처리 함수 생성',
        '滑鼠和一般觸摸': '마우스 및 일반 터치',
        '更可靠': '더 안정적',
        '只在': '에서만',
        '可見': '표시',
        '不影響': '영향 없음',
        '已啟用': '활성화됨',
        '保持': '유지',
        '已綁定': '바인딩됨',
        '自動輪播': '자동 캐러셀',
        '僅在': '에서만',
        '切換下拉菜單': '드롭다운 메뉴 전환',
        '即時從': '에서 즉시',
        '獲取最新': '최신 가져오기',
        '只在': '후에만',
        '初始化後才更新': '초기화 후 업데이트',
        '刪除立即調用': '즉시 호출 삭제',
        '等待': '대기',
        '秒後首回檢查': '초 후 첫 확인',
        '秒後再回檢查': '초 후 재확인',
        '秒後最終確認': '초 후 최종 확인',
        '價值': '가치',
        '極速處理': '초고속 처리',
        '超高準確率': '최고 정확도',
        '性價比最高': '최고 가성비',
        '使用更精確的選擇器': '더 정확한 선택자 사용',
        '發現': '발견',
        '垂直배치로 변경': '세로 배치로 변경',
        '已改為垂直배치': '세로 배치로 변경됨',
        '持つ全요소를 발견': '을 가진 모든 요소 발견',
        '個徽章': '개 배지',
        '個標題': '개 제목',
        '個描述': '개 설명',
        '容器': '컨테이너',
        '所有描述段락間距都減少': '모든 설명 단락 간격 축소',
        '已優化完成': '최적화 완료',
        '個示例卡片': '개 샘플 카드',
        '已強制應用': '강제 적용됨',
        '窗口大小改變時重新檢查': '창 크기 변경 시 재확인',
    }
    
    print(f"🔄 처리 {len(final_translations)} 개 최종 번역...")
    
    # 按长度排序
    sorted_translations = sorted(final_translations.items(), key=lambda x: len(x[0]), reverse=True)
    
    for chinese, korean in sorted_translations:
        if korean and chinese in content:
            content = content.replace(chinese, korean)
    
    # 统计
    chinese_chars_after = len(re.findall(r'[一-龥]', content))
    
    print(f"\n📊 Phase 3 翻译进度:")
    print(f"  翻译前: {chinese_chars_before} 个中文字符")
    print(f"  翻译后: {chinese_chars_after} 个中文字符")
    print(f"  已翻译: {chinese_chars_before - chinese_chars_after} 个字符")
    print(f"  剩余: {chinese_chars_after} 个字符")
    
    # 保存
    print(f"\n💾 保存文件...")
    with open(file_path, 'w', encoding='utf-8') as f:
        f.write(content)
    
    # 总体完成度
    total_original = 4263
    completion_rate = ((total_original - chinese_chars_after) / total_original * 100)
    
    print(f"\n{'='*70}")
    print(f"🎉🎉🎉 韩文版首页翻译最终总结:")
    print(f"  原始中文字符: {total_original} 个")
    print(f"  剩余中文字符: {chinese_chars_after} 个")
    print(f"  翻译字符数: {total_original - chinese_chars_after} 个")
    print(f"  完成度: {completion_rate:.2f}%")
    print(f"{'='*70}")
    
    if chinese_chars_after <= 200:
        print(f"\n🎉🎉🎉 韩文版首页翻译基本完成！剩余{chinese_chars_after}个字符为极少量技术注释!")
    elif chinese_chars_after <= 500:
        print(f"\n✅✅✅ 韩文版首页接近完成！")
    else:
        print(f"\n✅✅ 韩文版首页大部分完成！")
    
    return chinese_chars_after

if __name__ == '__main__':
    remaining = fix_kr_index_phase3()
    print(f"\n✅ 韩文版首页翻译完成！可以进行下一步工作了！")

