# ğŸš€ æœ€çµ‚éƒ¨ç½²æŒ‡å—

## ğŸ“‹ ç•¶å‰ç‹€æ…‹

### âœ… å·²å®Œæˆ
1. **Firebase åŸºç¤é…ç½®** - firebase.json, firestore.rules
2. **Firestore å®‰å…¨è¦å‰‡** - å·²éƒ¨ç½²ï¼ŒDashboard å¯ç”¨
3. **Email é…ç½®** - vaultcaddy@gmail.com å·²è¨­ç½®
4. **Cloud Functions ä»£ç¢¼** - 10 å€‹ Functions å·²æº–å‚™å°±ç·’
5. **æ•¸æ“šæ¸…ç†é‚è¼¯** - è‡ªå‹•æ¸…ç†éæœŸæ•¸æ“šï¼ˆ60/90/365å¤©ï¼‰

### âš ï¸ å¾…å®Œæˆ
1. **Cloud Functions éƒ¨ç½²** - éœ€è¦å›ç­” Container ä¿ç•™å¤©æ•¸å•é¡Œ

---

## ğŸ¯ ç«‹å³æ“ä½œï¼ˆ2 æ­¥é©Ÿï¼Œ5 åˆ†é˜ï¼‰

### æ­¥é©Ÿ 1ï¼šå›ç­” Container ä¿ç•™å¤©æ•¸

**å•é¡Œï¼ˆåœ–2ï¼‰ï¼š**
```
How many days do you want to keep container images before they are deleted?
```

**æ¨è–¦ç­”æ¡ˆï¼š**
```
30
```

**ç‚ºä»€éº¼é¸ 30 å¤©ï¼Ÿ**
- âœ… è¶³å¤ çš„å›æ»¾æ™‚é–“ï¼ˆ1å€‹æœˆï¼‰
- âœ… æ§åˆ¶å­˜å„²æˆæœ¬ï¼ˆ< $1/æœˆï¼‰
- âœ… é©åˆåˆæœŸé‹ç‡Ÿ
- âœ… éš¨æ™‚å¯ä»¥èª¿æ•´

**é‡è¦èªªæ˜ï¼š**
- Container Images â‰  ç”¨æˆ¶æ•¸æ“š
- é€™åªå½±éŸ¿ Cloud Functions ç‰ˆæœ¬å›æ»¾èƒ½åŠ›
- ä¸å½±éŸ¿ç”¨æˆ¶æ•¸æ“šä¿ç•™ï¼ˆ60/90/365å¤©ï¼‰

---

### æ­¥é©Ÿ 2ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆ

**é è¨ˆæ™‚é–“ï¼š** 2-3 åˆ†é˜

**å°‡éƒ¨ç½²çš„ 10 å€‹ Functionsï¼š**

| Function | åŠŸèƒ½ | é‡è¦æ€§ |
|----------|------|--------|
| `stripeWebhook` | Stripe ä»˜æ¬¾webhook | â­â­â­ |
| `monthlyCreditsReset` | æ¯æœˆ Credits é‡ç½® | â­â­â­ |
| `checkExpiredSubscriptions` | æª¢æŸ¥éæœŸè¨‚é–± | â­â­â­ |
| `addCreditsManual` | æ‰‹å‹•æ·»åŠ  Credits | â­â­ |
| `getCreditsHistory` | ç²å– Credits æ­·å² | â­â­ |
| **`sendVerificationCode`** | **ç™¼é€é©—è­‰ç¢¼** | **â­â­â­â­â­** |
| **`verifyCode`** | **é©—è­‰ç¢¼é©—è­‰** | **â­â­â­â­â­** |
| `checkEmailVerified` | æª¢æŸ¥é©—è­‰ç‹€æ…‹ | â­â­â­ |
| **`cleanupExpiredData`** | **è‡ªå‹•æ¸…ç†éæœŸæ•¸æ“š** | **â­â­â­â­** |
| `triggerCleanup` | æ‰‹å‹•è§¸ç™¼æ¸…ç† | â­â­ |

---

## ğŸ§¹ æ•¸æ“šæ¸…ç†ç­–ç•¥ï¼ˆå·²å¯¦ç¾ï¼‰

### è‡ªå‹•æ¸…ç†é‚è¼¯

**åŸ·è¡Œæ™‚é–“ï¼š** æ¯å¤©å‡Œæ™¨ 2 é»ï¼ˆé¦™æ¸¯æ™‚é–“ï¼‰

**ä¿ç•™æœŸé™ï¼š**
| è¨ˆåŠƒ | æ•¸æ“šä¿ç•™ | å°æ‡‰åœ–3 |
|------|---------|---------|
| å…è²»ç‰ˆ | 30 å¤© | - |
| åŸºç¤ç‰ˆ | **60 å¤©** | âœ… |
| å°ˆæ¥­ç‰ˆ | **90 å¤©** | âœ… |
| å•†æ¥­ç‰ˆ | **365 å¤©** | âœ… |

**æ¸…ç†ç¯„åœï¼š**
- âœ… éæœŸé …ç›®ï¼ˆProjectsï¼‰
- âœ… é …ç›®ä¸‹çš„æ‰€æœ‰æ–‡æª”ï¼ˆDocumentsï¼‰
- âœ… è‡ªå‹•è¨˜éŒ„æ—¥èªŒ

**å®‰å…¨æ©Ÿåˆ¶ï¼š**
- âœ… æ ¹æ“šç”¨æˆ¶è¨ˆåŠƒè‡ªå‹•åˆ¤æ–·
- âœ… åªåˆªé™¤è¶…éä¿ç•™æœŸé™çš„æ•¸æ“š
- âœ… è©³ç´°æ—¥èªŒè¨˜éŒ„æ¯æ¬¡æ¸…ç†

---

## ğŸ” éƒ¨ç½²å¾Œé©—è­‰

### 1. æª¢æŸ¥ Functions åˆ—è¡¨

```bash
firebase functions:list
```

**é æœŸè¼¸å‡ºï¼š** æ‡‰è©²çœ‹åˆ° 10 å€‹ Functions

### 2. æ¸¬è©¦ Email é©—è­‰

**æ­¥é©Ÿï¼š**
1. å‰å¾€ï¼šhttps://vaultcaddy.com/auth.html
2. è¨»å†Šæ–°å¸³æˆ¶ï¼ˆä¾‹å¦‚ï¼štest@example.comï¼‰
3. **é æœŸï¼š** æ”¶åˆ°é©—è­‰ç¢¼éƒµä»¶ï¼ˆç™¼ä»¶äººï¼švaultcaddy@gmail.comï¼‰
4. è¼¸å…¥é©—è­‰ç¢¼
5. **é æœŸï¼š** é©—è­‰æˆåŠŸï¼Œç²å¾— 20 å€‹ Credits

### 3. æ¸¬è©¦ Dashboard

**æ­¥é©Ÿï¼š**
1. å‰å¾€ï¼šhttps://vaultcaddy.com/dashboard.html
2. å‰µå»ºæ–°é …ç›®
3. **é æœŸï¼š** é …ç›®å‰µå»ºæˆåŠŸï¼Œä¸å†å‡ºç¾ "permission-denied" éŒ¯èª¤

### 4. æª¢æŸ¥æ•¸æ“šæ¸…ç†ï¼ˆå¯é¸ï¼‰

**æŸ¥çœ‹å®šæ™‚ä»»å‹™ï¼š**
```bash
firebase functions:log --only cleanupExpiredData
```

**æ‰‹å‹•è§¸ç™¼æ¸…ç†ï¼ˆç®¡ç†å“¡ï¼‰ï¼š**
- ç™»å…¥ vaultcaddy@gmail.com æˆ– osclin2002@gmail.com
- åœ¨ Console èª¿ç”¨ `triggerCleanup()` Function

---

## ğŸ› å•é¡Œ 1 è§£æ±ºæ–¹æ¡ˆï¼šFirebase åŠ è¼‰å¤±æ•—ï¼ˆåœ–1ï¼‰

### éŒ¯èª¤åŸå› 
```
FirebaseError: Missing or insufficient permissions
```

**åŸå› ï¼š** Cloud Functions å°šæœªéƒ¨ç½²ï¼Œå‰ç«¯ç„¡æ³•èª¿ç”¨

### è§£æ±ºæ–¹æ¡ˆ
âœ… å®Œæˆ Cloud Functions éƒ¨ç½²å¾Œï¼Œæ­¤éŒ¯èª¤æœƒè‡ªå‹•æ¶ˆå¤±

**é©—è­‰ï¼š**
1. éƒ¨ç½²å®Œæˆå¾Œï¼Œåˆ·æ–° https://vaultcaddy.com/dashboard.html
2. æ‰“é–‹ Consoleï¼ˆF12ï¼‰
3. **é æœŸï¼š** ä¸å†å‡ºç¾ "Missing or insufficient permissions" éŒ¯èª¤
4. **é æœŸï¼š** å¯ä»¥æˆåŠŸå‰µå»ºé …ç›®

---

## ğŸ“Š å®Œæ•´åŠŸèƒ½å°ç…§è¡¨

| åŠŸèƒ½ | å‰ç«¯ | å¾Œç«¯ | ç‹€æ…‹ |
|------|------|------|------|
| ç”¨æˆ¶è¨»å†Š | âœ… | âœ… | å®Œæˆ |
| Email é©—è­‰ | âœ… | âš ï¸ å¾…éƒ¨ç½² | 95% |
| é©—è­‰å¾Œè´ˆé€ 20 Credits | âœ… | âš ï¸ å¾…éƒ¨ç½² | 95% |
| Dashboard é …ç›®å‰µå»º | âœ… | âœ… | å®Œæˆ |
| æ–‡ä»¶ä¸Šå‚³ | âœ… | âœ… | å®Œæˆ |
| AI è™•ç† | âœ… | âœ… | å®Œæˆ |
| Credits ä½¿ç”¨ | âœ… | âœ… | å®Œæˆ |
| Credits é€€å› | âœ… | âœ… | å®Œæˆ |
| æ‹–æ”¾ä¸Šå‚³ | âœ… | - | å®Œæˆ |
| ç¹é«”ä¸­æ–‡ç•Œé¢ | âœ… | - | å®Œæˆ |
| æ•¸æ“šæ¸…ç†ï¼ˆ60/90/365å¤©ï¼‰ | - | âš ï¸ å¾…éƒ¨ç½² | 100% |
| Stripe ä»˜æ¬¾ | âœ… | âš ï¸ å¾…éƒ¨ç½² | 90% |

---

## ğŸ’° è²»ç”¨é ä¼°

### Firebase å…è²»é¡åº¦ï¼ˆSpark Planï¼‰
- âœ… Firestoreï¼š50K è®€å–/å¤©
- âœ… Cloud Functionsï¼š2M èª¿ç”¨/æœˆ
- âœ… Storageï¼š5 GB
- âœ… Hostingï¼š10 GB/æœˆ

### é ä¼°æœˆè²»ç”¨ï¼ˆåˆæœŸï¼‰
- **Cloud Functionsï¼š** < $5/æœˆ
- **Firestoreï¼š** < $3/æœˆ
- **Storageï¼š** < $2/æœˆ
- **Container Registryï¼š** < $1/æœˆ

**ç¸½è¨ˆï¼šç´„ $10-15/æœˆ**ï¼ˆå‡è¨­æ¯å¤© 100-200 å€‹æ–‡æª”è™•ç†ï¼‰

### å‡ç´šåˆ° Blaze Planï¼ˆæŒ‰ç”¨é‡ä»˜è²»ï¼‰
- åªæœ‰è¶…éå…è²»é¡åº¦æ‰æ”¶è²»
- å»ºè­°åˆæœŸä½¿ç”¨ Spark Planï¼Œé”åˆ°é™åˆ¶å¾Œå†å‡ç´š

---

## ğŸš€ åŸ·è¡Œå‘½ä»¤

### å®Œæˆéƒ¨ç½²

```bash
cd /Users/cavlinyeung/ai-bank-parser
firebase deploy --only functions
```

**ç•¶è©¢å• Container ä¿ç•™å¤©æ•¸æ™‚ï¼Œè¼¸å…¥ï¼š**
```
30
```

---

## âœ… éƒ¨ç½²å®Œæˆå¾Œçš„æª¢æŸ¥æ¸…å–®

- [ ] `firebase functions:list` é¡¯ç¤º 10 å€‹ Functions
- [ ] è¨»å†Šæ–°å¸³æˆ¶æ”¶åˆ°é©—è­‰ç¢¼éƒµä»¶
- [ ] é©—è­‰æˆåŠŸå¾Œç²å¾— 20 Credits
- [ ] Dashboard å¯ä»¥å‰µå»ºé …ç›®ï¼ˆä¸å†å‡ºç¾æ¬Šé™éŒ¯èª¤ï¼‰
- [ ] æ–‡ä»¶ä¸Šå‚³å’Œè™•ç†æ­£å¸¸
- [ ] Credits ä½¿ç”¨å’Œé€€å›æ­£å¸¸
- [ ] Console ä¸å†å‡ºç¾ "Missing or insufficient permissions"

---

## ğŸ“ éœ€è¦å¹«åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°å•é¡Œï¼Œè«‹æä¾›ï¼š
1. çµ‚ç«¯çš„å®Œæ•´éŒ¯èª¤è¨Šæ¯
2. Firebase Console çš„æˆªåœ–
3. ç€è¦½å™¨ Console çš„éŒ¯èª¤è¨Šæ¯

---

## ğŸ‰ ä¸‹ä¸€æ­¥å»ºè­°

### ç«‹å³ï¼ˆéƒ¨ç½²å®Œæˆå¾Œï¼‰ï¼š
1. âœ… æ¸¬è©¦ Email é©—è­‰åŠŸèƒ½
2. âœ… æ¸¬è©¦ Dashboard é …ç›®å‰µå»º
3. âœ… æ¸¬è©¦æ–‡ä»¶ä¸Šå‚³å’Œè™•ç†

### æœ¬é€±å…§ï¼š
1. é…ç½® Stripe Webhookï¼ˆç”¨æ–¼è‡ªå‹•è™•ç†ä»˜æ¬¾ï¼‰
2. æ¸¬è©¦è¨‚é–±è¨ˆåŠƒè³¼è²·æµç¨‹
3. ç›£æ§ Cloud Functions æ—¥èªŒ

### æœªä¾†å„ªåŒ–ï¼š
1. æ·»åŠ ç”¨æˆ¶å„€è¡¨æ¿ï¼ˆé¡¯ç¤ºä½¿ç”¨çµ±è¨ˆï¼‰
2. å¯¦ç¾æ‰¹æ¬¡è™•ç†é€²åº¦é¡¯ç¤º
3. æ·»åŠ æ›´å¤šå°å‡ºæ ¼å¼
4. å„ªåŒ– AI è™•ç†é€Ÿåº¦

---

**æº–å‚™å¥½äº†å—ï¼Ÿè«‹åœ¨çµ‚ç«¯è¼¸å…¥ `30` å®Œæˆéƒ¨ç½²ï¼** ğŸš€

**é è¨ˆå®Œæˆæ™‚é–“ï¼š5 åˆ†é˜** âš¡

