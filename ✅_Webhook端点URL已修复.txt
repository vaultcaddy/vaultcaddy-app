# âœ… Webhook ç«¯ç‚¹ URL å·²ä¿®å¤ï¼

## ğŸ¯ **é—®é¢˜æ ¹æº**

ç»ˆäºæ‰¾åˆ°äº†é—®é¢˜ï¼æµ‹è¯•æ¨¡å¼ Webhook `charismatic-serenity` çš„ç«¯ç‚¹ URL é…ç½®**é”™è¯¯**ï¼š

**é”™è¯¯çš„ URLï¼ˆä¹‹å‰ï¼‰ï¼š**
```
https://dashboard.stripe.com/test/webhooks
```

âŒ è¿™ä¸ª URL æŒ‡å‘äº† Stripe Dashboard è‡ªå·±ï¼Œæ‰€ä»¥ Webhook æ ¹æœ¬æ²¡æœ‰å‘é€åˆ°æ‚¨çš„ Firebase Functionsï¼

---

## âœ… **å·²ä¿®å¤**

æˆ‘å·²ç»é€šè¿‡æµè§ˆå™¨è‡ªåŠ¨å°†ç«¯ç‚¹ URL æ›´æ–°ä¸ºï¼š

**æ­£ç¡®çš„ URLï¼ˆç°åœ¨ï¼‰ï¼š**
```
https://us-central1-vaultcaddy-production-cbbe2.cloudfunctions.net/stripeWebhook
```

âœ… ç°åœ¨ Webhook ä¼šæ­£ç¡®å‘é€åˆ°æ‚¨çš„ Firebase Functions

âœ… ç­¾åéªŒè¯å·²ä¿ç•™å¹¶æ­£ç¡®é…ç½®

âœ… æµ‹è¯•æ¨¡å¼ webhook secret å·²é…ç½®ï¼š`stripe.test_webhook_secret`

---

## ğŸ§ª **è¯·ç«‹å³æµ‹è¯•**

1. **åˆ·æ–°** https://vaultcaddy.com/billing.html
2. **ç‚¹å‡»** "ğŸ§ª æ¸¬è©¦ Get Started"
3. **ä½¿ç”¨æµ‹è¯•å¡**ï¼š`4242 4242 4242 4242`
4. **å®Œæˆæ”¯ä»˜**

---

## âœ… **é¢„æœŸç»“æœ**

è¿™æ¬¡åº”è¯¥ä¼šæˆåŠŸï¼š

- âœ… **Webhook ä¼šå‘é€åˆ°æ­£ç¡®çš„ç«¯ç‚¹**
- âœ… **ç­¾åéªŒè¯ä¼šæˆåŠŸ**
- âœ… **Credits ä» 0 å¢åŠ åˆ° 1200**
- âœ… **Plan ä» "Free Plan" å˜ä¸º "Pro Plan"**
- âœ… **Stripe Webhook æ˜¾ç¤ºæˆåŠŸ**ï¼ˆä¸å†æ˜¯ 403 ERRï¼‰

---

## ğŸ“Š **æŠ€æœ¯ç»†èŠ‚**

### **ä¸ºä»€ä¹ˆä¹‹å‰ä¸€ç›´å¤±è´¥ï¼Ÿ**

1. âŒ Webhook ç«¯ç‚¹ URL æŒ‡å‘äº†é”™è¯¯çš„åœ°å€ï¼ˆStripe Dashboardï¼‰
2. âŒ Stripe å°è¯•å‘é€ webhook åˆ° Dashboardï¼Œè¿”å› 403 Forbidden
3. âŒ Firebase Functions ä»æœªæ”¶åˆ° webhook äº‹ä»¶
4. âŒ Credits å’Œ Plan æ— æ³•æ›´æ–°

### **ç°åœ¨çš„æ­£ç¡®æµç¨‹ï¼š**

1. âœ… ç”¨æˆ·å®Œæˆæµ‹è¯•æ”¯ä»˜
2. âœ… Stripe å‘é€ webhook åˆ°ï¼š`https://us-central1-vaultcaddy-production-cbbe2.cloudfunctions.net/stripeWebhook`
3. âœ… Firebase Functions æ¥æ”¶ webhook
4. âœ… ä½¿ç”¨ `stripe.test_webhook_secret` éªŒè¯ç­¾å
5. âœ… è°ƒç”¨ `handleCheckoutCompleted` æ·»åŠ  Credits
6. âœ… è°ƒç”¨ `handleSubscriptionChange` æ›´æ–° Plan
7. âœ… ç”¨æˆ·è´¦æˆ·æˆåŠŸæ›´æ–°

---

## ğŸ‰ **æ€»ç»“**

é—®é¢˜æ˜¯ Stripe Dashboard ä¸­ Webhook ç«¯ç‚¹ URL é…ç½®é”™è¯¯ã€‚ç°åœ¨å·²ç»ä¿®å¤ï¼Œæµ‹è¯•æ”¯ä»˜åº”è¯¥ä¼šæˆåŠŸï¼

**è¯·ç«‹å³æµ‹è¯•å¹¶å‘Šè¯‰æˆ‘ç»“æœï¼** ğŸš€

