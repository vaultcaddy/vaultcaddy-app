# 🔧 快速创建 Stripe 价格脚本使用指南

**日期**: 2026-01-08  
**推荐**: 使用脚本自动创建，节省时间并确保一致性

---

## ⚡ 为什么使用脚本？

手动创建 8 个价格需要 20-30 分钟，且容易出错。  
使用脚本只需 1 分钟，且确保所有设置完全一致。

---

## 🚀 快速开始

### 步骤 1: 获取 Stripe Secret Key

1. 访问 https://dashboard.stripe.com/apikeys
2. 复制 **Secret key**（以 `sk_live_` 或 `sk_test_` 开头）
3. ⚠️ **保密**: 不要分享给任何人

### 步骤 2: 获取产品 ID

从图片中可以看到您有两个产品：
- **VaultCaddy Yearly** 
- **VaultCaddy Monthly**

但需要获取完整的 Product ID（以 `prod_` 开头）。

#### 如何获取 Product ID：

**方法 1**: 在 Stripe Dashboard 中
1. 点击产品名称
2. 在 URL 中查看 Product ID
   - 例如：`https://dashboard.stripe.com/products/prod_ABC123`
   - Product ID 就是 `prod_ABC123`

**方法 2**: 使用 Stripe CLI
```bash
stripe products list --limit 10
```

### 步骤 3: 运行脚本

```bash
cd /Users/cavlinyeung/ai-bank-parser

node view-and-update-stripe-prices.js \
  <YOUR_SECRET_KEY> \
  <YEARLY_PRODUCT_ID> \
  <MONTHLY_PRODUCT_ID>
```

**实际示例**:
```bash
node view-and-update-stripe-prices.js \
  sk_live_xxx_your_secret_key_here \
  prod_Tb2443GvCbe4Pp \
  prod_Tb24SiE4usHRDS
```

---

## 📊 脚本会做什么？

1. **查看当前价格**: 显示两个产品的所有现有价格
2. **创建新价格**: 为每个产品创建 4 种货币的价格（共 8 个）
   - HKD（港币）
   - USD（美元）
   - JPY（日元）
   - KRW（韩元）
3. **输出 Price ID**: 显示所有新创建的 Price ID

---

## 💰 将创建的价格

### VaultCaddy Yearly（年付）
| 货币 | 价格 | 计费周期 |
|------|------|----------|
| HKD | $264.00 | 每年 |
| USD | $34.56 | 每年 |
| JPY | ¥5,748 | 每年 |
| KRW | ₩53,616 | 每年 |

### VaultCaddy Monthly（月付）
| 货币 | 价格 | 计费周期 |
|------|------|----------|
| HKD | $28.00 | 每月 |
| USD | $3.88 | 每月 |
| JPY | ¥599 | 每月 |
| KRW | ₩5,588 | 每月 |

---

## 📝 脚本输出示例

```
🚀 开始查看和更新 Stripe 产品价格

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
产品 1: prod_Tb2443GvCbe4Pp
产品 2: prod_Tb24SiE4usHRDS
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 步骤 1: 查看产品 1 的当前价格
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📦 产品信息: VaultCaddy Yearly
   Product ID: prod_Tb2443GvCbe4Pp
   描述: 年付订阅方案

💰 当前激活的价格 (共 3 个):

   1. Price ID: price_xxx
      金额: 552.00 HKD
      周期: year
      状态: ✅ 激活

...

📋 步骤 3: 创建新价格
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🆕 创建新价格: HKD yearly
   产品: prod_Tb2443GvCbe4Pp
   金额: 264.00 HKD
✅ 新价格创建成功！
   Price ID: price_NEW_HKD_YEARLY

...

✅ 完成！新价格已创建
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📦 产品 1 新价格:
   - price_NEW_HKD_YEARLY: 264.00 HKD/year
   - price_NEW_USD_YEARLY: 34.56 USD/year
   - price_NEW_JPY_YEARLY: 5748 JPY/year
   - price_NEW_KRW_YEARLY: 53616 KRW/year

📦 产品 2 新价格:
   - price_NEW_HKD_MONTHLY: 28.00 HKD/month
   - price_NEW_USD_MONTHLY: 3.88 USD/month
   - price_NEW_JPY_MONTHLY: 599 JPY/month
   - price_NEW_KRW_MONTHLY: 5588 KRW/month

📄 JSON 格式（方便复制到代码中）：
{
  "product1": {
    "productId": "prod_Tb2443GvCbe4Pp",
    "prices": [...]
  },
  "product2": {
    "productId": "prod_Tb24SiE4usHRDS",
    "prices": [...]
  }
}
```

---

## ⚠️ 常见问题

### Q1: 脚本提示 "stripe is not defined"

**解决**: 安装 Stripe Node.js 库
```bash
cd /Users/cavlinyeung/ai-bank-parser
npm install stripe
```

### Q2: 脚本提示 "Invalid API Key"

**解决**: 
1. 确认 Secret Key 正确
2. 确认没有多余的空格
3. 确认使用的是 Secret Key（以 `sk_` 开头），不是 Publishable Key

### Q3: 脚本提示 "Product not found"

**解决**: 
1. 确认 Product ID 正确
2. 在 Stripe Dashboard 中验证产品存在
3. 确认使用的是正确环境的 API Key（测试/生产）

---

## 🎯 下一步

创建完价格后：

1. **复制新的 Price ID**
2. **更新代码**: 
   - 打开 `firebase-functions/index.js`
   - 更新 `productionPriceMapping` 中的 Price ID
3. **测试支付**: 在测试环境测试完整支付流程

---

## 📞 需要帮助？

如果遇到任何问题：

1. 查看脚本输出的错误信息
2. 检查 Stripe Dashboard 中的 API logs
3. 参考 Stripe 文档: https://stripe.com/docs/api/prices/create

---

**创建时间**: 2026-01-08  
**预计时间**: 1-2 分钟

