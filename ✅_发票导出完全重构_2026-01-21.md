# âœ… å‘ç¥¨å¯¼å‡ºå®Œå…¨é‡æ„ - å¯¹é½é“¶è¡Œå¯¹è´¦å•åŠŸèƒ½

## ğŸ“‹ ç”¨æˆ·éœ€æ±‚

### è¦æ±‚1ï¼šæ·»åŠ é€šç”¨CSVæ ¼å¼
åœ¨å‘ç¥¨å¯¼å‡ºä¸­æ·»åŠ åƒé“¶è¡Œå¯¹è´¦å•ä¸€æ ·çš„CSVæ ¼å¼é€‰é¡¹ï¼š
- ğŸŒ é€šç”¨ CSV (Xero, Wave, QuickBooks, MYOB)
- ğŸ“„ Sage CSV (Sage 50, Sage Accounting)
- ğŸ“„ Zoho Books CSV (Zoho Books æ ¼å¼)

### è¦æ±‚2ï¼šCSVæ”¹ä¸ºExcel
åˆ é™¤"æ¨™æº– CSVï¼ˆç¸½æ•¸ï¼‰"å’Œ"å®Œæ•´äº¤æ˜“æ•¸æ“š CSV"ï¼Œæ”¹ä¸ºï¼š
- æ¨™æº– Excelï¼ˆç¸½æ•¸ï¼‰
- å®Œæ•´äº¤æ˜“æ•¸æ“š Excel

---

## âœ… å·²å®Œæˆçš„æ›´æ”¹

### ä¿®æ”¹æ–‡ä»¶
1. `invoice-export.js` - æ·»åŠ é€šç”¨CSVç”Ÿæˆå‡½æ•°
2. `firstproject.html` - æ›´æ–°èœå•å’Œå¯¼å‡ºé€»è¾‘

### ä¿®æ”¹ä½ç½®
1. **invoice-export.js** (ç¬¬ 128-330 è¡Œ) - æ·»åŠ 3ä¸ªæ–°çš„CSVç”Ÿæˆå‡½æ•°
2. **invoice-export.js** (ç¬¬ 487-494 è¡Œ) - å¯¼å‡ºæ–°å‡½æ•°åˆ°å…¨å±€
3. **firstproject.html** (ç¬¬ 4146-4202 è¡Œ) - æ›´æ–°å‘ç¥¨å¯¼å‡ºèœå•
4. **firstproject.html** (ç¬¬ 4771-4915 è¡Œ) - æ·»åŠ æ–°æ ¼å¼çš„å¯¼å‡ºå¤„ç†

---

## ğŸ¨ æ–°çš„å‘ç¥¨å¯¼å‡ºèœå•ç»“æ„

### ä¿®æ”¹å‰ï¼š
```
ç™¼ç¥¨
  - ğŸŒ Xero CSV
  - ğŸ“„ QuickBooks CSV

æ¨™æº–æ ¼å¼
  - æ¨™æº– CSVï¼ˆç¸½æ•¸ï¼‰
  - å®Œæ•´äº¤æ˜“æ•¸æ“š CSV
```

### ä¿®æ”¹åï¼š
```
CSV æ ¼å¼
  - ğŸŒ é€šç”¨ CSV (æ¨è)
    âœ¨ Xero, Wave, QuickBooks, MYOB
  
  - ğŸ“„ Sage CSV
    ğŸ‡¬ğŸ‡§ Sage 50, Sage Accounting
  
  - ğŸ“„ Zoho Books CSV
    ğŸ‡®ğŸ‡³ Zoho Books æ ¼å¼

Excel æ ¼å¼
  - æ¨™æº– Excelï¼ˆç¸½æ•¸ï¼‰
    å¿«é€Ÿå°å¸³
  
  - å®Œæ•´äº¤æ˜“æ•¸æ“š Excel
    è©³ç´°è¨˜éŒ„

å…¶ä»–æ ¼å¼
  - â˜ï¸ QBO æ–‡ä»¶
  - ğŸ“Š Excel (.xlsx)
```

---

## ğŸ”§ æŠ€æœ¯å®ç°

### 1ï¸âƒ£ æ–°å¢é€šç”¨CSVå‡½æ•° (invoice-export.js)

#### A. é€šç”¨CSV (generateUniversalCSV)

**æ ¼å¼**ï¼š
```csv
Date, Invoice Number, Supplier, Description, Amount
```

**ç‰¹ç‚¹**ï¼š
- æœ€ç®€åŒ–çš„æ ¼å¼
- é€‚ç”¨äº Xero, Wave, QuickBooks, MYOB
- å¦‚æœæœ‰é¡¹ç›®æ˜ç»†ï¼Œæ¯ä¸ªé¡¹ç›®ä¸€è¡Œ

**ä»£ç ç‰‡æ®µ**ï¼š
```javascript
function generateUniversalCSV(invoices) {
    const headers = ['Date', 'Invoice Number', 'Supplier', 'Description', 'Amount'];
    const rows = [headers];
    
    invoices.forEach(invoice => {
        const data = invoice.processedData || {};
        const date = data.invoiceDate || data.date || '';
        const invoiceNumber = data.invoiceNumber || '';
        const supplier = data.vendorName || data.vendor || '';
        const total = parseFloat(data.totalAmount || 0);
        
        const items = data.items || [];
        
        if (items.length === 0) {
            rows.push([date, invoiceNumber, supplier, 'Invoice Total', total.toFixed(2)]);
        } else {
            items.forEach(item => {
                const description = item.description || '';
                const amount = parseFloat(item.amount || 0);
                rows.push([date, invoiceNumber, supplier, description, amount.toFixed(2)]);
            });
        }
    });
    
    return rows.map(row => row.map(escapeCSV).join(',')).join('\n');
}
```

---

#### B. Sage CSV (generateSageCSV)

**æ ¼å¼**ï¼š
```csv
Type, Account Reference, Nominal A/C Ref, Date, Reference, Details, Net Amount, Tax Code, Tax Amount
```

**ç‰¹ç‚¹**ï¼š
- è‹±å›½æ ¼å¼
- PI (Purchase Invoice) ç±»å‹
- å€Ÿè´·åˆ†ç¦»
- åŒ…å«ç¨åŠ¡ä¿¡æ¯

**æ—¥æœŸæ ¼å¼**ï¼š`DD/MM/YYYY`

**ä»£ç ç‰‡æ®µ**ï¼š
```javascript
function generateSageCSV(invoices) {
    const headers = ['Type', 'Account Reference', 'Nominal A/C Ref', 'Date', 'Reference', 'Details', 'Net Amount', 'Tax Code', 'Tax Amount'];
    const rows = [headers];
    
    invoices.forEach(invoice => {
        const data = invoice.processedData || {};
        const date = formatDateForSage(data.invoiceDate || ''); // DD/MM/YYYY
        const reference = data.invoiceNumber || '';
        const accountRef = data.vendorName || '';
        const netAmount = parseFloat(data.totalAmount || 0);
        const taxAmount = parseFloat(data.taxAmount || 0);
        const taxCode = taxAmount > 0 ? 'T1' : 'T0';
        
        const items = data.items || [];
        
        if (items.length === 0) {
            rows.push(['PI', accountRef, '5000', date, reference, 'Invoice Total', netAmount.toFixed(2), taxCode, taxAmount.toFixed(2)]);
        } else {
            items.forEach(item => {
                const details = item.description || '';
                const itemAmount = parseFloat(item.amount || 0);
                const itemTax = (itemAmount / netAmount) * taxAmount;
                rows.push(['PI', accountRef, '5000', date, reference, details, itemAmount.toFixed(2), taxCode, itemTax.toFixed(2)]);
            });
        }
    });
    
    return rows.map(row => row.map(escapeCSV).join(',')).join('\n');
}

function formatDateForSage(dateStr) {
    if (!dateStr) return '';
    const date = new Date(dateStr);
    const day = String(date.getDate()).padStart(2, '0');
    const month = String(date.getMonth() + 1).padStart(2, '0');
    const year = date.getFullYear();
    return `${day}/${month}/${year}`;
}
```

---

#### C. Zoho Books CSV (generateZohoCSV)

**æ ¼å¼**ï¼š
```csv
Invoice Number, Invoice Date, Vendor Name, Item Name, Item Description, Quantity, Rate, Amount, Tax, Total
```

**ç‰¹ç‚¹**ï¼š
- å°åº¦æ ¼å¼
- æ¯ä¸ªé¡¹ç›®ä¸€è¡Œ
- åŒ…å«é¡¹ç›®è¯¦ç»†ä¿¡æ¯
- æŒ‰æ¯”ä¾‹åˆ†é…ç¨é¢

**ä»£ç ç‰‡æ®µ**ï¼š
```javascript
function generateZohoCSV(invoices) {
    const headers = ['Invoice Number', 'Invoice Date', 'Vendor Name', 'Item Name', 'Item Description', 'Quantity', 'Rate', 'Amount', 'Tax', 'Total'];
    const rows = [headers];
    
    invoices.forEach(invoice => {
        const data = invoice.processedData || {};
        const invoiceNumber = data.invoiceNumber || '';
        const invoiceDate = data.invoiceDate || '';
        const vendorName = data.vendorName || data.vendor || '';
        const total = parseFloat(data.totalAmount || 0);
        const tax = parseFloat(data.taxAmount || 0);
        
        const items = data.items || [];
        
        if (items.length === 0) {
            rows.push([invoiceNumber, invoiceDate, vendorName, 'Invoice Total', '', 1, total.toFixed(2), total.toFixed(2), tax.toFixed(2), total.toFixed(2)]);
        } else {
            items.forEach(item => {
                const itemName = item.code || item.name || '';
                const itemDescription = item.description || '';
                const quantity = parseFloat(item.quantity || 1);
                const rate = parseFloat(item.unitPrice || 0);
                const amount = parseFloat(item.amount || 0);
                const itemTax = (amount / total) * tax;
                rows.push([invoiceNumber, invoiceDate, vendorName, itemName, itemDescription, quantity, rate.toFixed(2), amount.toFixed(2), itemTax.toFixed(2), total.toFixed(2)]);
            });
        }
    });
    
    return rows.map(row => row.map(escapeCSV).join(',')).join('\n');
}
```

---

### 2ï¸âƒ£ Excelå¯¼å‡ºå®ç° (firstproject.html)

#### A. æ¨™æº– Excelï¼ˆç¸½æ•¸ï¼‰

**æ ¼å¼**ï¼š
```
Invoice Number | Date | Supplier | Amount | Tax | Status
```

**ç‰¹ç‚¹**ï¼š
- æ¯å¼ å‘ç¥¨ä¸€è¡Œ
- åªåŒ…å«æ±‡æ€»ä¿¡æ¯
- 6åˆ—ç®€æ´æ ¼å¼

**ä»£ç **ï¼š
```javascript
case 'invoice_summary_excel':
    const wb = XLSX.utils.book_new();
    const excelData = [['Invoice Number', 'Date', 'Supplier', 'Amount', 'Tax', 'Status']];
    
    docsToExport.forEach(doc => {
        const data = doc.processedData;
        excelData.push([
            data.invoiceNumber || '',
            data.invoiceDate || '',
            data.vendorName || data.vendor || '',
            parseFloat(data.totalAmount || 0).toFixed(2),
            parseFloat(data.taxAmount || 0).toFixed(2),
            data.status || 'æœªä»˜æ¬¾'
        ]);
    });
    
    const ws = XLSX.utils.aoa_to_sheet(excelData);
    ws['!cols'] = [{wch: 15}, {wch: 12}, {wch: 25}, {wch: 12}, {wch: 10}, {wch: 12}];
    XLSX.utils.book_append_sheet(wb, ws, "Invoice Summary");
    
    fileName = `Invoice_Summary_${dateStr}.xlsx`;
    XLSX.writeFile(wb, fileName);
```

---

#### B. å®Œæ•´äº¤æ˜“æ•¸æ“š Excel

**æ ¼å¼**ï¼ˆ14åˆ—ï¼‰ï¼š
```
Invoice Number | Date | Supplier Name | Supplier Phone | Supplier Email |
Item Code | Item Description | Quantity | Unit | Unit Price |
Amount | Total Amount | Tax | Status
```

**ç‰¹ç‚¹**ï¼š
- æ¯ä¸ªé¡¹ç›®ä¸€è¡Œ
- åŒ…å«å®Œæ•´çš„ä¾›åº”å•†ä¿¡æ¯
- åŒ…å«é¡¹ç›®æ˜ç»†

---

### 3ï¸âƒ£ èœå•æ›´æ–° (firstproject.html)

**ä¿®æ”¹å‰**ï¼š
- Xero CSV / QuickBooks CSV
- æ¨™æº– CSVï¼ˆç¸½æ•¸ï¼‰/ å®Œæ•´äº¤æ˜“æ•¸æ“š CSV

**ä¿®æ”¹å**ï¼š
```javascript
// CSV æ ¼å¼
<button onclick="exportDocuments('invoice_universal_csv')">
    ğŸŒ é€šç”¨ CSV
    âœ¨ Xero, Wave, QuickBooks, MYOB
</button>

<button onclick="exportDocuments('invoice_sage_csv')">
    ğŸ“„ Sage CSV
    ğŸ‡¬ğŸ‡§ Sage 50, Sage Accounting
</button>

<button onclick="exportDocuments('invoice_zoho_csv')">
    ğŸ“„ Zoho Books CSV
    ğŸ‡®ğŸ‡³ Zoho Books æ ¼å¼
</button>

// Excel æ ¼å¼
<button onclick="exportDocuments('invoice_summary_excel')">
    æ¨™æº– Excelï¼ˆç¸½æ•¸ï¼‰
    å¿«é€Ÿå°å¸³
</button>

<button onclick="exportDocuments('invoice_detailed_excel')">
    å®Œæ•´äº¤æ˜“æ•¸æ“š Excel
    è©³ç´°è¨˜éŒ„
</button>
```

---

## ğŸ“Š å¯¼å‡ºæ ¼å¼å®Œæ•´å¯¹æ¯”

### é“¶è¡Œå¯¹è´¦å• vs å‘ç¥¨

| æ ¼å¼ç±»å‹ | é“¶è¡Œå¯¹è´¦å• | å‘ç¥¨ |
|---------|----------|-----|
| **é€šç”¨ CSV** | âœ… Date, Description, Amount | âœ… Date, Invoice #, Supplier, Description, Amount |
| **Sage CSV** | âœ… è‹±å›½é“¶è¡Œæ ¼å¼ | âœ… è‹±å›½å‘ç¥¨æ ¼å¼ (PI) |
| **Zoho Books CSV** | âœ… å°åº¦é“¶è¡Œæ ¼å¼ | âœ… å°åº¦å‘ç¥¨æ ¼å¼ |
| **æ¨™æº–åŒ¯ç¸½** | âŒ | âœ… Excel (6åˆ—) |
| **å®Œæ•´è©³ç´°** | âŒ | âœ… Excel (14åˆ—) |
| **QBO æ–‡ä»¶** | âœ… | âœ… |
| **Excel (.xlsx)** | âœ… | âœ… |

---

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æ­¥éª¤ 1: å¼ºåˆ¶åˆ·æ–°é¡µé¢
```bash
Cmd + Shift + R
```

æ‰“å¼€ï¼š`https://vaultcaddy.com/firstproject.html?project=SJJkhY7CFdqh8zyVAM6B`

### æ­¥éª¤ 2: é€‰æ‹©å‘ç¥¨æ–‡æ¡£
1. å‹¾é€‰è‡³å°‘1ä¸ª**å‘ç¥¨**æ–‡æ¡£
2. ç‚¹å‡» **Export** æŒ‰é’®

**é¢„æœŸç»“æœ - èœå•å†…å®¹**ï¼š
- âœ… çœ‹åˆ° "CSV æ ¼å¼" åˆ†ç±»
- âœ… ğŸŒ é€šç”¨ CSV (ç»¿è‰²é«˜äº®)
- âœ… ğŸ“„ Sage CSV
- âœ… ğŸ“„ Zoho Books CSV
- âœ… çœ‹åˆ° "Excel æ ¼å¼" åˆ†ç±»
- âœ… æ¨™æº– Excelï¼ˆç¸½æ•¸ï¼‰
- âœ… å®Œæ•´äº¤æ˜“æ•¸æ“š Excel
- âŒ ä¸å†æœ‰ "æ¨™æº– CSVï¼ˆç¸½æ•¸ï¼‰"
- âŒ ä¸å†æœ‰ "å®Œæ•´äº¤æ˜“æ•¸æ“š CSV"

### æ­¥éª¤ 3: æµ‹è¯•é€šç”¨CSVå¯¼å‡º
1. ç‚¹å‡» "ğŸŒ é€šç”¨ CSV"
2. ç­‰å¾…ä¸‹è½½

**é¢„æœŸç»“æœ**ï¼š
- âœ… ä¸‹è½½æ–‡ä»¶ï¼š`Invoice_Universal_2026-01-21.csv`
- âœ… æ ¼å¼ï¼š`Date, Invoice Number, Supplier, Description, Amount`
- âœ… æ¯ä¸ªé¡¹ç›®ä¸€è¡Œ

### æ­¥éª¤ 4: æµ‹è¯•Sage CSVå¯¼å‡º
1. ç‚¹å‡» "ğŸ“„ Sage CSV"
2. ç­‰å¾…ä¸‹è½½

**é¢„æœŸç»“æœ**ï¼š
- âœ… ä¸‹è½½æ–‡ä»¶ï¼š`Invoice_Sage_2026-01-21.csv`
- âœ… æ ¼å¼ï¼š`Type, Account Reference, Nominal A/C Ref, Date, Reference, Details, Net Amount, Tax Code, Tax Amount`
- âœ… Type = "PI" (Purchase Invoice)
- âœ… æ—¥æœŸæ ¼å¼ï¼šDD/MM/YYYY

### æ­¥éª¤ 5: æµ‹è¯•Zoho Books CSVå¯¼å‡º
1. ç‚¹å‡» "ğŸ“„ Zoho Books CSV"
2. ç­‰å¾…ä¸‹è½½

**é¢„æœŸç»“æœ**ï¼š
- âœ… ä¸‹è½½æ–‡ä»¶ï¼š`Invoice_ZohoBooks_2026-01-21.csv`
- âœ… æ ¼å¼ï¼š`Invoice Number, Invoice Date, Vendor Name, Item Name, Item Description, Quantity, Rate, Amount, Tax, Total`
- âœ… åŒ…å«é¡¹ç›®æ˜ç»†

### æ­¥éª¤ 6: æµ‹è¯•Excelå¯¼å‡º
1. ç‚¹å‡» "æ¨™æº– Excelï¼ˆç¸½æ•¸ï¼‰"
2. ç­‰å¾…ä¸‹è½½

**é¢„æœŸç»“æœ**ï¼š
- âœ… ä¸‹è½½æ–‡ä»¶ï¼š`Invoice_Summary_2026-01-21.xlsx`
- âœ… 6åˆ—ï¼šInvoice Number, Date, Supplier, Amount, Tax, Status
- âœ… æ¯å¼ å‘ç¥¨ä¸€è¡Œ

### æ­¥éª¤ 7: æµ‹è¯•å®Œæ•´Excelå¯¼å‡º
1. ç‚¹å‡» "å®Œæ•´äº¤æ˜“æ•¸æ“š Excel"
2. ç­‰å¾…ä¸‹è½½

**é¢„æœŸç»“æœ**ï¼š
- âœ… ä¸‹è½½æ–‡ä»¶ï¼š`Invoice_Detailed_2026-01-21.xlsx`
- âœ… 14åˆ—ï¼ˆåŒ…å«é¡¹ç›®æ˜ç»†ï¼‰
- âœ… æ¯ä¸ªé¡¹ç›®ä¸€è¡Œ

---

## ğŸ“ CSVæ ¼å¼è¯¦ç»†è¯´æ˜

### 1ï¸âƒ£ é€šç”¨ CSV
**æ–‡ä»¶å**ï¼š`Invoice_Universal_2026-01-21.csv`

**é€‚ç”¨è½¯ä»¶**ï¼šXero, Wave, QuickBooks, MYOB

**æ ¼å¼**ï¼š
```csv
Date,Invoice Number,Supplier,Description,Amount
2026-01-21,INV-001,ABCå…¬å¸,åŠå…¬æ¡Œ,1000.00
2026-01-21,INV-001,ABCå…¬å¸,åŠå…¬æ¤…,500.00
```

---

### 2ï¸âƒ£ Sage CSV
**æ–‡ä»¶å**ï¼š`Invoice_Sage_2026-01-21.csv`

**é€‚ç”¨è½¯ä»¶**ï¼šSage 50, Sage Accounting

**æ ¼å¼**ï¼š
```csv
Type,Account Reference,Nominal A/C Ref,Date,Reference,Details,Net Amount,Tax Code,Tax Amount
PI,ABCå…¬å¸,5000,21/01/2026,INV-001,åŠå…¬æ¡Œ,1000.00,T1,100.00
PI,ABCå…¬å¸,5000,21/01/2026,INV-001,åŠå…¬æ¤…,500.00,T1,50.00
```

**ç‰¹ç‚¹**ï¼š
- Type = PI (Purchase Invoice)
- æ—¥æœŸæ ¼å¼ = DD/MM/YYYY
- Tax Code: T0 = æ— ç¨, T1 = æœ‰ç¨

---

### 3ï¸âƒ£ Zoho Books CSV
**æ–‡ä»¶å**ï¼š`Invoice_ZohoBooks_2026-01-21.csv`

**é€‚ç”¨è½¯ä»¶**ï¼šZoho Books

**æ ¼å¼**ï¼š
```csv
Invoice Number,Invoice Date,Vendor Name,Item Name,Item Description,Quantity,Rate,Amount,Tax,Total
INV-001,2026-01-21,ABCå…¬å¸,P001,åŠå…¬æ¡Œ,2,500.00,1000.00,100.00,1500.00
INV-001,2026-01-21,ABCå…¬å¸,P002,åŠå…¬æ¤…,5,100.00,500.00,50.00,1500.00
```

---

## ğŸ¯ ä¼˜ç‚¹

### 1ï¸âƒ£ **å®Œå…¨å¯¹é½é“¶è¡Œå¯¹è´¦å•åŠŸèƒ½**
- å‘ç¥¨å’Œé“¶è¡Œå¯¹è´¦å•èœå•ç»“æ„ä¸€è‡´
- ç›¸åŒçš„CSVæ ¼å¼é€‰é¡¹

### 2ï¸âƒ£ **æ”¯æŒæ›´å¤šä¼šè®¡è½¯ä»¶**
- Xero âœ…
- Wave âœ…
- QuickBooks âœ…
- MYOB âœ…
- Sage 50 / Sage Accounting âœ…
- Zoho Books âœ…

### 3ï¸âƒ£ **æ›´çµæ´»çš„å¯¼å‡ºé€‰é¡¹**
- CSVæ ¼å¼ï¼šé€‚åˆä¼šè®¡è½¯ä»¶å¯¼å…¥
- Excelæ ¼å¼ï¼šé€‚åˆäººå·¥å®¡é˜…å’Œåˆ†æ

### 4ï¸âƒ£ **ä¸“ä¸šçš„æ•°æ®ç»“æ„**
- é€šç”¨CSVï¼šæœ€ç®€åŒ–ï¼Œå…¼å®¹æ€§æœ€å¥½
- Sage CSVï¼šè‹±å›½ä¼šè®¡æ ‡å‡†
- Zoho Books CSVï¼šå°åº¦ä¼šè®¡æ ‡å‡†

---

## ğŸ”— ç›¸å…³æ–‡æ¡£
- `âœ…_å‘ç¥¨å¯¼å‡ºèœå•å¢å¼º_2026-01-21.md` - ä¹‹å‰çš„å¢å¼º
- `âœ…_å‘ç¥¨Excelæ ¼å¼ä¿®å¤_2026-01-21.md` - Excelæ ¼å¼ä¿®å¤
- `invoice-export.js` - å‘ç¥¨å¯¼å‡ºæ¨¡å—

---

**åˆ›å»ºæ—¶é—´**ï¼š2026-01-21  
**ä½œè€…**ï¼šVaultCaddy AI Assistant  
**ç›¸å…³æ–‡ä»¶**ï¼š`firstproject.html`, `invoice-export.js`

