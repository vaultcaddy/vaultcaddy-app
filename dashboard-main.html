<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - VaultCaddy</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="dashboard.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="translations.js"></script>
</head>
<body class="dashboard-body">
    <!-- 導航欄 -->
    <nav class="navbar dashboard-nav">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="dashboard-main.html">
                    <div class="logo-container">
                        <div class="logo-icon">
                            <i class="fas fa-file-contract"></i>
                        </div>
                        <div class="logo-text">
                            <h2>VaultCaddy</h2>
                            <span>AI Document Processing</span>
                        </div>
                    </div>
                </a>
            </div>
            <div class="nav-menu" id="nav-menu">
                <div class="nav-dropdown">
                    <a href="#" class="nav-link dropdown-toggle">
                        <span data-translate="nav_solutions">Solutions</span>
                        <i class="fas fa-chevron-down"></i>
                    </a>
                    <div class="dropdown-menu">
                        <a href="#" class="dropdown-item">銀行對帳單</a>
                        <a href="#" class="dropdown-item">發票處理</a>
                        <a href="#" class="dropdown-item">收據掃描</a>
                        <a href="#" class="dropdown-item">通用文檔</a>
                    </div>
                </div>
                <a href="#" class="nav-link" data-translate="nav_jobs">Jobs</a>
                <a href="dashboard-main.html" class="nav-link active" data-translate="nav_dashboard">Dashboard</a>
                <a href="#pricing" class="nav-link" data-translate="nav_pricing">Pricing</a>
                <div class="credits-display">
                    <span data-translate="nav_credits">Credits:</span>
                    <span class="credits-count" id="credits-count">7</span>
                    <div class="credits-icon">
                        <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMTAiIGZpbGw9IiNGRkQ3MDAiLz4KPHN2ZyB3aWR0aD0iMTQiIGhlaWdodD0iMTQiIHZpZXdCb3g9IjAgMCAxNCAxNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4PSI1IiB5PSI1Ij4KPHBhdGggZD0iTTcgMUw4LjA5IDQuMjZMMTIgNUw4LjA5IDUuNzRMNyA5TDUuOTEgNS43NEwyIDVMNS45MSA0LjI2TDcgMVoiIGZpbGw9IiNGRkZGRkYiLz4KPHN2Zz4KPHN2Zz4=" alt="Credits" />
                    </div>
                </div>
                <div class="user-profile">
                    <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=32&h=32&fit=crop&crop=face&auto=format" alt="User" class="user-avatar">
                    <div class="user-dropdown">
                        <div class="dropdown-menu user-menu">
                            <a href="#" class="dropdown-item">設定</a>
                            <a href="#" class="dropdown-item">帳戶</a>
                            <hr>
                            <a href="#" class="dropdown-item text-danger" onclick="logout()">登出</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- 主要內容 -->
    <main class="dashboard-main">
        <!-- 標題區域 -->
        <header class="dashboard-header">
            <div class="container">
                <h1 class="dashboard-title">文檔處理控制台</h1>
                <p class="dashboard-subtitle">使用AI快速處理您的財務文檔</p>
            </div>
        </header>

        <!-- 快速統計 -->
        <section class="dashboard-stats">
            <div class="container">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">24</h3>
                            <p class="stat-label">本月處理文檔</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">2.3小時</h3>
                            <p class="stat-label">節省時間</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">98.5%</h3>
                            <p class="stat-label">處理準確率</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-coins"></i>
                        </div>
                        <div class="stat-content">
                            <h3 class="stat-number">7</h3>
                            <p class="stat-label">剩餘Credits</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 快速操作 -->
        <section class="quick-actions">
            <div class="container">
                <h2 class="section-title">快速開始</h2>
                <div class="actions-grid">
                    <div class="action-card bank-statement" data-document-type="bank-statement">
                        <div class="action-icon">
                            <i class="fas fa-university"></i>
                        </div>
                        <h3 class="action-title">銀行對帳單</h3>
                        <p class="action-description">處理PDF銀行對帳單，提取交易記錄</p>
                        <button class="action-btn" onclick="openUploadModal('bank-statement')">
                            <span>開始處理</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                    <div class="action-card invoice" data-document-type="invoice">
                        <div class="action-icon">
                            <i class="fas fa-file-invoice"></i>
                        </div>
                        <h3 class="action-title">發票掃描</h3>
                        <p class="action-description">自動識別發票信息和項目明細</p>
                        <button class="action-btn" onclick="openUploadModal('invoice')">
                            <span>開始處理</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                    <div class="action-card receipt" data-document-type="receipt">
                        <div class="action-icon">
                            <i class="fas fa-receipt"></i>
                        </div>
                        <h3 class="action-title">收據處理</h3>
                        <p class="action-description">快速掃描和分類費用收據</p>
                        <button class="action-btn" onclick="openUploadModal('receipt')">
                            <span>開始處理</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>

                    <div class="action-card general" data-document-type="general">
                        <div class="action-icon">
                            <i class="fas fa-file-alt"></i>
                        </div>
                        <h3 class="action-title">通用文檔</h3>
                        <p class="action-description">處理各類財務相關文檔</p>
                        <button class="action-btn" onclick="openUploadModal('general')">
                            <span>開始處理</span>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- 最近處理記錄 -->
        <section class="recent-processing">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">最近處理記錄</h2>
                    <a href="#" class="view-all-btn">查看全部</a>
                </div>
                
                <div class="processing-table-container">
                    <table class="processing-table">
                        <thead>
                            <tr>
                                <th>文件名稱</th>
                                <th>類型</th>
                                <th>處理時間</th>
                                <th>狀態</th>
                                <th>Credits使用</th>
                                <th>操作</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>
                                    <div class="file-info">
                                        <i class="fas fa-file-pdf file-icon"></i>
                                        <span>銀行對帳單_2024_03.pdf</span>
                                    </div>
                                </td>
                                <td><span class="type-badge bank-statement">銀行對帳單</span></td>
                                <td>2024/03/15 14:30</td>
                                <td><span class="status-badge completed">已完成</span></td>
                                <td>3</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-sm btn-primary" onclick="viewResult('file1')">
                                            <i class="fas fa-eye"></i> 查看
                                        </button>
                                        <button class="btn-sm btn-secondary">
                                            <i class="fas fa-download"></i> 下載
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="file-info">
                                        <i class="fas fa-file-pdf file-icon"></i>
                                        <span>發票_ABC公司_20240314.pdf</span>
                                    </div>
                                </td>
                                <td><span class="type-badge invoice">發票</span></td>
                                <td>2024/03/14 16:45</td>
                                <td><span class="status-badge completed">已完成</span></td>
                                <td>2</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-sm btn-primary" onclick="viewResult('file2')">
                                            <i class="fas fa-eye"></i> 查看
                                        </button>
                                        <button class="btn-sm btn-secondary">
                                            <i class="fas fa-download"></i> 下載
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="file-info">
                                        <i class="fas fa-file-pdf file-icon"></i>
                                        <span>餐廳收據_2024.pdf</span>
                                    </div>
                                </td>
                                <td><span class="type-badge receipt">收據</span></td>
                                <td>2024/03/13 11:20</td>
                                <td><span class="status-badge processing">處理中</span></td>
                                <td>1</td>
                                <td>
                                    <div class="action-buttons">
                                        <button class="btn-sm btn-secondary" disabled>
                                            <i class="fas fa-spinner fa-spin"></i> 處理中
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </section>
    </main>

    <!-- 上傳模態框 -->
    <div class="modal" id="upload-modal">
        <div class="modal-overlay"></div>
        <div class="modal-content upload-modal-content">
            <div class="modal-header">
                <h3 class="modal-title" id="modal-title">上傳文檔</h3>
                <button class="modal-close" onclick="closeUploadModal()">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body">
                <div class="document-type-display" id="document-type-display">
                    <div class="type-icon" id="type-icon">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div class="type-info">
                        <h4 id="type-title">文檔類型</h4>
                        <p id="type-description">請選擇要處理的文檔類型</p>
                    </div>
                </div>
                
                <div class="upload-area" id="upload-area">
                    <div class="upload-content">
                        <i class="fas fa-cloud-upload-alt"></i>
                        <h4>拖放文件到這裡</h4>
                        <p>或 <button class="browse-files-btn" onclick="triggerFileInput()">瀏覽檔案</button></p>
                        <input type="file" id="file-upload" accept=".pdf" multiple style="display: none;">
                        <div class="upload-note">
                            <small>支援PDF格式，最大10MB</small>
                        </div>
                    </div>
                </div>

                <div class="credits-info">
                    <div class="credits-calculation">
                        <span>預估Credits使用：</span>
                        <span class="credits-estimate" id="credits-estimate">0</span>
                    </div>
                    <div class="credits-balance">
                        <span>可用Credits：</span>
                        <span class="credits-available" id="credits-available">7</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeUploadModal()">取消</button>
                <button class="btn btn-primary" id="start-processing-btn" onclick="startProcessing()" disabled>
                    開始處理
                </button>
            </div>
        </div>
    </div>

    <!-- 需要協助提示 -->
    <div class="help-banner" id="help-banner">
        <div class="help-content">
            <i class="fas fa-info-circle"></i>
            <div class="help-text">
                <strong>提取不正確？</strong>
                如果您對文檔結果不滿意，可以請求支援，我們會立即為您提供協助。
            </div>
            <button class="help-btn" onclick="requestHelp()">需要協助？</button>
        </div>
        <button class="help-close" onclick="closeHelpBanner()">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <script src="script.js"></script>
    <script src="dashboard.js"></script>
    <script>
        let currentDocumentType = '';
        let selectedFiles = [];

        function openUploadModal(documentType) {
            currentDocumentType = documentType;
            updateModalContent(documentType);
            document.getElementById('upload-modal').classList.add('active');
        }

        function closeUploadModal() {
            document.getElementById('upload-modal').classList.remove('active');
            resetUploadForm();
        }

        function updateModalContent(type) {
            const typeConfig = {
                'bank-statement': {
                    title: '處理銀行對帳單',
                    icon: 'fas fa-university',
                    description: '上傳PDF銀行對帳單，AI將自動提取交易記錄和餘額信息'
                },
                'invoice': {
                    title: '處理發票',
                    icon: 'fas fa-file-invoice',
                    description: '上傳發票PDF，自動識別供應商、項目和金額'
                },
                'receipt': {
                    title: '處理收據',
                    icon: 'fas fa-receipt',
                    description: '掃描收據並自動分類費用類型'
                },
                'general': {
                    title: '處理通用文檔',
                    icon: 'fas fa-file-alt',
                    description: '處理各類財務相關文檔和表格'
                }
            };

            const config = typeConfig[type];
            document.getElementById('modal-title').textContent = config.title;
            document.getElementById('type-icon').innerHTML = `<i class="${config.icon}"></i>`;
            document.getElementById('type-title').textContent = config.title;
            document.getElementById('type-description').textContent = config.description;
        }

        function triggerFileInput() {
            document.getElementById('file-upload').click();
        }

        function viewResult(fileId) {
            // 跳轉到結果頁面
            window.location.href = `result.html?file=${fileId}`;
        }

        function requestHelp() {
            alert('正在為您連接客服支援...');
        }

        function closeHelpBanner() {
            document.getElementById('help-banner').style.display = 'none';
        }

        function logout() {
            localStorage.removeItem('userLoggedIn');
            window.location.href = 'index.html';
        }

        // 初始化
        document.addEventListener('DOMContentLoaded', function() {
            // 檢查登入狀態
            if (localStorage.getItem('userLoggedIn') !== 'true') {
                window.location.href = 'index.html';
            }
        });
    </script>
</body>
</html>

